<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.closing.performance.mapper.WdccDelinquentAdditionalChargesMapper">

    <select id="selectRentalAggregate" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchAggregateRes">
        SELECT T.PERF_YM        /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND SELL_TP_CD = #{sellTpCd} /*렌탈/리스 (판매유형)*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                    </if>
                /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널 */
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = ${sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD
    </select>

    <select id="selectRentalOrderUnit" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchOrderUnitRes">
        SELECT T.PERF_YM        /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , T.CNTR_SN        /*--계약상세번호*/
             , T.CST_KNM        /*--고객명*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , A.CNTR_NO || A.CNTR_SN   AS CNTR_SN
                      , E.CST_KNM                AS CST_KNM     /*-- 고객명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01     /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                   LEFT OUTER JOIN TB_CUBS_CST_BAS E /*--고객기본*/
                     ON A.CST_NO = E.CST_NO
                   WHERE A.SL_CL_YM   = #{slClYm}
                     AND A.SELL_TP_CD = #{sellTpCd}     /*-- 렌탈/리스 (판매유형)*/
                     <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                     AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                     </if>
                     <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                     AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                     </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD,T.CNTR_SN,T.CST_KNM
    </select>

    <select id="selectLeaseAggregate" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchAggregateRes">
        SELECT T.PERF_YM        /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 --기말잔액연체가산금
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND A.SELL_TP_CD = #{sellTpCd}     /*-- 렌탈/리스 (판매유형)*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                    </if>
                    /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널*/
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
               ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD
    </select>

    <select id="selectLeaseOrderUnit" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchOrderUnitRes">
        SELECT T.PERF_YM      /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , T.CNTR_SN        /*--계약상세번호*/
             , T.CST_KNM        /*--고객명*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , A.CNTR_NO || A.CNTR_SN   AS CNTR_SN
                      , E.CST_KNM                AS CST_KNM     /*-- 고객명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                   LEFT OUTER JOIN TB_CUBS_CST_BAS E /*--고객기본*/
                     ON A.CST_NO = E.CST_NO
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND A.SELL_TP_CD = #{sellTpCd}     /*-- 렌탈/리스 (판매유형)*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                    </if>
                    /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널*/
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD,T.CNTR_SN,T.CST_KNM
    </select>

    <select id="selectMemberShipAggregate" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchAggregateRes">
        SELECT T.PERF_YM      /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND A.SELL_TP_CD = #{sellTpCd}     /*-- 멤버십*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                    </if>
                    /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널*/
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD
    </select>

    <select id="selectMemberShipOrderUnit" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchOrderUnitRes">
        SELECT T.PERF_YM      /*--실적년월*/
             , T.SELL_TP_CD   /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , T.CNTR_SN        /*--계약상세번호*/
             , T.CST_KNM        /*--고객명*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , A.CNTR_NO || A.CNTR_SN   AS CNTR_SN
                      , E.CST_KNM                AS CST_KNM     /*-- 고객명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                   LEFT OUTER JOIN TB_CUBS_CST_BAS E /*--고객기본*/
                     ON A.CST_NO = E.CST_NO
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND A.SELL_TP_CD = #{sellTpCd}     /*-- 멤버십*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                    </if>
                    /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널*/
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD,T.CNTR_SN,T.CST_KNM
    </select>

    <select id="selectRegularDeliveryAggregate" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchAggregateRes">
        SELECT T.PERF_YM        /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND A.SELL_TP_CD = #{sellTpCd}     /*-- 멤버십*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  /*-- 판매유형상세*/
                    </if>
                    /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널*/
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD
    </select>

    <select id="selectRegularDeliveryOrderUnit" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccDelinquentAdditionalChargesDto$SearchOrderUnitRes">
        SELECT T.PERF_YM        /*--실적년월*/
             , T.SELL_TP_CD     /*--판매유형*/
             , T.SELL_TP_DTL_CD /*--판매유형상세*/
             , T.SAP_PD_DV_CD   /*--SAP상품구분코드*/
             , T.CNTR_SN        /*--계약상세번호*/
             , T.CST_KNM        /*--고객명*/
             , SUM(T.W1_AM01) AS W1_AM01  /*--전기이월*/
             , SUM(T.W1_AM02) AS W1_AM02  /*--당월발생*/
             , SUM(T.W1_AM03) AS W1_AM03  /*--당월공제*/
             , SUM(T.W1_AM04) AS W1_AM04  /*--당월입금*/
             , SUM(T.W1_AM05) AS W1_AM05  /*--당월환불*/
             , SUM(T.W1_AM06) AS W1_AM06  /*--기말잔액*/
          FROM ( SELECT B.PERF_YM      /*-- 실적년월*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', A.SELL_TP_CD) AS SELL_TP_CD /*-- 판매유형*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_DTL_CD', A.SELL_TP_DTL_CD) AS SELL_TP_DTL_CD /*-- 판매유형상세코드*/
                      , F_CMZ_CD_NM('TNT_WELLS', 'SAP_PD_DV_CD', A.SAP_PD_DV_CD) AS SAP_PD_DV_CD /*-- SAP상품구분코드명*/
                      , A.CNTR_NO || A.CNTR_SN   AS CNTR_SN
                      , E.CST_KNM                AS CST_KNM     /*-- 고객명*/
                      , NVL(B.BTD_DLQ_ADD_AMT,0) AS W1_AM01 /*-- 전기이월*/
                      , NVL(B.THM_OC_DLQ_ADD_AMT,0) AS W1_AM02  /*-- 당월발생연체가산금*/
                      , NVL(B.THM_CTR_DLQ_ADD_AMT,0) AS W1_AM03 /*-- 당월공제연체가산금*/
                      , NVL(B.THM_DLQ_ADD_DP_SUM_AMT,0) AS W1_AM04 /*--당월입금연체가산금*/
                      , NVL(B.THM_DLQ_ADD_RFND_SUM_AMT,0) AS W1_AM05 /*-- 당월환불연체가산금*/
                      , NVL(B.EOT_DLQ_ADD_AMT,0) AS W1_AM06 /*--기말잔액연체가산금*/
                   FROM TB_CBCL_WELLS_SL_MM_CL_IZ A /*-- 월마감*/
                   LEFT OUTER JOIN TB_CBCL_DLQ_BAS B
                     ON A.CNTR_NO = B.CNTR_NO
                    AND A.CNTR_SN = B.CNTR_SN
                    AND A.SL_CL_YM = B.PERF_YM
                   LEFT OUTER JOIN TB_CUBS_CST_BAS E /* --고객기본*/
                     ON A.CST_NO = E.CST_NO
                  WHERE A.SL_CL_YM   = #{slClYm}
                    AND A.SELL_TP_CD = #{sellTpCd}     /*-- 멤버십*/
                    <if test="@MybatisUtils@isNotEmpty(sellTpDtlCd) and !@MybatisUtils@equals(sellTpDtlCd, 'ALL')">
                    AND A.SELL_TP_DTL_CD = #{sellTpDtlCd}  -- 판매유형상세
                    </if>
                    /*--AND A.SELL_INFLW_CHNL_DV_CD = ''    -- 판매채널*/
                    <if test="@MybatisUtils@isNotEmpty(sapPdDvCd) and !@MybatisUtils@equals(sapPdDvCd, 'ALL')">
                    AND A.SAP_PD_DV_CD   = #{sapPdDvCd} /*--SAP 상품구분코드*/
                    </if>
                ) T
         GROUP BY T.PERF_YM, T.SELL_TP_CD, T.SELL_TP_DTL_CD, T.SAP_PD_DV_CD,T.CNTR_SN,T.CST_KNM
    </select>
</mapper>
