<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.closing.performance.mapper.WdccSalesBondAtamMapper">

    <select id="selectSalesBondAtamAggregateList" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccSalesBondAtamDto$SearchRes">
        SELECT SUBSTR(T1.PERF_DT,1,6) PERF_YM       /*실적년월*/
             , T1.PERF_DT /*실적일자*/
             , T2.CNTR_NO || T2.CNTR_SN AS CNTR /*계약상세번호*/
             /*, T3.CST_KNM 고객명*/
             , T1.PD_CD /*상품명*/
             , T1.RVE_AMT /*기초영업선수금*/
             , T2.BZNS_ATAM_BLAM /*(-)잡이익 */
          FROM TB_RVDW_RVE_DTL T1
         INNER JOIN TB_CBCL_BZNS_ATAM_BAS T2
            ON T1.RVE_NO = T2.RVE_NO
         INNER JOIN TB_SSCT_CNTR_DTL T4
            ON T2.CNTR_NO = T4.CNTR_NO
         WHERE SUBSTR(T1.PERF_DT,1,6) = #{perfYm}
           <if test='@MybatisUtils@isNotEmpty(sellTpCd)'>
           AND SELL_TP_CD = #{sellTpCd}
           </if>
    </select>

    <select id="selectSalesBondAtamDateList" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccSalesBondAtamDto$SearchRes">
        SELECT SUBSTR(T1.PERF_DT,1,6) PERF_YM       /*실적년월*/
             , T1.PERF_DT /*실적일자*/
             , T2.CNTR_NO || T2.CNTR_SN AS CNTR /*계약상세번호*/
             /*, T3.CST_KNM 고객명*/
             , T1.PD_CD /*상품명*/
             , T1.RVE_AMT /*기초영업선수금*/
             , T2.BZNS_ATAM_BLAM /*(-)잡이익 */
          FROM TB_RVDW_RVE_DTL T1
         INNER JOIN TB_CBCL_BZNS_ATAM_BAS T2
            ON T1.RVE_NO = T2.RVE_NO
         INNER JOIN TB_SSCT_CNTR_DTL T4
            ON T2.CNTR_NO = T4.CNTR_NO
         WHERE SUBSTR(T1.PERF_DT,1,6) = #{perfYm}
           <if test='@MybatisUtils@isNotEmpty(sellTpCd)'>
           AND SELL_TP_CD = #{sellTpCd}
           </if>
    </select>

    <select id="selectSalesBondAtamOrderList" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccSalesBondAtamDto$SearchRes">
        SELECT SUBSTR(PERF_DT,1,6)/*실적년월*/
             , CST_KNM /*고객명*/
             , CNTR_NO || CNTR_SN AS CNTR /*입금상세 실적년월*/
          FROM TB_RVDW_RVE_DTL T1
         INNER JOIN TB_CBCL_BZNS_ATAM_BAS T2
            ON T1.RVE_NO = T2.RVE_NO
        WHERE SUBSTR(T1.PERF_DT,1,6) = #{perfYm}
          <if test='@MybatisUtils@isNotEmpty(sellTpCd)'>
          AND SELL_TP_CD = #{sellTpCd}
          </if>
    </select>

    <select id="selectSalesBondAtamMemberList" resultType="com.kyowon.sms.wells.web.closing.performance.dto.WdccSalesBondAtamDto$SearchRes">
        SELECT SUBSTR(PERF_DT,1,6)/*실적년월*/
             , CST_KNM /*고객명*/
             , CNTR_NO || CNTR_SN AS CNTR /*입금상세 실적년월*/
          FROM TB_RVDW_RVE_DTL T1
         INNER JOIN TB_CBCL_BZNS_ATAM_BAS T2
            ON T1.RVE_NO = T2.RVE_NO
        WHERE SUBSTR(T1.PERF_DT,1,6) = #{perfYm}
          <if test='@MybatisUtils@isNotEmpty(sellTpCd)'>
          AND SELL_TP_CD = #{sellTpCd}
          </if>
    </select>
</mapper>
