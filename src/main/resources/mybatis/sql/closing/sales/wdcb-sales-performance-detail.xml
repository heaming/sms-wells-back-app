<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.closing.sales.mapper.WdcbSalesPerformanceDetailMapper">
    <select id="selectMembershipSalesDetail" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbSalesPerformanceDetailDto$SearchMembershipRes">
       SELECT T4.CST_KNM
            , T1.CNTR_NO || T1.CNTR_SN AS CNTR_DTL_NO
            , T1.SL_CL_YM
            , T5.PD_NM
            , T6.CNTR_DT
            , T3.CNTR_CNFM_DTM
            , T1.SELL_AMT
            , T1.DSC_AMT
            , '' AS COL9
            , '' AS COL10
            , T1.PRM_MCN
            , T1.PRM_STRT_Y || T1.PRM_STRT_MM AS PRM_STRT
            , T1.PRM_END_Y || T1.PRM_END_MM AS PRM_END
            , T1.PRM_DSCR / T1.PRM_DSC_AMT AS PRM_DSCR
            , T1.PRM_DP_AMT
            , 0 AS COL16
            , 0 AS COL17
            , T1.RENTAL_TN
            , T1.RENTAL_DC
            , '' AS COL20
            , T1.NOM_SL_AMT
            , T1.NOM_DSC_AMT
            , '' AS COL23
            , T1.SPMT_SL_AMT
            , T1.SPMT_DSC_AMT
            , '' AS COL26
            , T1.THM_SL_SUM_AMT
            , T1.SL_SUM_VAT
            , T1.SL_CTR_AMT
            , 0 AS COL30
            , 0 AS COL31
            , T1.SL_AGG_AMT
            , T1.PRM_BLAM_EOT_AMT
            , T1.PRM_DP_AMT AS PRM_DP_AMT2
            , T1.PRM_RFND_AMT
            , T1.PRM_RPLC_AMT
            , T1.PRM_SL_AMT
            , 0 AS COL38
            , T1.EOT_ATAM
            , T1.THM_ATAM_DP_AMT
            , T1.THM_ATAM_RFND_AMT
            , 0 AS COL42
            , T1.PRPD_SL_AMT
            , T1.BTD_ATAM
            , T1.SL_BND_ALRPY_AMT
            , T1.SL_DP_AGG_AMT
            , T1.THM_UC_BLAM
            , 0 AS COL48
            , 0 AS COL49
            , 0 AS COL50
            , 0 AS COL51
            , 0 AS COL52
            , 0 AS COL53
            , T7.BTD_DLQ_ADD_AMT
            , 0 AS DLQ_ADAMT_OC_AMT /* TODO: 가산금발생금액 */
            , T7.THM_CTR_DLQ_ADD_AMT
            , T7.THM_DLQ_DP_SUM_AMT
            , T7.THM_DLQ_RFND_SUM_AMT
            , T7.EOT_DLQ_ADD_AMT
            , '' AS COL60
            , T7.DLQ_MCN || '/' || T7.DLQ_ACU_MCN AS DLQ_MC
            , T7.THM_OC_DLQ_AMT
            , T8.DFA_AMT
            , T9.DFA_DP_AMT
            , T10.ACTCS_DT
            , T10.CLCTAM_PRTNR_NO
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_SSCT_CNTR_DTL T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_SSCT_CNTR_BAS T3
           ON T1.CNTR_NO = T3.CNTR_NO
         LEFT OUTER JOIN TB_CUBS_CST_BAS T4
           ON T1.CST_NO = T4.CST_NO
         LEFT OUTER JOIN TB_PDBS_PD_BAS T5
           ON T1.PD_CD = T5.PD_CD
         LEFT OUTER JOIN TB_CBCL_SL_CNFM_BAS T6
           ON T1.CNTR_NO = T6.CNTR_NO
          AND T1.CNTR_SN = T6.CNTR_SN
         LEFT OUTER JOIN TB_CBCL_DLQ_BAS T7
           ON T1.CNTR_NO = T7.CNTR_NO
          AND T1.CNTR_SN = T7.CNTR_SN
         LEFT OUTER JOIN TB_CBBO_DFA_IZ T8
           ON T1.CNTR_NO = T8.CNTR_NO
          AND T1.CNTR_SN = T8.CNTR_SN
         LEFT OUTER JOIN TB_CBBO_DFA_DP_IZ T9
           ON T8.DFA_TP_CD = T9.DFA_TP_CD
         LEFT OUTER JOIN TB_CBBO_BND_CNTR_BAS T10
           ON T1.CNTR_NO = T10.CNTR_NO
          AND T1.CNTR_SN = T10.CNTR_SN
        WHERE 1=1
          AND T1.SL_CL_YM  = #{slDt}
    </select>
    
    <select id="selectLeaseSalesDetail" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbSalesPerformanceDetailDto$SearchLeaseRes">
       SELECT T4.CST_KNM /* 고객명 */
            , T1.CNTR_NO || T1.CNTR_SN AS CNTR_DTL_NO /*  계약상세번호 */
            , T1.SL_CL_YM /*  매출년월 */
            , T5.PD_NM /*  상품 */
            , T1.CNTR_DT /*  접수일 */
            , T1.SL_DT /*  매출일 */
            , '' AS COL1 /*  주기(개월)/용도 */
            , T1.RENTAL_RGST_COST / T1.DSC_AMT AS RENTAL_RGST_COST /*  등록비용/할인금액 */
            , T1.ISTM_AMT /*  리스총액 */
            , T1.RENTAL_PTRM / T1.RENTAL_AMT AS RENTAL_PTRM /*  리스료(개월/원) */
            , 0 AS COL2 /*  서비스료 */
            , T1.RENTAL_TN / T1.RENTAL_DC AS RENTAL_TN /*  리스차월 */
            , 0 AS COL3 /*  사용일수 */
            , '' AS COL4 /*  취소일자 */
            , T1.FNN_LEASE_PCAM_TAM /*  원금매출금액 */
            , '' AS COL5 /* 완료일자 */
            , T1.SL_AGG_AMT /*  원금누계금액 */
            , 0 AS COL6 /*  할인누계금액 */
            , 0 AS COL7 /*  조정누계금액 */
            , T1.OVR_CTR_DP_AMT + T1.MLG_BTD_PRPD_AMT AS OVR_CTR_DP_AMT /*  기초금액 */
            , 0 AS COL8 /* 발생금액 */
            , 0 AS COL9 /* 입금금액 */
            , 0 AS COL10 /* 추가금액 */
            , 0 AS COL11 /* 조정금액 */
            , 0 AS COL12 /* 기말금액 */
            , 0 AS COL13 /* 채권조정금액 */
            , 0 AS COL14 /* 채권기말금액 */
            , 0 AS COL15 /* 기초금액 */
            , 0 AS COL16 /* 위약금액 */
            , 0 AS COL17 /* 분실손료 */
            , T1.BTD_ATAM /* 기초금액 */
            , T1.THM_ATAM_DP_AMT /* 선수입금액 */
            , T1.THM_ATAM_RFND_AMT /* 선수환불금액 */
            , 0 AS COL18 /* 매출대체금액 */
            , 0 AS COL19 /* 선수대체금액 */
            , T1.EOT_ATAM + MLG_EOT_PRPD_AMT AS EOT_TOTAL_AMT /* 선수총액 */
            , T1.MLG_EOT_PRPD_AMT /* 포인트잔액 */
            , T1.EOT_ATAM /* 선수잔액 */
            , T6.BTD_DLQ_ADD_AMT /* 가산금기초금액 */
            , 0 AS DLQ_ADAMT_OC_AMT /* TODO: 가산금발생금액 */
            , T6.THM_CTR_DLQ_ADD_AMT /* 가산금공제금액 */
            , T6.THM_DLQ_DP_SUM_AMT /* 가산금입금액 */
            , T6.THM_DLQ_RFND_SUM_AMT /* 가산금환불금액 */
            , T6.EOT_DLQ_ADD_AMT /* 가산금기말금액 */
            , 0 AS COL20 /* 유지수당금액 */
            , T6.DLQ_MCN/DLQ_ACU_MCN AS DLQ_MCN /*  연체개월/누계 */
            , T6.THM_OC_DLQ_AMT /*  연체금액 */
            , T7.ACTCS_DT /*  수임일자 */
            , T7.CLCTAM_PRTNR_NO /*  집금담당 */
            , 0 AS COL21 /*  발송년월 */
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_SSCT_CNTR_DTL T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_SSCT_CNTR_BAS T3
           ON T1.CNTR_NO = T3.CNTR_NO
         LEFT OUTER JOIN TB_CUBS_CST_BAS T4
           ON T1.CST_NO = T4.CST_NO
         LEFT OUTER JOIN TB_PDBS_PD_BAS T5
           ON T1.PD_CD = T5.PD_CD
         LEFT OUTER JOIN TB_CBCL_DLQ_BAS T6
           ON T1.CNTR_NO = T6.CNTR_NO
          AND T1.CNTR_SN = T6.CNTR_SN
         LEFT OUTER JOIN TB_CBBO_BND_CNTR_BAS T7
           ON T1.CNTR_NO = T7.CNTR_NO
          AND T1.CNTR_SN = T7.CNTR_SN
        WHERE 1=1
          AND T1.SL_CL_YM  = #{slDt}
    </select>
    
    <select id="selectRentalSalesDetail" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbSalesPerformanceDetailDto$SearchRentalRes">
       SELECT T4.CST_KNM /* 고객명 */
            , T1.CNTR_NO || T1.CNTR_SN AS CNTR_DTL_NO /*  계약상세번호 */
            , T1.SL_CL_YM /*  매출년월 */
            , T5.PD_NM /*  상품 */
            , '' AS COL1 /*  접수일 */
            , T1.SL_DT /*  매출일 */
            , T2.SV_PRD /*  주기(개월)/용도 */
            , T1.RENTAL_RGST_COST / T1.DSC_AMT AS RENTAL_RGST_COST /*  등록비용/할인금액 */
            , T1.ISTM_AMT /*   렌탈총액 */
            , T1.RENTAL_PTRM / T1.RENTAL_AMT AS RENTAL_PTRM /*   월렌탈료1(개월/원) */
            , T1.RENTAL_PTRM2 / T1.RENTAL_AMT2 AS RENTAL_PTRM2 /*   월렌탈료2 */
            , T2.RSTL_YN /*  재약정 할인금액 */
            , 0 AS COL2 /*  회차 */
            , T1.PRM_MCN /*  선납개월 */
            , T1.PRM_DSCR / T1.PRM_DSC_AMT AS PRM_DSCR /* 할인율/할인금액 */
            , T1.PRM_DP_AMT /* 선납금액 */
            , T1.PRM_SL_AMT /* 총액 */
            , '' AS COL3 /* 선납만료컨택담당 */
            , T1.RENTAL_TN /* 렌탈차월 */
            , T1.RENTAL_DC /* 사용일수(개월) */
            , '' AS COL4 /*  취소일자 */
            , T1.NOM_SL_AMT /* 정상매출금액 */
            , T1.NOM_DSC_AMT /* 정상할인금액 */
            , '' AS COL5 /* 완료일자 */
            , T1.SPMT_SL_AMT /* 추가매출금액 */
            , T1.SPMT_DSC_AMT /* 추가할인금액 */
            , T1.SL_CTR_AMT /* 매출조정금액 */
            , T1.THM_SL_SUM_AMT /* 매출금액 */
            , T1.SL_SUM_VAT /* 매출VAT */
            , T1.SL_AGG_AMT /* 매출누계금액 */
            , 0 AS COL6 /* 할인누계 */
            , 0 AS COL7 /* 조정누계 */
            , 0 AS COL8 /* 매출잔액 */
            , T1.BTD_ATAM + T1.PRM_BLAM_BTD_AMT + T1.MLG_DP_AMT AS BTD_ATAM /* 기초금액 */
            , T1.THM_ATAM_DP_AMT /* 선수입금액 */
            , T1.THM_ATAM_RFND_AMT /* 선수환불금액 */
            , 0 AS COL9 /* 매출대체금액 */
            , T1.SL_BND_ALRPY_AMT /* 매출입금액 */
            , T1.SL_DP_AGG_AMT /* 입금누계금액 */
            , 0 AS COL10 /* 선수대체금액 */
            , T1.EOT_ATAM + T1.MLG_EOT_PRPD_AMT AS EOT_TOTAL_AMT /* 선수총액 */
            , T1.EOT_ATAM /* 선납잔액 */
            , T1.MLG_EOT_PRPD_AMT /* PR잔액 */
            , 0 AS COL11 /* 선수잔액 */
            , 0 AS COL12 /* 위약금기초금액 */
            , 0 AS COL13 /* 위약금발생금액 */
            , 0 AS COL14 /* 분실손료 */
            , 0 AS COL15 /* 위약금입금액 */
            , 0 AS COL16 /* 위약금공제금액 */
            , 0 AS COL17 /* 위약금기말금액 */
            , T6.BTD_DLQ_ADD_AMT /* 가산금기초금액 */
            , 0 AS DLQ_ADAMT_OC_AMT /* TODO: 가산금발생금액 */
            , T6.THM_CTR_DLQ_ADD_AMT /* 가산금공제금액 */
            , T6.THM_DLQ_DP_SUM_AMT /* 가산금입금액 */
            , T6.THM_DLQ_RFND_SUM_AMT /* 가산금환불금액 */
            , T6.EOT_DLQ_ADD_AMT /* 가산금기말금액 */
            , 0 AS COL18 /* 유지수당금액 */
            , T6.DLQ_MCN / DLQ_ACU_MCN AS DLQ_MCN /*  연체개월/누계 */
            , T6.THM_OC_DLQ_AMT /*  연체금액 */
            , T8.DFA_AMT /* 대손금액 */
            , T9.DFA_DP_AMT /* 대손입금액 */
            , 0 AS COL19 /* 매출중지 */
            , T7.ACTCS_DT /* 수임일자 */
            , T7.CLCTAM_PRTNR_NO /* 집금담당 */
            , '' AS COL20 /* 발송년월 */
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_SSCT_CNTR_DTL T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_SSCT_CNTR_BAS T3
           ON T1.CNTR_NO = T3.CNTR_NO
         LEFT OUTER JOIN TB_CUBS_CST_BAS T4
           ON T1.CST_NO = T4.CST_NO
         LEFT OUTER JOIN TB_PDBS_PD_BAS T5
           ON T1.PD_CD = T5.PD_CD
         LEFT OUTER JOIN TB_CBCL_DLQ_BAS T6
           ON T1.CNTR_NO = T6.CNTR_NO
          AND T1.CNTR_SN = T6.CNTR_SN
         LEFT OUTER JOIN TB_CBBO_BND_CNTR_BAS T7
           ON T1.CNTR_NO = T7.CNTR_NO
          AND T1.CNTR_SN = T7.CNTR_SN
         LEFT OUTER JOIN TB_CBBO_DFA_IZ T8
           ON T1.CNTR_NO = T8.CNTR_NO
          AND T1.CNTR_SN = T8.CNTR_SN
         LEFT OUTER JOIN TB_CBBO_DFA_DP_IZ T9
           ON T8.DFA_TP_CD = T9.DFA_TP_CD
        WHERE 1=1
          AND T1.SL_CL_YM  = #{slDt}
    </select>

</mapper>
