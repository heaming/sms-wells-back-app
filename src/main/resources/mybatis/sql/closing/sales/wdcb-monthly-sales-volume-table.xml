<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.closing.sales.mapper.WdcbMonthlySalesVolumeTableMapper">

    <select id="selectRentalMonthSalesQuantity" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbMonthlySalesVolumeTableDto$SearchRentalRes">
        SELECT T2.SAP_MAT_CD
		     , T1.BASE_PD_CD
		     , T2.PD_CD
		     , T2.PD_NM
             /*, T3.SELL_PRP_CHVAL*/
	      FROM TB_SSCT_CNTR_DTL T1
	     INNER JOIN TB_PDBS_PD_BAS T2
	        ON T1.BASE_PD_CD = T2.PD_CD
         INNER JOIN TB_SSCT_CNTR_PRC_CMPT_IZ T3
            ON T1.CNTR_NO = T3.CNTR_NO
         INNER JOIN TB_CBCL_WELLS_SL_MM_CL_IZ T4
            ON T3.CNTR_NO = T4.CNTR_NO
         WHERE 1=1
           AND T1.SELL_TP_CD = #{sellTpCd}
           AND T4.SL_DT BETWEEN #{slStartDt} AND #{slEndDt}
        <if test="@MybatisUtils@isNotEmpty(sppMthdTpCd)">
           AND SPP_MTHD_TP_CD = #{sppMthdTpCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(sellInflwChnlDtlCd)">
           AND SELL_INFLW_CHNL_DTL_CD = #{sellInflwChnlDtlCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(copnDvCd)">
           AND COPN_DV_CD = #{copnDvCd}
        </if>
    </select>

    <select id="selectPaymentMonthSalesQuantity" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbMonthlySalesVolumeTableDto$SearchPaymentRes">
        SELECT T2.SAP_MAT_CD     /* SAP상품코드 */
		     , T1.BASE_PD_CD     /* 수불코드 */
		     , T2.PD_CD     /* 상품코드 */
		     , T2.PD_NM     /* 상품명 */
	      FROM TB_SSCT_CNTR_DTL T1
	     INNER JOIN TB_PDBS_PD_BAS T2
	        ON T1.BASE_PD_CD = T2.PD_CD
         INNER JOIN TB_SSCT_CNTR_PRC_CMPT_IZ T3
            ON T1.CNTR_NO = T3.CNTR_NO
         INNER JOIN TB_CBCL_WELLS_SL_MM_CL_IZ T4
            ON T3.CNTR_NO = T4.CNTR_NO
         WHERE 1=1
           AND T1.SELL_TP_CD = #{sellTpCd}
           AND T4.SL_DT BETWEEN #{slStartDt} AND #{slEndDt}
        <if test="@MybatisUtils@isNotEmpty(sppMthdTpCd)">
           AND SPP_MTHD_TP_CD = #{sppMthdTpCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(sellInflwChnlDtlCd)">
           AND SELL_INFLW_CHNL_DTL_CD = #{sellInflwChnlDtlCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(copnDvCd)">
           AND COPN_DV_CD = #{copnDvCd}
        </if>
    </select>
</mapper>
