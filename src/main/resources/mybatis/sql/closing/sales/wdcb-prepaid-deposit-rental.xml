<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.closing.sales.mapper.WdcbPrepaidDepositRentalMapper">
    <select id="selectPrepaidDepositRental" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbPrepaidDepositRentalDto$SearchRes">
       SELECT SUM(T1.RENTAL_TN) AS RENTAL_TN
            , SUM(T1.PRM_MCN) AS PRM_MCN
            , SUM(T1.PRM_DP_AMT) AS PRM_DP_AMT
            , MAX(T1.PRM_STRT_Y||T1.PRM_STRT_MM) || ' ~ ' || MAX(T1.PRM_END_Y||T1.PRM_END_MM) AS PRM_PRD
            , SUM(T1.RENTAL_AMT) AS RENTAL_AMT
            , SUM(T1.THM_ATAM_DP_AMT) AS THM_ATAM_DP_AMT
            , 0 AS COL7
            , SUM(T1.PRM_BLAM_EOT_AMT) AS PRM_BLAM_EOT_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        WHERE T1.CNTR_NO = #{cntrNo}
          AND T1.CNTR_SN = #{cntrSn}
          AND T1.SL_CL_YM BETWEEN #{slClYmFrom} AND #{slClYmTo}
        GROUP BY T1.CNTR_NO, T1.CNTR_SN
    </select>
</mapper>
