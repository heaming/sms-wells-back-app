<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.closing.sales.mapper.WdcbProductSalesMapper">
    <select id="selectSinglePaymentAgrgs" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchSingleAgrgRes">
       SELECT T1.SL_DT
            , T1.SELL_TP_CD
            , '' AS COL1     
            , T1.SELL_QTY AS NORMAL_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS NORMAL_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS NORMAL_MM_ISTM_PCAM_AMT
            , 0 AS NORMAL_VAT
            , T1.NOM_SL_AMT + 0 AS NORMAL_PUR_SL_AMT
            , T1.CNTRAM_DP_AMT AS CHG_SELL_QTY
            , T1.THM_INTAM_DP_AMT AS CHG_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CHG_MM_ISTM_PCAM_AMT
            , 0 AS CHG_VAT
            , T1.SL_CTR_AMT - 0 AS CHG_PUR_SL_AMT
            , T1.SELL_QTY AS CAN_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS CAN_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CAN_MM_ISTM_PCAM_AMT
            , 0 AS CAN_VAT
            , T1.SL_CAN_AMT - 0 AS CAN_PUR_SL_AMT
            , T1.SELL_QTY AS SUM_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS SUM_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS SUM_MM_ISTM_PCAM_AMT
            , T1.SL_SUM_VAT AS SUM_VAT
            , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SUM_PUR_SL_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
           ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
        WHERE 1=1
          AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
          <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
          AND T1.SELL_TP_CD = #{sellTp}
          </if>
          <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
          /* TODO: 판매구분 조건 추가할것 */
          </if>
    </select>
    
    <select id="selectLeaseAgrgs" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchSingleAgrgRes">
       SELECT T1.SL_DT
            , T1.SELL_TP_CD
            , '' AS COL1     
            , T1.SELL_QTY AS NORMAL_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS NORMAL_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS NORMAL_MM_ISTM_PCAM_AMT
            , 0 AS NORMAL_VAT
            , T1.NOM_SL_AMT + 0 AS NORMAL_PUR_SL_AMT
            , T1.CNTRAM_DP_AMT AS CHG_SELL_QTY
            , T1.THM_INTAM_DP_AMT AS CHG_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CHG_MM_ISTM_PCAM_AMT
            , 0 AS CHG_VAT
            , T1.SL_CTR_AMT - 0 AS CHG_PUR_SL_AMT
            , T1.SELL_QTY AS CAN_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS CAN_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CAN_MM_ISTM_PCAM_AMT
            , 0 AS CAN_VAT
            , T1.SL_CAN_AMT - 0 AS CAN_PUR_SL_AMT
            , T1.SELL_QTY AS SUM_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS SUM_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS SUM_MM_ISTM_PCAM_AMT
            , T1.SL_SUM_VAT AS SUM_VAT
            , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SUM_PUR_SL_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
           ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
        WHERE 1=1
          AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
          <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
          AND T1.SELL_TP_CD = #{sellTp}
          </if>
          <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
          /* TODO: 판매구분 조건 추가할것 */
          </if>
    </select>
    
    <select id="selectRegularShippingAgrgs" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchSingleAgrgRes">
       SELECT T1.SL_DT
            , T1.SELL_TP_CD
            , '' AS COL1     
            , T1.SELL_QTY AS NORMAL_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS NORMAL_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS NORMAL_MM_ISTM_PCAM_AMT
            , 0 AS NORMAL_VAT
            , T1.NOM_SL_AMT + 0 AS NORMAL_PUR_SL_AMT
            , T1.CNTRAM_DP_AMT AS CHG_SELL_QTY
            , T1.THM_INTAM_DP_AMT AS CHG_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CHG_MM_ISTM_PCAM_AMT
            , 0 AS CHG_VAT
            , T1.SL_CTR_AMT - 0 AS CHG_PUR_SL_AMT
            , T1.SELL_QTY AS CAN_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS CAN_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CAN_MM_ISTM_PCAM_AMT
            , 0 AS CAN_VAT
            , T1.SL_CAN_AMT - 0 AS CAN_PUR_SL_AMT
            , T1.SELL_QTY AS SUM_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS SUM_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS SUM_MM_ISTM_PCAM_AMT
            , T1.SL_SUM_VAT AS SUM_VAT
            , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SUM_PUR_SL_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
           ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
        WHERE 1=1
          AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
          <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
          AND T1.SELL_TP_CD = #{sellTp}
          </if>
          <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
          /* TODO: 판매구분 조건 추가할것 */
          </if>
    </select>
    
    <select id="selectSinglePaymentProducts" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchSinglePdRes">
       SELECT T1.SL_DT
            , T1.SELL_TP_CD
            , T1.PD_DTL_CD
            , T4.PD_NM
            , '' AS COL1     
            , T1.SELL_QTY AS NORMAL_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS NORMAL_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS NORMAL_MM_ISTM_PCAM_AMT
            , 0 AS NORMAL_VAT
            , T1.NOM_SL_AMT + 0 AS NORMAL_PUR_SL_AMT
            , T1.CNTRAM_DP_AMT AS CHG_SELL_QTY
            , T1.THM_INTAM_DP_AMT AS CHG_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CHG_MM_ISTM_PCAM_AMT
            , 0 AS CHG_VAT
            , T1.SL_CTR_AMT - 0 AS CHG_PUR_SL_AMT
            , T1.SELL_QTY AS CAN_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS CAN_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CAN_MM_ISTM_PCAM_AMT
            , 0 AS CAN_VAT
            , T1.SL_CAN_AMT - 0 AS CAN_PUR_SL_AMT
            , T1.SELL_QTY AS SUM_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS SUM_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS SUM_MM_ISTM_PCAM_AMT
            , T1.SL_SUM_VAT AS SUM_VAT
            , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SUM_PUR_SL_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
           ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
         LEFT OUTER JOIN TB_PDBS_PD_BAS T4
           ON T1.PD_DTL_CD = T4.PD_CD
        WHERE 1=1
          AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
          <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
          AND T1.SELL_TP_CD = #{sellTp}
          </if>
          <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
          /* TODO: 판매구분 조건 추가할것 */
          </if>
    </select>
    
    <select id="selectLeaseProducts" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchSinglePdRes">
       SELECT T1.SL_DT
            , T1.SELL_TP_CD
            , T1.PD_DTL_CD
            , T4.PD_NM
            , '' AS COL1     
            , T1.SELL_QTY AS NORMAL_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS NORMAL_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS NORMAL_MM_ISTM_PCAM_AMT
            , 0 AS NORMAL_VAT
            , T1.NOM_SL_AMT + 0 AS NORMAL_PUR_SL_AMT
            , T1.CNTRAM_DP_AMT AS CHG_SELL_QTY
            , T1.THM_INTAM_DP_AMT AS CHG_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CHG_MM_ISTM_PCAM_AMT
            , 0 AS CHG_VAT
            , T1.SL_CTR_AMT - 0 AS CHG_PUR_SL_AMT
            , T1.SELL_QTY AS CAN_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS CAN_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CAN_MM_ISTM_PCAM_AMT
            , 0 AS CAN_VAT
            , T1.SL_CAN_AMT - 0 AS CAN_PUR_SL_AMT
            , T1.SELL_QTY AS SUM_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS SUM_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS SUM_MM_ISTM_PCAM_AMT
            , T1.SL_SUM_VAT AS SUM_VAT
            , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SUM_PUR_SL_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
           ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
         LEFT OUTER JOIN TB_PDBS_PD_BAS T4
           ON T1.PD_DTL_CD = T4.PD_CD
        WHERE 1=1
          AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
          <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
          AND T1.SELL_TP_CD = #{sellTp}
          </if>
          <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
          /* TODO: 판매구분 조건 추가할것 */
          </if>
    </select>
    
    <select id="selectRegularShippingProducts" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchSinglePdRes">
       SELECT T1.SL_DT
            , T1.SELL_TP_CD
            , T1.PD_DTL_CD
            , T4.PD_NM
            , '' AS COL1     
            , T1.SELL_QTY AS NORMAL_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS NORMAL_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS NORMAL_MM_ISTM_PCAM_AMT
            , 0 AS NORMAL_VAT
            , T1.NOM_SL_AMT + 0 AS NORMAL_PUR_SL_AMT
            , T1.CNTRAM_DP_AMT AS CHG_SELL_QTY
            , T1.THM_INTAM_DP_AMT AS CHG_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CHG_MM_ISTM_PCAM_AMT
            , 0 AS CHG_VAT
            , T1.SL_CTR_AMT - 0 AS CHG_PUR_SL_AMT
            , T1.SELL_QTY AS CAN_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS CAN_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS CAN_MM_ISTM_PCAM_AMT
            , 0 AS CAN_VAT
            , T1.SL_CAN_AMT - 0 AS CAN_PUR_SL_AMT
            , T1.SELL_QTY AS SUM_SELL_QTY
            , CASE T1.SELL_TP_CD WHEN '1' THEN T1.CNTRAM_DP_AMT + T1.THM_INTAM_DP_AMT 
                                 WHEN '3' THEN T1.THM_ATAM_DP_AMT
                                 WHEN '5' THEN T1.SL_BND_ALRPY_AMT END AS SUM_MPY_AMT
            , T3.MM_ISTM_PCAM_AMT AS SUM_MM_ISTM_PCAM_AMT
            , T1.SL_SUM_VAT AS SUM_VAT
            , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SUM_PUR_SL_AMT
         FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
        INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
           ON T1.CNTR_NO = T2.CNTR_NO
          AND T1.CNTR_SN = T2.CNTR_SN
        INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
           ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
         LEFT OUTER JOIN TB_PDBS_PD_BAS T4
           ON T1.PD_DTL_CD = T4.PD_CD
        WHERE 1=1
          AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
          <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
          AND T1.SELL_TP_CD = #{sellTp}
          </if>
          <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
          /* TODO: 판매구분 조건 추가할것 */
          </if>
    </select>
    
    <select id="selectRentalAgrgs" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchRentalAgrgRes">
        SELECT T1.SL_DT
             , T1.SELL_TP_CD
             , 0 AS RGST_QTY
             , T1.RENTAL_RGST_COST - T1.DSC_AMT AS RGST_COST
             , 0 AS RGST_VAT
             , T1.RENTAL_RGST_COST - T1.DSC_AMT AS RGST_SL_AMT
             , 0 AS RENTAL_QTY
             , T1.SL_BND_ALRPY_AMT AS RENTAL_COST
             , 0 AS RENTAL_VAT
             , T1.THM_SL_SUM_AMT AS RENTAL_SL_AMT
             , 0 AS SUM_QTY
             , 0 AS SUM_COST
             , 0 AS SUM_VAT
             , 0 AS SUM_SL_AMT
          FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
         WHERE 1=1
           AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
           <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
           AND T1.SELL_TP_CD = #{sellTp}
           </if>
           <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
           /* TODO: 판매구분 조건 추가할것 */
           </if>
    </select>
    
    <select id="selectRentalProducts" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchRentalPdRes">
        SELECT T1.SL_DT
             , T1.SELL_TP_CD
             , T1.PD_DTL_CD
             , T2.PD_NM
             , 0 AS RGST_QTY
             , T1.RENTAL_RGST_COST - T1.DSC_AMT AS RGST_COST
             , 0 AS RGST_VAT
             , T1.RENTAL_RGST_COST - T1.DSC_AMT AS RGST_SL_AMT
             , 0 AS RENTAL_QTY
             , T1.SL_BND_ALRPY_AMT AS RENTAL_COST
             , 0 AS RENTAL_VAT
             , T1.THM_SL_SUM_AMT AS RENTAL_SL_AMT
             , 0 AS SUM_QTY
             , 0 AS SUM_COST
             , 0 AS SUM_VAT
             , 0 AS SUM_SL_AMT
          FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
          LEFT OUTER JOIN TB_PDBS_PD_BAS T2
            ON T1.PD_DTL_CD = T2.PD_CD
         WHERE 1=1
           AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
           <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
           AND T1.SELL_TP_CD = #{sellTp}
           </if>
           <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
           /* TODO: 판매구분 조건 추가할것 */
           </if>
    </select>
    
    <select id="selectMemberships" resultType="com.kyowon.sms.wells.web.closing.sales.dto.WdcbProductSalesDto$SearchMembershipRes">
        SELECT T1.SL_DT
             , T1.SELL_TP_CD
             , 0 AS SSPCS_SELL_QTY
             , 0 AS SSPCS_MPY_AMT
             , 0 AS SSPCS_VAT
             , T1.THM_SL_SUM_AMT - T1.SL_SUM_VAT AS SSPCS_SL_AMT
             , 0 AS FILT_SELL_QTY
             , 0 AS FILT_MPY_AMT
             , 0 AS FILT_VAT
             , 0 AS FILT_SL_AMT
             , 0 AS SUM_SELL_QTY
             , 0 AS SUM_MPY_AMT
             , 0 AS SUM_VAT
             , 0 AS SUM_SL_AMT
          FROM TB_CBCL_WELLS_SL_MM_CL_IZ T1
         INNER JOIN TB_RVDW_PVDA_PLAN_BAS T2
            ON T1.CNTR_NO = T2.CNTR_NO
           AND T1.CNTR_SN = T2.CNTR_SN
         INNER JOIN TB_RVDW_PVDA_PLAN_DTL T3
            ON T2.PVDA_PLAN_NO = T3.PVDA_PLAN_NO
         WHERE 1=1
           AND T1.SL_DT BETWEEN #{baseDtmnFrom} AND #{baseDtmnTo}
           <if test="@MybatisUtils@isNotEmpty(sellTp) and !@MybatisUtils@equals(sellTp, 'ALL')">
           AND T1.SELL_TP_CD = #{sellTp}
           </if>
           <if test="@MybatisUtils@isNotEmpty(sellDv) and !@MybatisUtils@equals(sellDv, 'ALL')">
           /* TODO: 판매구분 조건 추가할것 */
           </if>
    </select>

</mapper>
