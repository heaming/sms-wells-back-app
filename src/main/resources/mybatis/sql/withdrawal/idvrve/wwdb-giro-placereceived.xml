<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.withdrawal.idvrve.mapper.WwdbGiroPlaceReceivedMapper">
    <select id="selectGiroPlaceReceived" resultType="com.kyowon.sms.wells.web.withdrawal.idvrve.dto.WwdbGiroPlaceReceivedDto$FindRes">
        SELECT
               CNTR_NO
             , CNTR_SN
             , GIRO_BIZ_DV_CD --지로업무구분코드 
             , GIRO_BIZ_TP_CD --지로업무유형코드 판매유형
             , CST_FNM --고객명
             , ZIP --우편번호
             , ADR_DV_CD --주소구분코드
             , BAS_ADR --기본주소
             , DTL_ADR --상세주소
             , DTA_DL_YN --삭제여부
             , FST_RGST_USR_ID --업무담당
             , FNL_MDFC_DTM --일시
          FROM TB_RVDW_GIRO_PLRCV_BAS
         WHERE 1 = 1
           AND CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
           AND DTA_DL_YN = 'N' 
    </select>
    
    <insert id="insertGiroPlaceReceived">
        INSERT INTO TB_RVDW_GIRO_PLRCV_BAS(
            CNTR_NO
          , CNTR_SN
          , GIRO_BIZ_DV_CD --지로업무구분코드 
          , GIRO_BIZ_TP_CD --지로업무유형코드 판매유형
          , CST_FNM --고객명
          , ZIP --우편번호
          , ADR_DV_CD --주소구분코드
          , BAS_ADR --기본주소
          <include refid="COMMON.insertSystemField"/>
        )VALUES(
            #{cntrNo}
          , #{cntrSn}
          , #{giroBizDvCd}
          , #{giroBizTpCd}
          , #{cstFnm}   
          , #{zip}
          , #{adrDvCd}
          , #{basAdr}
          <include refid="COMMON.insertSystemFieldValue" />
        )
        
    </insert>
    
    <update id="updateGiroPlaceReceived">
        UPDATE TB_RVDW_GIRO_PLRCV_BAS 
           SET ZIP = #{zip}--우편번호
             , ADR_DV_CD = #{adrDvCd}--주소구분코드
             , BAS_ADR = #{basAdr}--기본주소
             <include refid="COMMON.updateSystemField"/>
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
    </update>
    <insert id="insertGiroPlaceReceivedHistory">
        INSERT INTO TB_RVDW_GIRO_PLRCV_BAS_HIST(
            CNTR_NO
          , CNTR_SN
          , GIRO_BIZ_DV_CD --지로업무구분코드 
          , GIRO_BIZ_TP_CD --지로업무유형코드 판매유형
          , CST_FNM --고객명
          , ZIP --우편번호
          , ADR_DV_CD --주소구분코드
          , BAS_ADR --기본주소
          , DTL_ADR --상세주소
          , HIST_CH_DTM
          <include refid="COMMON.insertSystemField"/>
        )VALUES(
            #{cntrNo}
          , #{cntrSn}
          , #{giroBizDvCd}
          , #{giroBizTpCd}
          , #{cstFnm}   
          , #{zip}
          , #{adrDvCd}
          , #{basAdr}
          , #{dtlAdr}
          , TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
          <include refid="COMMON.insertSystemFieldValue" />
        )
        
    </insert>
</mapper>