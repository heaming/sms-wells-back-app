<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.withdrawal.interfaces.mapper.WwdbNotPaidMakeAPaymentRgstMapper">

    <select id="selectContractInquiry" resultType="com.kyowon.sms.wells.web.withdrawal.interfaces.dvo.WwdbNotPaidMakeAPaymentContractDvo">
        SELECT T2.CNTR_NO /*계약번호*/
             , T2.CNTR_SN /*계약일련번호*/
             , T1.CNTR_CST_NO /*계약고객번호*/
             , T2.SELL_TP_CD /*판매유형*/
             , T1.CNTR_CNFM_DTM /*확정일시*/
             , T2.BASE_PD_CD /* 상품코드 */
          FROM TB_SSCT_CNTR_BAS T1/*계약기본*/
          JOIN TB_SSCT_CNTR_DTL T2
            ON T2.CNTR_NO = T1.CNTR_NO
           AND T2.DTA_DL_YN = 'N'
         WHERE 1 = 1
           AND T2.CNTR_NO = #{cntrNo}
           AND T2.CNTR_SN = #{cntrSn}
           AND T2.SELL_TP_CD = #{sellTpCd}
           AND T2.DTA_DL_YN = 'N'
    </select>

    <select id="selectContractMonthCloseInquiry" resultType="int">
        SELECT COUNT(*)
          FROM TB_CBCL_WELLS_SL_MM_CL_IZ
         WHERE 1 = 1
           AND SL_CL_YM = TO_CHAR(SYSDATE , 'YYYYMM')
           AND CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
           AND SELL_TP_CD = #{sellTpCd}
           AND DTA_DL_YN = 'N'
    </select>
</mapper>
