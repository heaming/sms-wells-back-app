<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.withdrawal.interfaces.mapper.WwdbEdiCardAprovalRefundInterfaceMapper">

    <select id="selectEdiCardAprovalRefunds" resultType="com.kyowon.sms.wells.web.withdrawal.interfaces.dto.WwdbEdiCardAprovalRefundInterfaceDto$SearchRes">
       SELECT F_CMZ_CD_NM('TNT_WELLS', 'EDI_CARD_TP_CD', A.EDI_CARD_TP_CD) AS EDI_CARD_TP_NM
             , A.EDI_CARD_AGRG_PERF_DT /* 승인일자 (실적일자) */
             , C.CRDCD_SL_CAN_DT /* 취소일자 (매출취소일자) */
             , A.CRDCD_TRD_AMT /* 금액 (카드금액) */
             , A.CRDCD_ISTM_MCN /* 할부개월 */
             , A.CRDCD_APRNO /* 승인번호 */
             , A.CRDCD_EXPDT_YM /* 유효기간 (카드유효기간년월) */
             , A.EDI_RVE_DT /* 수납일자 (EDI수납일자) */
             , A.EDI_CARD_AGRG_TF_DT /* 이관일자 */
             , B.CNTR_NO /* 계약번호 */
             , B.CNTR_SN /* 계약일련번호 */
             , F_CMZ_CD_NM('TNT_WELLS', 'DP_DV_CD', B.EDI_PD_DV_CD) AS EDI_PD_DV_NM /* 상품명 (EDI상품구분코드) */
             , F_CMZ_CD_NM('TNT_WELLS', 'DP_DV_CD', B.EDI_DP_TP_CD) AS EDI_DP_TP_NM /* 유형(인수금, 할부금 …) (EDI입금유형코드) */
             , B.CNTR_CST_NM /* 계약자명(EDI카드내역.고객성명) */
          FROM TB_RVDW_EDI_CARD_AGRG A /* EDI카드집계 */
         INNER JOIN TB_RVDW_EDI_CARD_AGRG_IZ B /* EDI카드집계내역 */
            ON B.KW_GRP_CO_CD = A.KW_GRP_CO_CD
           AND B.EDI_RVE_DV_CD = A.EDI_RVE_DV_CD
           AND B.EDI_RVE_DT = A.EDI_RVE_DT
           AND B.EDI_RVE_NO = A.EDI_RVE_NO
         INNER JOIN TB_RVDW_EDI_CARD_BIL_IZ C /* EDI카드청구내역 */
            ON C.KW_GRP_CO_CD = A.KW_GRP_CO_CD
           AND C.EDI_RVE_DV_CD = A.EDI_RVE_DV_CD
           AND C.EDI_RVE_DT = A.EDI_RVE_DT
           AND C.EDI_RVE_NO = A.EDI_RVE_NO
         WHERE A.CRCDNO_ENCR = #{crcdnoEncr}
    </select>

</mapper>
