<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.withdrawal.interfaces.mapper.WwdbEdiCardAprovalRefundInterfaceMapper">

    <resultMap id="aprovalRefundInfo"
               type="com.kyowon.sms.wells.web.withdrawal.interfaces.dto.WwdbEdiCardAprovalRefundInterfaceDto$SearchRes">
        <constructor>
            <arg name="ediCardTpNm" javaType="java.lang.String" column="EDI_CARD_TP_NM" /> <!-- 구분 -->
            <arg name="cnfmdt" javaType="java.lang.String" column="CNFMDT" /> <!-- 승인일자 -->
            <arg name="slCanDt" javaType="java.lang.String" column="SL_CAN_DT" /> <!-- 취소일자 -->
            <arg name="cardAmt" javaType="java.lang.String" column="CARD_AMT" /> <!-- 금액 -->
            <arg name="istmMcn" javaType="java.lang.String" column="ISTM_MCN" /> <!-- 할부개월 -->
            <arg name="cardAprno" javaType="java.lang.String" column="CARD_APRNO" /> <!-- 승인번호 -->
            <arg name="cardExpdtYm" javaType="java.lang.String" column="CARD_EXPDT_YM" /> <!-- 유효기간 -->
            <arg name="ediRveDt" javaType="java.lang.String" column="EDI_RVE_DT" /> <!-- 수납일자 -->
            <arg name="tfDt" javaType="java.lang.String" column="TF_DT" /> <!-- 이관일자 -->
            <arg name="cntrNo" javaType="java.lang.String" column="CNTR_NO" /> <!-- 계약번호 -->
            <arg name="cntrSn" javaType="java.lang.String" column="CNTR_SN" /> <!-- 계약일련번호 -->
            <arg name="ediPdDvCd" javaType="java.lang.String" column="EDI_PD_DV_CD" /> <!-- 상품명 -->
            <arg name="ediDpTpCd" javaType="java.lang.String" column="EDI_DP_TP_CD" /> <!-- 유형 -->
            <arg name="cstFnm" javaType="java.lang.String" column="CST_FNM" /> <!-- 계약자명 -->
        </constructor>
    </resultMap>

    <select id="selectEdiCardAprovalRefunds" resultMap="aprovalRefundInfo">
        SELECT F_CMZ_CD_NM('TNT_WELLS', 'EDI_CARD_TP_CD', A.EDI_CARD_TP_CD) AS EDI_CARD_TP_NM
             , A.CNFMDT
             , C.SL_CAN_DT
             , B.CARD_AMT
             , A.ISTM_MCN
             , A.CARD_APRNO
             , A.CARD_EXPDT_YM
             , A.EDI_RVE_DT
             , A.TF_DT
             , B.CNTR_NO
             , B.CNTR_SN
             , B.EDI_PD_DV_CD
             , B.EDI_DP_TP_CD
             , B.CST_FNM
          FROM TB_RVDW_EDI_CARD_AGRG A
         INNER JOIN TB_RVDW_EDI_CARD_IZ B
            ON B.RVE_CRP_CD = A.RVE_CRP_CD
           AND B.EDI_RVE_DV_CD = A.EDI_RVE_DV_CD
           AND B.EDI_RVE_DT = A.EDI_RVE_DT
           AND B.EDI_RVE_NO = A.EDI_RVE_NO
         INNER JOIN TB_RVDW_EDI_CARD_BIL_IZ C
            ON C.RVE_CRP_CD = A.RVE_CRP_CD
           AND C.EDI_RVE_DV_CD = A.EDI_RVE_DV_CD
           AND C.EDI_RVE_DT = A.EDI_RVE_DT
           AND C.EDI_RVE_NO = A.EDI_RVE_NO
         WHERE A.CRCDNO_ENCR = #{crcdnoEncr}
    </select>
</mapper>
