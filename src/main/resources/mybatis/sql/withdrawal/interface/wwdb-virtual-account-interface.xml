<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.withdrawal.interfaces.mapper.WwdbVirtualAccountInterfaceMapper">

    <resultMap id="issueInfo" type="com.kyowon.sms.wells.web.withdrawal.interfaces.dto.WwdbVirtualAccountInterfaceDto$SearchRes">
        <constructor>
            <arg name="cntrNo" javaType="java.lang.String" column="CNTR_NO" />
            <arg name="cntrSn" javaType="java.lang.String" column="CNTR_SN" />
            <arg name="basePdCd" javaType="java.lang.String" column="BASE_PD_CD" />
            <arg name="pdNm" javaType="java.lang.String" column="PD_NM" />
            <arg name="vacBnkCd" javaType="java.lang.String" column="VAC_BNK_CD" />
            <arg name="vacNo" javaType="java.lang.String" column="VAC_NO" />
            <arg name="vacDprNm" javaType="java.lang.String" column="VAC_DPR_NM" />
            <arg name="sellTpCd" javaType="java.lang.String" column="SELL_TP_CD" />
            <arg name="sellTpNm" javaType="java.lang.String" column="SELL_TP_NM" />
        </constructor>
    </resultMap>

    <select id="selectVirtualAccountIssues" resultMap="issueInfo">
        SELECT B.CNTR_NO
             , B.CNTR_SN
             , C.BASE_PD_CD
             , E.PD_NM
             , A.VAC_BNK_CD
             , A.VAC_NO
             , D.VAC_DPR_NM
             , C.SELL_TP_CD
             , F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', C.SELL_TP_CD) AS SELL_TP_NM
          FROM TB_RVDW_VAC_IS_IZ A
          LEFT JOIN TB_RVDW_VAC_IS_DTL B
            ON B.KW_GRP_CO_CD = A.KW_GRP_CO_CD
           AND B.VAC_IS_ID = A.VAC_IS_ID
          LEFT JOIN TB_SSCT_CNTR_DTL C
            ON C.CNTR_NO = B.CNTR_NO
           AND C.CNTR_SN = B.CNTR_SN
          LEFT JOIN TB_RVDW_VAC_DP_IZ D
            ON D.KW_GRP_CO_CD = A.KW_GRP_CO_CD
           AND D.VAC_IS_ID = A.VAC_IS_ID
          LEFT JOIN TB_PDBS_PD_BAS E
            ON E.PD_CD = C.BASE_PD_CD
         WHERE A.VAC_NO = #{vacNo}
           AND B.CNTR_NO = #{cntrNo}
           AND B.CNTR_SN = #{cntrSn}
    </select>
</mapper>
