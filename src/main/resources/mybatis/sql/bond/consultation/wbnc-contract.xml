<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.bond.consultation.mapper.WbncContractMapper">
    <select id="selectContracts" resultType="com.kyowon.sms.wells.web.bond.consultation.dto.WbncContractDto$SearchRes">
        SELECT CTT                          /* 컨택 */
		     , BIZ_DV                        /* 업무구분 */
		     , PRDF /* 제품군 */
		     , PDCT_NM                      /* 제품명 */
		     , CNTR_NO                      /* 계약번호 */
		     , CNTR_SN                      /* 계약일련번호 */
		     , CST_NM                        /* 고객명 */
		     , DLQ_MCNT                    /* 연체개월 */
		     , OJ_AMT                        /* 대상금액 */
		     , OJ_DP                      /* 대상입금 */
		     , OJ_BLAM                      /* 대상금액 - 대상입금 = 대상잔액 */
		     , TOT_DLQ_AMT                  /* 연체금액 + 연체가산금 = 총연체금 */
		     , TOT_DLQ_DP                    /* 연체입금금액 + 연체가산금입금금액 = 총연체입금 */
		     , TOT_DLQ_BLAM                /* 총연체금 - 총연체입금 = 총연체잔액 */
		     , DLQ_AMT                      /* 연체금액 */
		     , DLQ_DP                        /* 연체입금 */
		     , DLQ_BLAM                    /* 연체금액 - 연체입금 = 연체잔액 */
		     , MM_CHRAM_AMT                /* 월요금액 */
		     , MM_CHRAM_DP                  /* 월요금입금 */
		     , MM_CHRAM_BLAM              /* 당월요금금액 - 당월요금입금금액 = 월요금잔액 */
		     , DLQ_ADD_AMT                  /* 연체가산금액 */
		     , DLQ_ADD_DP                    /* 연체가산입금 */
		     , DLQ_ADAMT_BLAM                /* 연체가산금액 - 연체가산금입금금액 = 연체가산금잔액 */
		     , UC_AMT                        /* 미수금액 */
		     , RSG_BOR_DP_AMT
		     , UC_DP                      /* 미수입금 */
		     , UC_BLAM                      /* 미수금 - 총입금액 = 미수잔액 */
		     , TOT_DP_AMT                    /* 연체입금금액 + 연체가산입금금액 + 해지위약금입금금액 + 당월요금입금금액 = 총입금액 */
		     , SPMT_SL                      /* 추가매출 */
		     , CCAM                        /* 위약금 */
		     , LSFE                        /* 분실료 */
		     , RTLFE1                        /* 렌탈료1 */
		     , RTLFE_ISTM1                  /* 렌탈료1할 */
		     , RTLFE2                        /* 렌탈료2 */
		     , RTLFE_ISTM2                  /* 렌탈료2할 */
		     , PROM_DT /* 약속일자 */
		     , DPR_NM /* 입금자명 */
		     , CVCP_INF                    /* 민원정보 */
		     , CLCTAM_PRTNR_NO              /* 집금번호 */
		     , CLCTAM_ICHR                  /* 집급담당 */
		     , CNTR_CRAL_LOCARA_TNO
		     , CNTR_MEXNO_ENCR
		     , CNTR_CRAL_IDV_TNO          /* 계약휴대전화번호 */
		     , CNTR_LOCARA_TNO
		     , CNTR_EXNO_ENCR
		     , CNTR_IDV_TNO                /* 계약전화번호 */
		     , IST_CRAL_LOCARA_TNO
		     , IST_MEXNO_ENCR
		     , IST_CRAL_IDV_TNO            /* 설치휴대전화번호 */
		     , IST_LOCARA_TNO
		     , IST_EXNO_ENCR
		     , IST_IDV_TNO                  /* 설치전화번호 */
		     , CST_NO                       /* 고객번호 */
		     , TF_DT                      /* 이관일자 */
		     , BU_NOTI_DT                    /* 부담통보일자 */
		     , BU_NOTI_TP                    /* 부담통보유형 */
		     , CNTR_ZIP                    /* 계약우편번호 */
		     , CNTR_ADR                    /* 계약주소 */
		     , IST_ZIP                      /* 설치우편번호 */
		     , IST_ADR                      /* 설치주소 */
		     , VT_AC_BNK                  /* 가상계좌은행 */
		     , VT_AC_NO                    /* 가상계좌번호 */
		     , PESU_DT                      /* 독촉일자 */
		     , HI_DT                      /* 최고일자 */
		     , OVRD_DT                      /* 채불일자 */
		     , CPSN_EFCM  /* 강제집행*/
		     , DSB_CMD  /* 지급명령*/
		     , PRTY_CLRS  /* 재산명시*/
		     , SUBM_CMD  /* 제출명령*/
		     , CRC_CMD  /* 보정명령*/
		     , CUJ_OVRD  /* 법원채불*/
		     , VST_RS                        /* 방문결과*/
		     , VST_DT                        /* 방문일자*/
		     , SFK                          /* 세이프키*/
		     , UNUITM                        /* 특이사항*/
		     , BND_BIZ_DV_CD              /* 업무구분 */
		     , CNTR_TP_CD                    /* 고객구분*/
		     , BIL_DT                        /* 이체일자 */
		     , BIL_TP_CD                  /* 납부방식유형코드*/
		  FROM (
		        SELECT MAX(CTT) AS CTT                          /* 컨택 */
		             , MAX(BIZ_DV) AS BIZ_DV                        /* 업무구분 */
		             , (SELECT TT3.PD_CLSF_NM
		                  FROM TB_SSCT_CNTR_DTL TT1
		                 INNER JOIN TB_PDBS_PD_BAS TT2 ON TT2.PD_CD = TT1.BASE_PD_CD
		                 INNER JOIN TB_PDBS_PD_CLSF_BAS TT3 ON TT3.PD_CLSF_ID = TT2.PD_MCLSF_ID
		                 WHERE TT1.CNTR_NO = V1.CNTR_NO AND TT1.CNTR_SN = V1.CNTR_SN) AS PRDF /* 제품군 */
		             , MAX(PDCT_NM) AS PDCT_NM                      /* 제품명 */
		             , CNTR_NO                      /* 계약번호 */
		             , CNTR_SN                      /* 계약일련번호 */
		             , MAX(CST_NM) AS CST_NM                        /* 고객명 */
		             , MIN(DLQ_MCNT) AS DLQ_MCNT                    /* 연체개월 */
		             , MAX(OJ_AMT) AS OJ_AMT                        /* 대상금액 */
		             , MAX(OJ_DP) AS OJ_DP                      /* 대상입금 */
		             , MAX(OJ_BLAM) AS OJ_BLAM                      /* 대상금액 - 대상입금 = 대상잔액 */
		             , MAX(TOT_DLQ_AMT) AS TOT_DLQ_AMT                  /* 연체금액 + 연체가산금 = 총연체금 */
		             , MAX(TOT_DLQ_DP) AS TOT_DLQ_DP                    /* 연체입금금액 + 연체가산금입금금액 = 총연체입금 */
		             , MAX(TOT_DLQ_BLAM) AS TOT_DLQ_BLAM                /* 총연체금 - 총연체입금 = 총연체잔액 */
		             , MAX(DLQ_AMT) AS DLQ_AMT                      /* 연체금액 */
		             , MAX(DLQ_DP) AS DLQ_DP                        /* 연체입금 */
		             , MAX(DLQ_BLAM) AS DLQ_BLAM                    /* 연체금액 - 연체입금 = 연체잔액 */
		             , MAX(MM_CHRAM_AMT) AS MM_CHRAM_AMT                /* 월요금액 */
		             , MAX(MM_CHRAM_DP) AS MM_CHRAM_DP                  /* 월요금입금 */
		             , MAX(MM_CHRAM_BLAM) AS MM_CHRAM_BLAM              /* 당월요금금액 - 당월요금입금금액 = 월요금잔액 */
		             , MAX(DLQ_ADD_AMT) AS DLQ_ADD_AMT                  /* 연체가산금액 */
		             , MAX(DLQ_ADD_DP) AS DLQ_ADD_DP                    /* 연체가산입금 */
		             , MAX(DLQ_ADAMT_BLAM) AS DLQ_ADAMT_BLAM                /* 연체가산금액 - 연체가산금입금금액 = 연체가산금잔액 */
		             , MAX(UC_AMT) AS UC_AMT                        /* 미수금액 */
		             , MAX(RSG_BOR_DP_AMT) AS RSG_BOR_DP_AMT
		             , MAX(UC_DP) AS UC_DP                      /* 미수입금 */
		             , MAX(UC_BLAM) AS UC_BLAM                      /* 미수금 - 총입금액 = 미수잔액 */
		             , MAX(TOT_DP_AMT) AS TOT_DP_AMT                    /* 연체입금금액 + 연체가산입금금액 + 해지위약금입금금액 + 당월요금입금금액 = 총입금액 */
		             , MAX(SPMT_SL) AS SPMT_SL                      /* 추가매출 */
		             , MAX(CCAM) AS CCAM                        /* 위약금 */
		             , MAX(LSFE) AS LSFE                        /* 분실료 */
		             , MAX(RTLFE1) AS RTLFE1                        /* 렌탈료1 */
		             , MAX(RTLFE_ISTM1) AS RTLFE_ISTM1                  /* 렌탈료1할 */
		             , MAX(RTLFE2) AS RTLFE2                        /* 렌탈료2 */
		             , MAX(RTLFE_ISTM2) AS RTLFE_ISTM2                  /* 렌탈료2할 */
		             , (SELECT T7.PROM_DT
		                  FROM TB_CBBO_BND_CNSL_PROM_BOO_IZ T7 /* 채권상담약속예약내역 */
		                 WHERE 1=1
		                   AND DTA_DL_YN = 'N'
		                   AND V1.CST_NO = T7.CST_NO
		                   AND ROWNUM <![CDATA[<=]]> 1
		                ) AS PROM_DT /* 약속일자 */
		             , (SELECT T2.DPR_NM
		                  FROM (SELECT
		                             T2.DPR_NM
		                        FROM TB_CBBO_BND_TEL_CNSL_IZ T2 /* 채권전화상담내역 */
		                       WHERE V1.CST_NO = T2.CST_NO
		                       ORDER BY T2.FST_RGST_DTM DESC FETCH FIRST 1 ROW ONLY) T2
		               ) AS DPR_NM /* 입금자명 */
		             , MAX(CVCP_INF) AS CVCP_INF                    /* 민원정보 */
		             , MAX(CLCTAM_PRTNR_NO) AS CLCTAM_PRTNR_NO              /* 집금번호 */
		             , MAX(CLCTAM_ICHR) AS CLCTAM_ICHR                  /* 집급담당 */
		             , MAX(CNTR_CRAL_LOCARA_TNO) AS CNTR_CRAL_LOCARA_TNO
		             , MAX(CNTR_MEXNO_ENCR) AS CNTR_MEXNO_ENCR
		             , MAX(CNTR_CRAL_IDV_TNO) AS CNTR_CRAL_IDV_TNO          /* 계약휴대전화번호 */
		             , MAX(CNTR_LOCARA_TNO) AS CNTR_LOCARA_TNO
		             , MAX(CNTR_EXNO_ENCR) AS CNTR_EXNO_ENCR
		             , MAX(CNTR_IDV_TNO) AS CNTR_IDV_TNO                /* 계약전화번호 */
		             , MAX(IST_CRAL_LOCARA_TNO) AS IST_CRAL_LOCARA_TNO
		             , MAX(IST_MEXNO_ENCR) AS IST_MEXNO_ENCR
		             , MAX(IST_CRAL_IDV_TNO) AS IST_CRAL_IDV_TNO            /* 설치휴대전화번호 */
		             , MAX(IST_LOCARA_TNO) AS IST_LOCARA_TNO
		             , MAX(IST_EXNO_ENCR) AS IST_EXNO_ENCR
		             , MAX(IST_IDV_TNO) AS IST_IDV_TNO                  /* 설치전화번호 */
		             , CST_NO                       /* 고객번호 */
		             , MAX(TF_DT) AS TF_DT                      /* 이관일자 */
		             , MAX(BU_NOTI_DT) AS BU_NOTI_DT                    /* 부담통보일자 */
		             , MAX(BU_NOTI_TP) AS BU_NOTI_TP                    /* 부담통보유형 */
		             , MAX(CNTR_ZIP) AS CNTR_ZIP                    /* 계약우편번호 */
		             , MAX(CNTR_ADR) AS CNTR_ADR                    /* 계약주소 */
		             , MAX(IST_ZIP) AS IST_ZIP                      /* 설치우편번호 */
		             , MAX(IST_ADR) AS IST_ADR                      /* 설치주소 */
		             , MAX(VT_AC_BNK) AS VT_AC_BNK                  /* 가상계좌은행 */
		             , MAX(VT_AC_NO) AS VT_AC_NO                    /* 가상계좌번호 */
		             , MAX(PESU_DT) AS PESU_DT                      /* 독촉일자 */
		             , MAX(HI_DT) AS HI_DT                      /* 최고일자 */
		             , MAX(OVRD_DT) AS OVRD_DT                      /* 채불일자 */
		             , ( SELECT LWM_DT
		                   FROM TB_CBBO_BND_LWM_IZ
		                  WHERE CST_NO = V1.CST_NO
		                    AND LWM_TP_CD = '01'
		                    AND LWM_DTL_TP_CD = '01'
		               ) AS CPSN_EFCM  /* 강제집행*/
		             , ( SELECT LWM_DT
		                   FROM TB_CBBO_BND_LWM_IZ
		                  WHERE CST_NO = V1.CST_NO AND LWM_TP_CD = '02' AND LWM_DTL_TP_CD = '02'
		                  AND ROWNUM <![CDATA[<=]]> 1
		               ) AS DSB_CMD  /* 지급명령*/
		             , ( SELECT LWM_DT
		                   FROM TB_CBBO_BND_LWM_IZ
		                  WHERE CST_NO = V1.CST_NO AND LWM_TP_CD = '03' AND LWM_DTL_TP_CD = '03'
		                  AND ROWNUM <![CDATA[<=]]> 1
		               ) AS PRTY_CLRS  /* 재산명시*/
		             , ( SELECT LWM_DT
		                   FROM TB_CBBO_BND_LWM_IZ
		                  WHERE CST_NO = V1.CST_NO AND LWM_TP_CD = '04' AND LWM_DTL_TP_CD = '04'
		                  AND ROWNUM <![CDATA[<=]]> 1
		               ) AS SUBM_CMD  /* 제출명령*/
		             , ( SELECT LWM_DT
		                   FROM TB_CBBO_BND_LWM_IZ
		                  WHERE CST_NO = V1.CST_NO AND LWM_TP_CD = '06' AND LWM_DTL_TP_CD = '06'
		                  AND ROWNUM <![CDATA[<=]]> 1
		               ) AS CRC_CMD  /* 보정명령*/
		             , ( SELECT LWM_DT
		                   FROM TB_CBBO_BND_LWM_IZ
		                  WHERE CST_NO = V1.CST_NO AND LWM_TP_CD = '07' AND LWM_DTL_TP_CD = '07'
		                  AND ROWNUM <![CDATA[<=]]> 1
		               ) AS CUJ_OVRD  /* 법원채불*/
		             , MAX(VST_RS) AS VST_RS                        /* 방문결과*/
		             , MAX(VST_DT) AS VST_DT                        /* 방문일자*/
		             , MAX(SFK) AS SFK                          /* 세이프키*/
		             , MAX(UNUITM) AS UNUITM                        /* 특이사항*/
		             , MAX(BND_BIZ_DV_CD) AS BND_BIZ_DV_CD              /* 업무구분 */
		             , MAX(CNTR_TP_CD) AS CNTR_TP_CD                    /* 고객구분*/
		             , MAX(BIL_DT) AS BIL_DT                        /* 이체일자 */
		             , MAX(BIL_TP_CD) AS BIL_TP_CD                  /* 납부방식유형코드*/
		          FROM (
		                SELECT (SELECT  CASE WHEN T1.BND_ASN_DT  >  T2.FST_RGST_DTM AND SUBSTR( T2.TEL_CNSL_RS_CD , 1 ,1 ) = 1 THEN '○'
		                                     WHEN T1.BND_ASN_DT  >  T2.FST_RGST_DTM AND SUBSTR( T2.TEL_CNSL_RS_CD , 1 ,1 ) = 2 THEN '△'
		                                     ELSE 'Ｘ'
		                                END AS CTT
		                           FROM (SELECT
		                                      T2.TEL_CNSL_RS_CD
		                                    , T2.FST_RGST_DTM
		                                 FROM TB_CBBO_BND_TEL_CNSL_IZ T2 /* 채권전화상담내역 */
		                                WHERE T1.CST_NO = T2.CST_NO
		                                ORDER BY T2.FST_RGST_DTM DESC FETCH FIRST 1 ROW ONLY) T2
		                       ) AS CTT /* 컨택 */
		                     , (SELECT F_CMZ_CD_NM('TNT_WELLS', 'SELL_TP_CD', T3.SELL_TP_CD) FROM DUAL) AS BIZ_DV/* 업무구분 */
		                     , (SELECT T4.PD_NM FROM TB_PDBS_PD_BAS T4 /* 상품기본 */
		                         WHERE T3.BASE_PD_CD = T4.PD_CD) AS PDCT_NM /* 제품명 */
		                     , T1.CNTR_NO AS CNTR_NO /* 계약번호 */
		                     , T1.CNTR_SN AS CNTR_SN /* 계약일련번호 */
		                     , T5.CST_KNM AS CST_NM /* 고객명 */
		                     , T6.DLQ_MCN AS DLQ_MCNT /* 연체개월 */
		                     , (NVL(T6.DLQ_AMT, 0) + NVL(T6.DLQ_ADD_AMT, 0)) + NVL(T6.THM_CHRAM_AMT, 0) AS OJ_AMT /* 대상금액 */
		                     , (NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0)) + NVL(T6.THM_CHRAM_DP_AMT, 0) AS OJ_DP /* 대상입금 */
		                     , ((NVL(T6.DLQ_AMT, 0) + NVL(T6.DLQ_ADD_AMT, 0)) + NVL(T6.THM_CHRAM_AMT, 0)) - ((NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0)) + NVL(T6.THM_CHRAM_DP_AMT, 0)) AS OJ_BLAM /* 대상금액 - 대상입금 = 대상잔액 */
		                     , NVL(T6.DLQ_AMT, 0) + NVL(T6.DLQ_ADD_AMT, 0) AS TOT_DLQ_AMT /* 연체금액 + 연체가산금 = 총연체금 */
		                     , NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0) AS TOT_DLQ_DP /* 연체입금금액 + 연체가산금입금금액 = 총연체입금 */
		                     , (NVL(T6.DLQ_AMT, 0) + NVL(T6.DLQ_ADD_AMT, 0)) - (NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0)) AS TOT_DLQ_BLAM /* 총연체금 - 총연체입금 = 총연체잔액 */
		                     , NVL(T6.DLQ_AMT, 0) AS DLQ_AMT /* 연체금액 */
		                     , NVL(T6.DLQ_DP_AMT, 0) AS DLQ_DP /* 연체입금 */
		                     , NVL(T6.DLQ_AMT, 0) - NVL(T6.DLQ_DP_AMT, 0) AS DLQ_BLAM /* 연체금액 - 연체입금 = 연체잔액 */
		                     , NVL(T6.THM_CHRAM_AMT, 0) AS MM_CHRAM_AMT /* 월요금액 */
		                     , NVL(T6.THM_CHRAM_DP_AMT, 0) AS MM_CHRAM_DP /* 월요금입금 */
		                     , NVL(T6.THM_CHRAM_AMT, 0) - NVL(T6.THM_CHRAM_DP_AMT, 0) AS MM_CHRAM_BLAM /* 당월요금금액 - 당월요금입금금액 = 월요금잔액 */
		                     , NVL(T6.DLQ_ADD_AMT, 0) AS DLQ_ADD_AMT /* 연체가산금액 */
		                     , NVL(T6.DLQ_ADD_DP_AMT, 0) AS DLQ_ADD_DP /* 연체가산입금 */
		                     , NVL(T6.DLQ_ADD_AMT, 0) - NVL(T6.DLQ_ADD_DP_AMT, 0) AS DLQ_ADAMT_BLAM /* 연체가산금액 - 연체가산금입금금액 = 연체가산금잔액 */
		                     , NVL(T6.UC_AMT, 0) AS UC_AMT /* 미수금액 */
		                     , NVL(T6.RSG_BOR_DP_AMT, 0) AS RSG_BOR_DP_AMT
		                     , NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0) + NVL(T6.RSG_BOR_DP_AMT, 0) + NVL(T6.THM_CHRAM_DP_AMT, 0) AS UC_DP /* 미수입금 */
		                     , NVL(T6.UC_AMT, 0) - (NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0) + NVL(T6.RSG_BOR_DP_AMT, 0) + NVL(T6.THM_CHRAM_DP_AMT, 0)) AS UC_BLAM /* 미수금 - 총입금액 = 미수잔액 */
		                     , NVL(T6.DLQ_DP_AMT, 0) + NVL(T6.DLQ_ADD_DP_AMT, 0) + NVL(T6.RSG_BOR_DP_AMT, 0) + NVL(T6.THM_CHRAM_DP_AMT, 0) AS TOT_DP_AMT /* 연체입금금액 + 연체가산입금금액 + 해지위약금입금금액 + 당월요금입금금액 = 총입금액 */
		                     , NVL(T17.SPMT_SL_AMT, 0) AS SPMT_SL /* 추가매출 */
		                     , NVL(T18.BOR_AMT, 0) AS CCAM /* 위약금 */
		                     , NVL(T18.LS_RNTF, 0) AS LSFE /* 분실료 */
		                     , NVL(T17.RENTAL_AMT, 0) AS RTLFE1 /* 렌탈료1 */
		                     , NVL(T17.RENTAL_DSC_AMT, 0) AS RTLFE_ISTM1 /* 렌탈료1할 */
		                     , NVL(T17.RENTAL_AMT2, 0) AS RTLFE2 /* 렌탈료2 */
		                     , NVL(T17.RENTAL_DSC_AMT2, 0) AS RTLFE_ISTM2 /* 렌탈료2할 */
		                     , T8.CVCP_CN AS CVCP_INF /* 민원정보 */
		                     , T1.CLCTAM_PRTNR_NO /* 집금번호 */
		                     , (SELECT DISTINCT PRTNR_KNM FROM TB_CBBO_CLCTAM_PRTNR_DTL WHERE PRTNR_NO = T1.CLCTAM_PRTNR_NO) AS CLCTAM_ICHR   /* 집급담당 */
		                     , T5.CRAL_LOCARA_TNO AS CNTR_CRAL_LOCARA_TNO
		                     , T5.MEXNO_ENCR AS CNTR_MEXNO_ENCR
		                     , T5.CRAL_IDV_TNO AS CNTR_CRAL_IDV_TNO /* 계약휴대전화번호 */
		                     , T9.LOCARA_TNO AS CNTR_LOCARA_TNO
		                     , T9.EXNO_ENCR AS CNTR_EXNO_ENCR
		                     , T9.IDV_TNO AS CNTR_IDV_TNO /* 계약전화번호 */
		                     , T14.CRAL_LOCARA_TNO AS IST_CRAL_LOCARA_TNO
		                     , T14.MEXNO_ENCR AS IST_MEXNO_ENCR
		                     , T14.CRAL_IDV_TNO AS IST_CRAL_IDV_TNO /* 설치휴대전화번호 */
		                     , T14.LOCARA_TNO AS IST_LOCARA_TNO
		                     , T14.EXNO_ENCR AS IST_EXNO_ENCR
		                     , T14.IDV_TNO AS IST_IDV_TNO /* 설치전화번호 */
		                     , T1.CST_NO AS CST_NO /* 고객번호 */
		                     , T1.BND_TF_DT AS TF_DT /* 이관일자 */
		                     , T10.BU_NOTI_DT AS BU_NOTI_DT /* 부담통보일자 */
		                     , T10.BU_NOTI_TP_CD AS BU_NOTI_TP /* 부담통보유형 */
		                     , T9.SPP_ZIP AS CNTR_ZIP /* 계약우편번호 */
		                     , T9.SPP_ADR || T9.SPP_DTL_ADR AS CNTR_ADR /* 계약주소 */
		                     , T14.SPP_ZIP AS IST_ZIP /* 설치우편번호 */
		                     , T14.SPP_ADR || T14.SPP_DTL_ADR AS IST_ADR /* 설치주소 */
		                     , (SELECT F_CMZ_CD_NM('TNT_WELLS', 'BNK_CD', T11.VAC_BNK_CD) FROM DUAL) AS VT_AC_BNK /* 가상계좌은행 */
		                     , T11.VAC_NO AS VT_AC_NO /* 가상계좌번호 */
		                     , T12.PESU_DT AS PESU_DT /* 독촉일자 */
		                     , T12.RMDR_DT AS HI_DT /* 최고일자 */
		                     , T12.DFLT_DT AS OVRD_DT /* 채불일자 */
		                     , T13.BND_VST_RS_CD AS VST_RS  /* 방문결과*/
		                     , T13.VST_DT AS VST_DT  /* 방문일자*/
		                     , T5.SFK_VAL AS SFK /* 세이프키*/
		                     , T8.CNSL_UNUITM_CN AS UNUITM /* 특이사항*/
		                     , T6.BND_BIZ_DV_CD /* 업무구분 */
		                     , T15.CNTR_TP_CD /* 고객구분*/
		                     , T16.BIL_DT /* 이체일자 */
		                     , T16.BIL_TP_CD /* 납부방식유형코드*/
		                  FROM TB_CBBO_BND_CNSL_BAS_IZ T1 /* 채권상담기본내역 */
		                  LEFT OUTER JOIN TB_SSCT_CNTR_DTL T3 /* 계약상세 */
		                    ON T1.CNTR_NO = T3.CNTR_NO
		                   AND T1.CNTR_SN = T3.CNTR_SN
		                 INNER JOIN TB_CUBS_CST_BAS T5 /* 고객기본 */
		                    ON T1.CST_NO = T5.CST_NO
		                  LEFT OUTER JOIN TB_CBBO_BND_CNTR_BAS T6 /* 채권계약기본 */
		                    ON T1.CNTR_NO = T6.CNTR_NO
		                   AND T1.CNTR_SN = T6.CNTR_SN
		                  LEFT OUTER JOIN LATERAL
		                                (
		                                  SELECT CST_NO
		                                       , CNTR_NO
		                                       , CVCP_CN
		                                       , CNSL_UNUITM_CN
		                                    FROM TB_CBBO_BND_UNUITM_CVCP_DTL T8 /* 채권특이사항민원상세 */
		                                   WHERE 1=1
		                                     AND DTA_DL_YN = 'N'
		                                     AND T1.CST_NO = T8.CST_NO
		                                     AND T1.CNTR_NO = T8.CNTR_NO
		                                     AND ROWNUM <![CDATA[<=]]> 1
		                                ) T8
		                    ON 1=1
		                  LEFT OUTER JOIN
		                                (
		                                  SELECT CR.CNTR_ADRPC_ID
		                                         , CR.DTL_CNTR_NO
		                                         , CR.DTL_CNTR_SN
		                                         , CB.LOCARA_TNO
		                                         , CB.EXNO_ENCR
		                                         , CB.IDV_TNO
		                                         , CB.CRAL_LOCARA_TNO
		                                         , CB.MEXNO_ENCR
		                                         , CB.CRAL_IDV_TNO
		                                         , NVL(AB.NEW_ADR_ZIP, AB.OLD_ADR_ZIP) AS SPP_ZIP
		                                         , NVL(AB.RNADR, AB.LTN_ADR) AS SPP_ADR
		                                         , NVL(AB.RDADR, AB.LTN_DTL_ADR) AS SPP_DTL_ADR
		                                      FROM TB_SSCT_CNTR_ADR_REL CR /* 계약주소관계 */
		                                      LEFT OUTER JOIN TB_SSCT_CNTR_ADRPC_BAS CB /* 계약주소지기본 */
		                                        ON CB.CNTR_ADRPC_ID = CR.CNTR_ADRPC_ID
		                                      LEFT OUTER JOIN TB_GBCO_ADR_BAS AB /* 주소기본 */
		                                        ON AB.ADR_ID = CB.ADR_ID
		                                     WHERE CR.CNTR_UNIT_TP_CD = '020'
		                                       AND CR.ADRPC_TP_CD = '1'  /* 계약주소 */
		                                       AND CR.DTA_DL_YN = 'N'
		                                ) T9
		                    ON T1.CNTR_NO = T9.DTL_CNTR_NO
		                   AND T1.CNTR_SN = T9.DTL_CNTR_SN
		                  LEFT OUTER JOIN TB_FEDD_BU_NOTI_RGST_BAS T10 /* 부담통보등록기본 */
		                    ON T1.CNTR_NO = T10.CNTR_NO
		                   AND T1.CNTR_SN = T10.CNTR_SN
		                  LEFT OUTER JOIN TB_RVDW_VAC_BAS T11 /* 가상계좌기본 */
		                    ON T11.VAC_IS_DV_CD = '5'/*가상계좌발급구분코드 = 연체집금용*/
		                   AND T11.VAC_STAT_CD = '1'/*가상계좌상태코드 = 할당*/
		                   AND T11.VAC_IS_CST_NO = T1.CST_NO /*발급고객번호*/
		                  LEFT OUTER JOIN TB_CBBO_BND_LWM_IZ T12 /* 채권법조치내역 */
		                    ON T1.CST_NO = T12.CST_NO
		                  LEFT OUTER JOIN LATERAL
		                                (
		                                  SELECT CST_NO
		                                       , BND_VST_RS_CD
		                                       , VST_DT
		                                    FROM TB_CBBO_BND_CNSL_VST_IZ T13 /* 채권상담방문내역 */
		                                   WHERE 1=1
		                                     AND DTA_DL_YN = 'N'
		                                     AND T1.CST_NO = T13.CST_NO
		                                     AND ROWNUM <![CDATA[<=]]> 1
		                                ) T13
		                    ON 1=1
		                  LEFT OUTER JOIN
		                                (
		                                  SELECT CR.CNTR_ADRPC_ID
		                                         , CR.DTL_CNTR_NO
		                                         , CR.DTL_CNTR_SN
		                                         , CB.LOCARA_TNO
		                                         , CB.EXNO_ENCR
		                                         , CB.IDV_TNO
		                                         , CB.CRAL_LOCARA_TNO
		                                         , CB.MEXNO_ENCR
		                                         , CB.CRAL_IDV_TNO
		                                         , NVL(AB.NEW_ADR_ZIP, AB.OLD_ADR_ZIP) AS SPP_ZIP
		                                         , NVL(AB.RNADR, AB.LTN_ADR) AS SPP_ADR
		                                         , NVL(AB.RDADR, AB.LTN_DTL_ADR) AS SPP_DTL_ADR
		                                      FROM TB_SSCT_CNTR_ADR_REL CR /* 계약주소관계 */
		                                      LEFT OUTER JOIN TB_SSCT_CNTR_ADRPC_BAS CB /* 계약주소지기본 */
		                                        ON CB.CNTR_ADRPC_ID = CR.CNTR_ADRPC_ID
		                                      LEFT OUTER JOIN TB_GBCO_ADR_BAS AB /* 주소기본 */
		                                        ON AB.ADR_ID = CB.ADR_ID
		                                     WHERE CR.CNTR_UNIT_TP_CD = '020'
		                                       AND CR.ADRPC_TP_CD = '3'  /* 설치주소 */
		                                       AND CR.DTA_DL_YN = 'N'
		                                ) T14
		                    ON T1.CNTR_NO = T14.DTL_CNTR_NO
		                   AND T1.CNTR_SN = T14.DTL_CNTR_SN
		                  INNER JOIN TB_SSCT_CNTR_BAS T15 /* 계약기본 */
		                     ON T1.CNTR_NO = T15.CNTR_NO
		                  LEFT OUTER JOIN TB_RVCL_BIL_PLAN_BAS T16 /* 청구계획기본 */
		                     ON T1.CNTR_NO = T16.CNTR_NO
		                    AND T1.BASE_YM = T16.BIL_YM
		                  LEFT OUTER JOIN TB_CBCL_WELLS_SL_MM_CL_IZ T17 /* WELLS매출월마감내역 */
		                     ON T17.SL_CL_YM = TO_CHAR(ADD_MONTHS(TO_DATE(T1.BASE_YM, 'YYYYMM'), -1), 'YYYYMM')
		                    AND T17.CNTR_NO = T1.CNTR_NO
		                    AND T17.CNTR_SN = T1.CNTR_SN
		                   LEFT OUTER JOIN TB_CBCL_WELLS_BOR_AMT_BAS T18 /* WELLS위약금액기본 */
		                     ON T18.PERF_YM = TO_CHAR(ADD_MONTHS(TO_DATE(T1.BASE_YM, 'YYYYMM'), -1), 'YYYYMM')
		                    AND T18.CNTR_NO = T1.CNTR_NO
		                    AND T18.CNTR_SN = T1.CNTR_SN
		             )  V1
		         WHERE 1=1
		           AND CLCTAM_PRTNR_NO = #{schClctamNo}
		         GROUP BY CST_NO, CNTR_NO, CNTR_SN
		     ) 
		 WHERE 1=1
         <if test='@MybatisUtils@isNotEmpty(schCstNo)'>
           AND CST_NO = #{schCstNo}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schDlqMcntStrt) and @MybatisUtils@isNotEmpty(schDlqMcntEnd)'>
           AND DLQ_MCNT BETWEEN #{schDlqMcntStrt} AND #{schDlqMcntEnd}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schIstLocaraTno) and @MybatisUtils@isNotEmpty(schIstExnoEncr) and @MybatisUtils@isNotEmpty(schIstIdvTno)'>
           AND IST_LOCARA_TNO = #{schIstLocaraTno} 
           AND IST_EXNO_ENCR = #{schIstExnoEncr} 
           AND IST_IDV_TNO = #{schIstIdvTno}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schCntrNo)'>
           AND CNTR_NO = #{schCntrNo}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schBizDv)'>
           AND BND_BIZ_DV_CD = #{schBizDv}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schIstCralLocaraTno) and @MybatisUtils@isNotEmpty(schIstMexnoEncr) and @MybatisUtils@isNotEmpty(schIstCralIdvTno)'>
           AND IST_CRAL_LOCARA_TNO = #{schIstCralLocaraTno} 
           AND IST_MEXNO_ENCR = #{schIstMexnoEncr} 
           AND IST_CRAL_IDV_TNO = #{schIstCralIdvTno}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schCntrLocaraTno) and @MybatisUtils@isNotEmpty(schCntrExnoEncr) and @MybatisUtils@isNotEmpty(schCntrIdvTno)'>
           AND CNTR_LOCARA_TNO = #{schCntrLocaraTno} 
           AND CNTR_EXNO_ENCR = #{schCntrExnoEncr} 
           AND CNTR_IDV_TNO = #{schCntrIdvTno}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schSfK)'>
           AND SFK = #{schSfK}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schCstDv)'>
           AND CNTR_TP_CD = #{schCstDv}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schOjBlamStrt) and @MybatisUtils@isNotEmpty(schOjBlamEnd)'>
           AND OJ_BLAM BETWEEN #{schOjBlamStrt} AND #{schOjBlamEnd}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schCntrCralLocaraTno) and @MybatisUtils@isNotEmpty(schCntrMexnoEncr) and @MybatisUtils@isNotEmpty(schCntrCralIdvTno)'>
           AND CNTR_CRAL_LOCARA_TNO = #{schCntrCralLocaraTno} 
           AND CNTR_MEXNO_ENCR = #{schCntrMexnoEncr} 
           AND CNTR_CRAL_IDV_TNO = #{schCntrCralIdvTno}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schTfDtStrt) and @MybatisUtils@isNotEmpty(schTfDtEnd)'>
           AND TF_DT BETWEEN #{schTfDtStrt} AND #{schTfDtEnd}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schFntDtStrt) and @MybatisUtils@isNotEmpty(schFntDtEnd)'>
           <if test='@MybatisUtils@equals(schFntDv, "01")'>
             AND BIL_TP_CD = '140'
           </if>
           <if test='@MybatisUtils@equals(schFntDv, "02")'>
             AND BIL_TP_CD = '160'
           </if>
           AND BIL_DT BETWEEN #{schFntDtStrt} AND #{schFntDtEnd}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schBilDv)'>
           AND BIL_TP_CD = #{schBilDv}
         </if>
         <if test='@MybatisUtils@isNotEmpty(schCstThmDp)'>
           <if test="schCstThmDp == '02'">
             AND MM_CHRAM_DP <![CDATA[<>]]> 0
           </if>
         </if>
         <if test='@MybatisUtils@isNotEmpty(schCstDv)'>
           <if test="schDv == '01'">
             AND (DLQ_AMT - DLQ_DP) <![CDATA[<>]]> 0 /*연체잔액0원제외*/
           </if>
           <if test="schDv == '02'">
             AND (DLQ_DP + DLQ_ADD_DP + RSG_BOR_DP_AMT + MM_CHRAM_DP) <![CDATA[<>]]> 0 /*입금액0원제외*/
           </if>
           <if test="schDv == '03'">
             AND ((DLQ_AMT + DLQ_ADD_AMT + MM_CHRAM_AMT) - (DLQ_DP + DLQ_ADD_DP + MM_CHRAM_DP)) <![CDATA[<>]]> 0 /*대상잔액0원제외*/
           </if>
           <if test="schDv == '04'">
             AND DLQ_MCNT <![CDATA[<>]]> 0 /*연체개월0개월제외*/
           </if>
         </if>
    </select>
</mapper>
