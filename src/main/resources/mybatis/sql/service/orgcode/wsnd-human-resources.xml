<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.service.orgcode.mapper.WsndHumanResourcesMapper">
    <select id="selectHumanResources" resultType="com.kyowon.sms.wells.web.service.orgcode.dto.WsndHumanResourcesDto$SearchRes">
        <if test='@MybatisUtils@isNotEmpty(mngrDvCd) and @MybatisUtils@equals(mngrDvCd, "1")'>
            SELECT T1.PRTNR_NO AS EMP_ID
                 , T1.PRTNR_KNM AS EMP_NM
                 , T1.PSTN_DV_CD
                 , NULL AS ROL_DV_CD
                 , T1.ENTCO_DT
                 , T1.RSGN_DT
                 , T2.HGR_OG_ID AS CNR_CD
                 , T2.DGR1_HGR_OG_NM AS CNR_NM
                 , T1.OG_ID AS BRCH_CD
                 , T1.OG_NM AS BRCH_NM
              FROM TB_OGBS_MM_PRTNR_CL T1
             INNER JOIN TB_OGBS_MM_OG_CL T2
                ON T1.OG_ID = T2.OG_ID
               AND T1.BASE_YM = T2.BASE_YM
               AND T1.BASE_YM = TO_CHAR(SYSDATE,'YYYYMM')
               AND T1.PRTNR_CLSF_CD = '1'
               AND T2.OG_CLSF_CD = '매니저'
               AND T2.OG_TP_CD = '매니저'
               AND (SUBSTR(T1.RSGN_DT, 1, 6) = TO_CHAR(SYSDATE, 'YYYYMM')
                    OR (T1.RSGN_DT IS NULL AND T1.ACTI_YN = 'Y'))
               AND T1.DTA_DL_YN <![CDATA[<>]]> 'Y'
             WHERE 1=1
            <if test='@MybatisUtils@isNotEmpty(deptCd)'>
               AND T2.DGR2_HGR_OG_CD = #{deptCd}
            </if>
            <if test='@MybatisUtils@isNotEmpty(cnrCd)'>
               AND T2.DGR1_HGR_OG_CD = #{cnrCd}
            </if>
            <if test='@MybatisUtils@isNotEmpty(searchText)'>
               AND (T1.PRTNR_KNM LIKE #{searchText} || '%' OR PRTNR_NO = #{searchText})
            </if>
             ORDER BY T1.OG_ID
        </if>
        <if test='@MybatisUtils@isNotEmpty(mngrDvCd) and @MybatisUtils@equals(mngrDvCd, "2")'>
            SELECT T1.SAP_EMPNO AS EMP_ID
                 , T1.FNM AS EMP_NM
                 , NULL AS PSTN_DV_CD
                 , T1.EMP_ROL_DV_VAL AS ROL_DV_CD
                 , T1.ENTCO_DT
                 , T1.RSGN_DT
                 , T1.DEPT_CD AS CNR_CD
                 , T2.DEPT_NM1 AS CNR_NM
                 , NULL AS BRCH_CD
                 , NULL AS BRCH_NM
              FROM TB_OGBS_EMP_BAS T1
             INNER JOIN TB_OGBS_DEPT_BAS T2
                ON T1.DEPT_CD = T2.DEPT_CD
        	   AND T2.DEPT_TP_VAL = '엔지니어'
        	   AND T2.DEPT_FOM_VAL = '엔지니어'
        	   AND T1.RSGN_DT IS NULL
               AND T1.DTA_DL_YN <![CDATA[<>]]> 'Y'
             WHERE 1=1
            <if test='@MybatisUtils@isNotEmpty(cnrCd)'>
               AND T1.DEPT_CD = #{cnrCd}
            </if>
            <if test='@MybatisUtils@isNotEmpty(searchText)'>
               AND (T1.FNM LIKE #{searchText} || '%' OR SAP_EMPNO = #{searchText})
            </if>
             ORDER BY T1.DEPT_CD
        </if>
    </select>

    <select id="selectManagerDepartmentCodes" resultType="com.kyowon.sms.wells.web.service.orgcode.dto.WsndHumanResourcesDto$SearchDepartmentRes">
        SELECT 'TEST1' AS DEPT_CD
             , '테스트1 부서' AS DEPT_NM
        FROM DUAL
        UNION ALL
        SELECT 'TEST2' AS DEPT_CD
             , '테스트2 부서' AS DEPT_NM
        FROM DUAL
        UNION ALL
        SELECT 'TEST3' AS DEPT_CD
             , '테스트3 부서' AS DEPT_NM
        FROM DUAL
        UNION ALL
        SELECT 'TEST4' AS DEPT_CD
             , '테스트4 부서' AS DEPT_NM
        FROM DUAL
    </select>

    <select id="selectManagerCenterCodes" resultType="com.kyowon.sms.wells.web.service.orgcode.dto.WsndHumanResourcesDto$SearchCenterRes">
        SELECT *
        FROM (
                 SELECT 'TEST11' AS CNR_CD
                      , '테스트11 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST12' AS CNR_CD
                      , '테스트12 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST13' AS CNR_CD
                      , '테스트13 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST14' AS CNR_CD
                      , '테스트14 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST21' AS CNR_CD
                      , '테스트21 센터' AS CNR_NM
                      , 'TEST2' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST22' AS CNR_CD
                      , '테스트22 센터' AS CNR_NM
                      , 'TEST2' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST31' AS CNR_CD
                      , '테스트31 센터' AS CNR_NM
                      , 'TEST3' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST41' AS CNR_CD
                      , '테스트41 센터' AS CNR_NM
                      , 'TEST4' AS DEPT_CD
                 FROM DUAL
             )
        WHERE 1=1
        <if test='@MybatisUtils@isNotEmpty(deptCd) and !@MybatisUtils@equals(deptCd, "ALL")'>
        AND DEPT_CD = #{deptCd}
        </if>
    </select>

    <select id="selectEngineerCenterCodes" resultType="com.kyowon.sms.wells.web.service.orgcode.dto.WsndHumanResourcesDto$SearchCenterRes">
        SELECT *
        FROM (
                 SELECT 'TEST11' AS CNR_CD
                      , '테스트11 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST12' AS CNR_CD
                      , '테스트12 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST13' AS CNR_CD
                      , '테스트13 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST14' AS CNR_CD
                      , '테스트14 센터' AS CNR_NM
                      , 'TEST1' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST21' AS CNR_CD
                      , '테스트21 센터' AS CNR_NM
                      , 'TEST2' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST22' AS CNR_CD
                      , '테스트22 센터' AS CNR_NM
                      , 'TEST2' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST31' AS CNR_CD
                      , '테스트31 센터' AS CNR_NM
                      , 'TEST3' AS DEPT_CD
                 FROM DUAL
                 UNION ALL
                 SELECT 'TEST41' AS CNR_CD
                      , '테스트41 센터' AS CNR_NM
                      , 'TEST4' AS DEPT_CD
                 FROM DUAL
             )
    </select>

</mapper>