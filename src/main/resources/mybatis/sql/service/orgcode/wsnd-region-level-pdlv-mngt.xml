<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.service.orgcode.mapper.WsndRegionLevelPdlvMngtMapper">

    <select id="selectPlaceOfDeliveryPages" resultType="com.kyowon.sms.wells.web.service.orgcode.dto.WsndRegionLevelPdlvMngtDto$SearchRes">
        SELECT A.PDLV_DV_CD /* 출고지구분코드  */
             , A.PDLV_NO  /* 출고지번호 */
             , A.PDLV_NM  /* 출고지명 */
             , A.ZIP  /* 우편번호 */
             , A.PDLV_ADR  /* 출고지주소 */
             , A.PDLV_DTL_ADR  /* 출고지상세주소 */
             , A.APY_STRTDT AS APY_STRTDT_ORIGIN /* 적용시작일-초기조회값 */
             , A.APY_STRTDT  /* 적용시작일 */
             , A.APY_ENDDT  /* 적용종료일 */
             , A.CNR_OG_ID  /* 서비스센터ID */
             , A.DATA_DL_YN  /* 데이터삭제여부 */
          FROM
             (
               SELECT 'E' AS PDLV_DV_CD, '111' AS PDLV_NO, '아산' AS PDLV_NM, '31413' AS ZIP, '충남 아산시 음봉면 연암율금로 220-5' AS PDLV_ADR,'' AS PDLV_DTL_ADR, '20221117' AS APY_STRTDT, '99991231' AS APY_ENDDT, 'OGC00005' AS CNR_OG_ID, 'N' AS DATA_DL_YN FROM DUAL UNION ALL
               SELECT 'E', '120', '부산강서', '46721', '부산 강서구 유통단지1로97번길 4','강서빌딩', '20220710', '99991231', 'OGC00005', 'N' FROM DUAL UNION ALL
               SELECT 'E', '121', '부천', '14441', '경기 부천시 산업로 18','부천창고', '20220701', '99991231', 'OGC00005', 'N' FROM DUAL UNION ALL
               SELECT 'Z', '123', '광명 미사용', '14340', '경기 광명시 가학로 217-4','광명창고', '20220701', '99991231', 'OGC00003', 'N' FROM DUAL UNION ALL
               SELECT 'Z', '520', '안양 미사용', '18390', '경기 화성시 정조로 154','안양지점', '20220511', '99991231', 'OGC00003', 'N' FROM DUAL UNION ALL
               SELECT 'Z', '158', '김포 미사용', '10131', '경기 김포시 고촌읍 태리로 190번길','42-10', '20220421', '99991231', 'OGC00003', 'N' FROM DUAL UNION ALL
               SELECT 'E', '954', '인천계양', '15023', '인천광역시 계양구 서운산단로 2길', '62', '20220117', '99991231', 'OGC00003', 'N' FROM DUAL UNION ALL
               SELECT 'E', '870', '충주', '46521', '충청북도 충주시 대소원면 대소원1길','19', '20220201', '99991231', 'OGC00002', 'N' FROM DUAL UNION ALL
               SELECT 'E', '995', '전주', '44410', '전라북도 전주시 덕진구 삼례로','116', '20220701', '99991231', 'OGC00002', 'N' FROM DUAL UNION ALL
               SELECT 'E', '620', '대구', '66520', '대구광역시 동구 신평로','104', '20221010', '99991231', 'OGC00002', 'N' FROM DUAL UNION ALL
               SELECT 'E', '654', '진주', '33711', '경상남도 진주시 판문로 223','진주지점', '20220201', '99991231', 'OGC00002', 'N' FROM DUAL UNION ALL
               SELECT 'E', '774', '장성', '42158', '전라남도 장성군 남면 나노산단2로 106','장성지점', '20220716', '99991231', 'OGC00005', 'N' FROM DUAL UNION ALL
               SELECT 'E', '662', '제주', '61230', '제주특별자치도 제주시 애월읍 엄장로 225','애월지점', '20220501', '99991231', 'OGC00005', 'N' FROM DUAL UNION ALL
               SELECT 'E', '174', '원주', '74112', '강원도 원주시 호저면 호저로','394-1', '20220607', '99991231', 'OGC00005', 'N' FROM DUAL UNION ALL
               SELECT 'E', '941', '강릉', '74235', '강원도 강릉시 성덕포남로 152번길','25-1', '20220201', '99991231', 'OGC00005', 'N' FROM DUAL
               ) A
         WHERE 1 = 1
           AND A.DATA_DL_YN = 'N'
        <if test="@MybatisUtils@isNotEmpty(pdlvNm)">
           AND A.PDLV_NM LIKE '%'||#{pdlvNm}||'%'
        </if>
    </select>

    <update id="deletePlaceOfDelivery" >
        SELECT 1 FROM DUAL
<!--        UPDATE TB_SVPD_PDLV_BAS-->
<!--           SET DATA_DL_YN = 'Y'-->
<!--              <include refid="COMMON.updateSystemField"/>-->
<!--         WHERE PDLV_DV_CD = #{pdlvDvCd}-->
<!--           AND PDLV_NO    = #{pdlvNo}-->
    </update>

    <insert id="insertPlaceOfDelivery">
        SELECT 1 FROM DUAL
<!--        INSERT INTO TB_SVPD_PDLV_BAS-->
<!--             ( PDLV_NO-->
<!--             , PDLV_DV_CD -->
<!--             , PDLV_NM -->
<!--             , ZIP-->
<!--             , PDLV_ADR -->
<!--             , PDLV_DTL_ADR -->
<!--             , CNG_OG_ID-->
<!--             , LATD_GPS_VAL-->
<!--             , LO_GPS_VAL-->
<!--             , DATA_DL_YN-->
<!--              <include refid="COMMON.insertSystemField"/>-->
<!--             ) -->
<!--            VALUES -->
<!--             ( #{pdlvNo}-->
<!--             , #{pdlvDvNo}-->
<!--             , #{pdlvNm}-->
<!--             , #{zip}-->
<!--             , #{pdlvAdr}-->
<!--             , #{pdlvDtlAdr}-->
<!--             , #{cnrOgId}-->
<!--             , ''-->
<!--             , ''-->
<!--             , 'N'-->
<!--              <include refid="COMMON.insertSystemFieldValue"/>-->
<!--             )-->
    </insert>

    <insert id="insertPlaceOfDeliveryHistory">
        SELECT 1 FROM DUAL
<!--        INSERT INTO TB_SVPD_PDLV_HIST-->
<!--             ( PDLV_NO-->
<!--             , APY_STRTDT-->
<!--             , APY_ENDDT-->
<!--             , PDLV_DV_CD-->
<!--             , PDLV_NM-->
<!--             , ZIP-->
<!--             , PDLV_ADR-->
<!--             , PDLV_DTL_ADR-->
<!--             , CNG_OG_ID-->
<!--             , LATD_GPS_VAL-->
<!--             , LO_GPS_VAL-->
<!--             , DATA_DL_YN-->
<!--              <include refid="COMMON.insertSystemField"/>-->
<!--             )-->
<!--        VALUES-->
<!--             ( #{pdlvNo}-->
<!--             , #{apyStrtdt}-->
<!--             , '99991231'-->
<!--             , #{pdlvDvNo}-->
<!--             , #{pdlvNm}-->
<!--             , #{zip}-->
<!--             , #{pdlvAdr}-->
<!--             , #{pdlvDtlAdr}-->
<!--             , #{cnrOgId}-->
<!--             , ''-->
<!--             , ''-->
<!--             , 'N'-->
<!--              <include refid="COMMON.insertSystemFieldValue"/>-->
<!--             )-->
    </insert>

    <select id="selectPlaceOfDeliveryByPdlvNo" resultType="com.kyowon.sms.wells.web.service.orgcode.dto.WsndRegionLevelPdlvMngtDto$FindRes">
        SELECT PDLV_NO
             , APY_STRTDT
             , DATA_DL_YN
        FROM TB_SVPD_PDLV_BAS
        WHERE PDLV_NO = #{pdlvNo}
    </select>

    <update id="updatePlaceOfDelivery">
        SELECT 1 FROM DUAL
<!--        UPDATE TB_SVPD_PDLV_BAS-->
<!--           SET APY_STRTDT = #{apyStrtdt}-->
<!--                 , DATA_DL_YN = 'N'-->
<!--              <include refid="COMMON.updateSystemField"/>-->
<!--         WHERE PDLV_NO    = #{pdlvNo}-->
<!--           AND PDLV_DV_CD = #{pdlvDvCd}-->
<!--           AND APY_STRTDT = #{apyStrtdtOrigin}-->
    </update>

    <update id="updatePlaceOfDeliveryHistory">
        SELECT 1 FROM DUAL
<!--        UPDATE TB_SVPD_PDLV_HIST-->
<!--           SET APY_ENDTDT = (#{apyStrtdt} - 1)-->
<!--              <include refid="COMMON.updateSystemField"/>-->
<!--         WHERE PDLV_NO    = #{pdlvNo}-->
<!--           AND PDLV_DV_CD = #{pdlvDvCd}-->
<!--           AND APY_STRTDT = #{apyStrtdtOrigin}-->
    </update>

</mapper>
