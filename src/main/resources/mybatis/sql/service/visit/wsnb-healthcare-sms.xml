<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.service.visit.mapper.WsnbHealthCareSmsMapper">

    <select id="selectHealthCareSms" resultType="com.kyowon.sms.wells.web.service.visit.dvo.WsnbHealthCareSmsDvo">
    <!--SELECT AC201_CSMR_YR
         , AC201_CSMR_CD
         , AC201_CSMR_SEQ
         , VS172_AGR_SVC_YN
         , VS172_PINF_PRV_YN
         , VS172_AGR_PR_NM
         , AC201_CUST_NM
         , AC221_DATA_GB AS DATA_GB
         , AC221_ORD_DT AS ORD_DT
         , AC221_ORD_SEQ AS ORD_SEQ
         , TRIM(AC201_TEL_CO)||TRIM(CIPDEC('df',AC201_HP_NO1))||TRIM(AC201_HP_NO2) AS HPNO
         , TRIM(TO_SINGLE_BYTE(LCCNAM)) AS LCCNAM
      FROM LC_ALLOCATE_AC211TB
         , LC_ALLOCATE_AC221TB
         , LC_ALLOCATE_AC201TB
         , LC_VISIT_VS172TB
         , KWMART.LC3100P
     WHERE AC211_WRK_TYP_DTL LIKE '11%'
       AND AC201_GDS_CD IN ('49431000000','49432000000','49433000000','49434000000' ,'49435000000','49436000000','49443000000','49444000000','49445000000')
       AND AC221_PROC_STUS = '20'
       AND AC221_DATA_GB = AC211_DATA_GB
       AND AC221_ORD_DT = AC211_ORD_DT
       AND AC221_ORD_SEQ = AC211_ORD_SEQ
       AND AC221_CSMR_YR = AC201_CSMR_YR
       AND AC221_CSMR_CD = AC201_CSMR_CD
       AND AC221_CSMR_SEQ = AC201_CSMR_SEQ
       AND AC201_CSMR_YR = LCYEAR(+)
       AND TO_NUMBER(AC201_CSMR_CD)  = LCCODE(+)
    &#45;&#45;   AND AC201_INST_DT = TO_CHAR(SYSDATE -1 , 'YYYYMMDD')
       AND VS172_CSMR_YR(+) = AC201_CSMR_YR
       AND VS172_CSMR_CD(+) = AC201_CSMR_CD
       AND VS172_SEND_DT(+) IS NULL
       UNION all
    SELECT AC201_CSMR_YR
         , AC201_CSMR_CD
         , AC201_CSMR_SEQ
         , VS172_AGR_SVC_YN
         , VS172_PINF_PRV_YN
         , VS172_AGR_PR_NM
         , AC201_CUST_NM
         , AC221_DATA_GB
         , AC221_ORD_DT
         , AC221_ORD_SEQ
         , TRIM(AC201_TEL_CO)||TRIM(CIPDEC('df',AC201_HP_NO1))||TRIM(AC201_HP_NO2) AS HPNO
         , TRIM(TO_SINGLE_BYTE(LCCNAM)) AS LCCNAM
      FROM LC_ALLOCATE_AC211TB
         , LC_ALLOCATE_AC221TB
         , LC_ALLOCATE_AC201TB
         , LC_VISIT_VS172TB
         , KWMART.CW3100P
         , LC_STOCK_ST101TB
         , KWMART.LC3100P
     WHERE AC211_WRK_TYP_DTL LIKE '11%'
       AND AC211_GDS_CD = ST101_ITEM_CD || ST101_PART_CD
       AND ST101_ITEM_GR IN ('93','92')
       AND AC221_PROC_STUS = '20'
       AND AC221_DATA_GB = AC211_DATA_GB
       AND AC221_ORD_DT = AC211_ORD_DT
       AND AC221_ORD_SEQ = AC211_ORD_SEQ
       AND AC221_CSMR_YR = AC201_CSMR_YR
       AND AC221_CSMR_CD = AC201_CSMR_CD
       AND AC221_CSMR_SEQ = AC201_CSMR_SEQ
       AND AC201_CSMR_YR = LCYEAR(+)
       AND TO_NUMBER(AC201_CSMR_CD)  = LCCODE(+)
       &#45;&#45;AND AC201_INST_DT = TO_CHAR(SYSDATE -1 , 'YYYYMMDD')
       AND CWYEAR = AC201_CSMR_YR
       AND CWCODE = AC201_CSMR_CD
       AND '7989' IN (cwgc01,cwgc02,cwgc03,cwgc04,cwgc05 )
       AND VS172_CSMR_YR(+) = AC201_CSMR_YR
       AND VS172_CSMR_CD(+) = AC201_CSMR_CD
       AND VS172_SEND_DT(+) IS NULL-->
              SELECT '20210181436' AS CNTR_NO, '00' AS CNTR_SN, '' AS SPMT_CST_SV_U_AG_YN, '' AS PIF_THP_OFR_AG_YN, '' AS AGP_NM, '이상미' AS CST_NM, '1' AS SV_BIZ_DCLSF_CD, '20210101' AS ASN_DT, '053300' AS CST_SV_ASN_NO, '01027880043' AS CPHON_IDV_TNO, '이상미' AS CST_FNM  FROM DUAL
    UNION ALL SELECT '20210060014' AS CNTR_NO, '00' AS CNTR_SN, '' AS SPMT_CST_SV_U_AG_YN, '' AS PIF_THP_OFR_AG_YN, '' AS AGP_NM, '손화정' AS CST_NM, '1' AS SV_BIZ_DCLSF_CD, '20210101' AS ASN_DT, '053551' AS CST_SV_ASN_NO, '01027883003' AS CPHON_IDV_TNO, '손화정' AS CST_FNM  FROM DUAL
    UNION ALL SELECT '20210609329' AS CNTR_NO, '00' AS CNTR_SN, '' AS SPMT_CST_SV_U_AG_YN, '' AS PIF_THP_OFR_AG_YN, '' AS AGP_NM, '김영길' AS CST_NM, '1' AS SV_BIZ_DCLSF_CD, '20210101' AS ASN_DT, '054073' AS CST_SV_ASN_NO, '01027883331' AS CPHON_IDV_TNO, '김영길' AS CST_FNM  FROM DUAL
    UNION ALL SELECT '20220099275' AS CNTR_NO, '00' AS CNTR_SN, '' AS SPMT_CST_SV_U_AG_YN, '' AS PIF_THP_OFR_AG_YN, '' AS AGP_NM, '지광숙' AS CST_NM, '1' AS SV_BIZ_DCLSF_CD, '20220103' AS ASN_DT, '122140' AS CST_SV_ASN_NO, '01027881976' AS CPHON_IDV_TNO, '황승호' AS CST_FNM  FROM DUAL
    UNION ALL SELECT '20220109477' AS CNTR_NO, '00' AS CNTR_SN, '' AS SPMT_CST_SV_U_AG_YN, '' AS PIF_THP_OFR_AG_YN, '' AS AGP_NM, '신상균' AS CST_NM, '1' AS SV_BIZ_DCLSF_CD, '20220103' AS ASN_DT, '123898' AS CST_SV_ASN_NO, '01027881481' AS CPHON_IDV_TNO, '신세진' AS CST_FNM  FROM DUAL
    UNION ALL SELECT '20220050423' AS CNTR_NO, '00' AS CNTR_SN, '' AS SPMT_CST_SV_U_AG_YN, '' AS PIF_THP_OFR_AG_YN, '' AS AGP_NM, '최지원' AS CST_NM, '1' AS SV_BIZ_DCLSF_CD, '20220103' AS ASN_DT, '120378' AS CST_SV_ASN_NO, '01027888207' AS CPHON_IDV_TNO, '최지원' AS CST_FNM  FROM DUAL
    </select>

</mapper>
