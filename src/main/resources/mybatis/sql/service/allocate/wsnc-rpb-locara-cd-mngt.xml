<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.service.allocate.mapper.WsncRpbLocaraCdMngtMapper">

    <select id="selectLocalAreaCodePages" resultType="com.kyowon.sms.wells.web.service.allocate.dto.WsncRpbLocaraCdMngtDto$SearchRes">
        SELECT A.FR2P_LGLD_CD /* 앞2자리법정동코드 */
             , A.NEW_ADR_ZIP /* 신주소우편번호  */
             , A.MGT_CNT  /* 지역별 서비스 계정 수 */
             , A.WRK_CNT  /* 월별 수임 건수 (조회월 이전 3개월 평균) */
             , A.CTPV_NM  /* 시도명 */
             , A.CTCTY_NM  /* 시군구명 */
             , A.LAWC_EMD_NM  /* 법정읍면동명 */
             , A.AMTD_NM  /* 행정동명 */
             , A.RPB_LOCARA_CD  /* 책임지역코드 */
             , A.RPB_LOCARA_GRP_CD  /* 책임지역그룹코드 */
             , A.OG_NM  /* 조직명 */
             , A.ICHR_PRTNR_NO  /* 담당파트너번호 */
             , A.PRTNR_KNM  /* 파트너한글명 */
             , A.VST_DOW_VAL /* 방문요일 */
             , A.APY_STRT_DT  /* 적용시작일자 */
             , A.APY_END_DT  /* 적용종료일자 */
             , A.FNL_MDFC_DTM /* 최종수정일시 */
          FROM
             (
               SELECT '01234, 01235, 01236, 01237, 01238, 01239, 01240' AS NEW_ADR_ZIP, '11' AS MGT_CNT, '11' AS WRK_CNT, '11' AS FR2P_LGLD_CD,'서울특별시' AS CTPV_NM, '도봉구' AS CTCTY_NM, '쌍문동' AS LAWC_EMD_NM, '쌍문동' AS AMTD_NM, '11320' AS RPB_LOCARA_CD, '10500' AS RPB_LOCARA_GRP_CD, '75041' AS OG_ID, '북부서비스센터' AS OG_NM, 'A12345678' AS ICHR_PRTNR_NO, '오동동' AS PRTNR_KNM, '월화' AS VST_DOW_VAL, '20220101' AS APY_STRT_DT, '20221010' AS APY_END_DT, 'N' AS DTA_DL_YN, '20221105121000' AS FNL_MDFC_DTM, '11' AS WRK_GRP_CD FROM DUAL UNION ALL
               SELECT '02233, 02234, 02235, 02236, 02237, 02238, 02239, 02240', '22', '22', '11','서울특별시', '강북구', '수유동', '수유동', '11305', '10300', '75043', '남부서비스센터', 'A22345678', '고길동', '월수금', '20220101', '20220506', 'N', '20221015172327', '20' FROM DUAL UNION ALL
               SELECT '01531, 01532, 01533, 01534, 01535, 01536, 01537, 01538, 01539, 01540', '33', '35', '11','서울특별시', '도봉구', '쌍문동', '쌍문동', '11320', '10500', '75041', '북부서비스센터', 'A32345678', '김길동', '화목토', '20220504', '20220810', 'N', '20221211130536', '20' FROM DUAL UNION ALL
               SELECT '02122, 02123, 02124, 02125, 02126, 02127, 02128, 02129 02130', '17', '8', '41', '경기도', '장안구', '파장동', '파장동', '41111', '12900', '71356', '수원지점', 'A92345678', '김갑순', '토일', '20210423', '20230815', 'N', '20221211130536', '11' FROM DUAL UNION ALL
               SELECT '02135, 02136, 02137, 02138, 02139, 02140', '11', '7', '41', '경기도', '장안구', '율전동', '율전동', '41111', '13200', '71356', '수원지점', 'A88345670', '이길순', '금토일', '20210606', '20240312', 'N', '20221215093542', '30' FROM DUAL UNION ALL
               SELECT '01673, 01674, 01675, 01676, 01677, 01678, 01679, 01680', '15', '3.5', '43', '충청북도', '상당구', '평천동', '평촌동', '43111', '12700', '71360', '청주지점', 'D12345678', '홍길동', '월', '20220315', '20260717', 'N', '20221215093542', '60' FROM DUAL UNION ALL
               SELECT '08112, 08113, 08114, 08115, 08116, 08117, 08118, 08119, 08120', '13', '3.5', '43', '충청북도', '상당구', '평천동', '평촌동', '43111', '12700', '71360', '청주지점', 'D33345675', '나길동', '금토', '20220605', '20241129', 'N', '20221215093542', '30' FROM DUAL UNION ALL
               SELECT '01712, 01713, 01714, 01715, 01716, 01717, 01718, 01719, 01720', '8', '5.2', '44', '충청남도', '예산군', '삽교읍', '삽교읍', '44810', '25323', '75045', '충청서비스센터', 'E13345675', '최길동', '월금', '20210419', '20281028', 'N', '20221215093542', '60' FROM DUAL UNION ALL
               SELECT '01856,01857, 01858, 01859, 01860', '9', '3', '44', '충청남도', '아산시', '송악면', '송악면', '44200', '31022', '75045', '충청서비스센터', 'E74345675', '김첨지', '월화수목금', '20210324', '20270918', 'N', '20221215093542', '60' FROM DUAL UNION ALL
               SELECT '03133, 03134, 03135, 03136, 03137, 03138, 03139, 03140', '15', '8', '26', '부산광역시', '수영구', '광안2동', '광안2동', '26500', '10400', '71357', '부산지점', 'B42345678', '김교원', '일', '20201010', '20200315', 'N', '20221215093542', '72' FROM DUAL UNION ALL
               SELECT '03271, 03272, 03273, 03274, 03275, 03276, 03277, 03278, 03279, 03280', '19', '17', '26', '부산광역시', '수영구', '광안1동', '광안1동', '26500', '10400', '71357', '부산지점', 'C42345678', '나교원', '토일', '20101225', '20241125', 'N', '20221215093542', '72'FROM DUAL UNION ALL
               SELECT '04124, 04125, 04126, 04127, 04128, 04129, 04130', '13', '6.5', '47', '경상북도', '경주시', '노동동', '노동동', '47130', '10600', '75047', '경북서비스센터', 'F32345633', '노동원', '일월', '20110218', '20281012', 'N', '20221215093542', '72' FROM DUAL UNION ALL
               SELECT '04234, 04235, 04236, 04237, 04238, 04239, 04240', '7', '3', '47', '경상북도', '경주시', '교동', '교동', '47130', '11000', '75047', '경북서비스센터', 'F55340011', '김동원', '화목토', '20210714', '20290101', 'N', '20221215093542', '72' FROM DUAL
             ) A
         WHERE 1 = 1
           AND A.DTA_DL_YN = 'N'
        <!--
        <if test="@MybatisUtils@isNotEmpty(zipFrom)">
           AND A.NEW_ADR_ZIP &gt;= #{zipFrom}
        </if>
        <if test="@MybatisUtils@isNotEmpty(zipTo)">
           AND A.NEW_ADR_ZIP &lt; #{zipTo}
        </if>
        -->
        <if test="@MybatisUtils@isNotEmpty(fr2pLgldCd)">
           AND A.FR2P_LGLD_CD = #{fr2pLgldCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(ctctyNm)">
           AND A.CTCTY_NM = #{ctctyNm}
        </if>
        <if test="@MybatisUtils@isNotEmpty(ogId)">
           AND A.OG_ID = #{ogId}
        </if>
        <if test="@MybatisUtils@isNotEmpty(wrkGrpCd)">
           AND A.WRK_GRP_CD = #{wrkGrpCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(applyDate)">
           AND #{applyDate} BETWEEN A.APY_STRT_DT AND A.APY_END_DT
        </if>
        <if test="@MybatisUtils@isNotEmpty(locaraCdFrom)">
           AND #{locaraCdFrom} <![CDATA[<=]]> SUBSTR(RPB_LOCARA_CD, 1, 3)
        </if>
        <if test="@MybatisUtils@isNotEmpty(locaraCdTo)">
           AND #{locaraCdTo} <![CDATA[>=]]> SUBSTR(RPB_LOCARA_CD, 1, 3)
        </if>
         ORDER BY A.NEW_ADR_ZIP
    </select>

    <select id="selectCountResponsibleAreaCodePsic" resultType="int">
        SELECT COUNT(WK_GRP_CD)
          FROM TB_SVPD_RPB_LOCARA_PSIC_IZ
         WHERE RPB_LOCARA_CD = #{prbLocaraCd}
    </select>

    <insert id="saveResponsibleAreaCode">
        SELECT 1 FROM DUAL
<!--        INSERT INTO TB_SVPD_RPB_LOCARA_MNGT_ADR_IZ-->
<!--             ( RPB_LOCARA_CD-->
<!--             , LOCARA_SN-->
<!--             , APY_STRTDT-->
<!--             , APY_ENDDT-->
<!--             , FR2P_LGLD_CD-->
<!--             , CTPV_NM-->
<!--             , CTCTY_NM-->
<!--             , LAWC_EMD_NM-->
<!--             , AMTD_NM-->
<!--             , DTA_DL_YN-->
<!--              <include refid="COMMON.insertSystemField"/>-->
<!--             )-->
<!--        VALUES-->
<!--             ( #{prbLocaraCd}-->
<!--             , NVL(SELECT LPAD(MAX(LOCARA_SN)+1, 3, '0')-->
<!--                     FROM TB_SVPD_RPB_LOCARA_MNGT_ADR_IZ-->
<!--                    WHERE FR2P_LGLD_CD = #{fr2pLgldCd}-->
<!--                      AND CTPV_NM      = #{ctpvNm}-->
<!--                      AND CTCTY_NM     = #{ctctyNm}-->
<!--                      AND LAWC_EMD_NM  = #{lawcEmdNm}-->
<!--                      AND AMTD_NM      = #{atmdNm}, '001')-->
<!--             , #{apyStrdt}-->
<!--             , #{apyEnddt}-->
<!--             , #{fr2pLgldCd}-->
<!--             , #{ctpvNm} AS CTPV_NM-->
<!--             , #{ctctyNm} AS CTCTY_NM-->
<!--             , #{lawcEmdNm} AS LAWC_EMD_NM-->
<!--             , #{atmdNm} AS AMTD_NM-->
<!--             , 'N'-->
<!--              <include refid="COMMON.insertSystemFieldValue"/>-->
<!--             )-->
    </insert>

    <insert id="saveResponsibleAreaCodePsic">
        SELECT 1 FROM DUAL
<!--        INSERT INTO TB_SVPD_RPB_LOCARA_PSIC_IZ-->
<!--             ( WK_GRP_CD-->
<!--             , RPB_LOCARA_CD-->
<!--             , IZ_SN-->
<!--             , ICHR_PRTNR_NO-->
<!--             , PPRN_ICHR_PRTNR_NO1-->
<!--             , PPRN_ICHR_PRTNR_NO2-->
<!--             , PPRN_ICHR_PRTNR_NO3-->
<!--             , PPRN_ICHR_PRTNR_NO4-->
<!--             , PPRN_ICHR_PRTNR_NO5-->
<!--             , VST_DOW_VAL-->
<!--             , MMT_AV_LDTM-->
<!--             , RSTR_CNDT_USE_YN-->
<!--             , UDSN_USE_YN-->
<!--             , LOCARA_CEN_STRU_ADR-->
<!--             , W1_W3_SAT_WRK_YN-->
<!--             , RPB_LOCARA_GRP_CD-->
<!--             , VL_STRT_DTM-->
<!--             , VL_END_DTM-->
<!--             , DTA_DL_YN-->
<!--              <include refid="COMMON.insertSystemField"/>-->
<!--             )-->
<!--        SELECT WK_GRP_CD-->
<!--             , #{prbLocaraCd} AS PRB_LOCARA_CD-->
<!--             , '001' AS IZ_SN-->
<!--             , ICHR_PRTNR_NO-->
<!--             , PPRN_ICHR_PRTNR_NO1-->
<!--             , PPRN_ICHR_PRTNR_NO2-->
<!--             , PPRN_ICHR_PRTNR_NO3-->
<!--             , PPRN_ICHR_PRTNR_NO4-->
<!--             , PPRN_ICHR_PRTNR_NO5-->
<!--             , VST_DOW_VAL-->
<!--             , MMT_AV_LDTM-->
<!--             , RSTR_CNDT_USE_YN-->
<!--             , UDSN_USE_YN-->
<!--             , LOCARA_CEN_STRU_ADR-->
<!--             , W1_W3_SAT_WRK_YN-->
<!--             , RPB_LOCARA_GRP_CD-->
<!--             , TO_CHAR(SYSDATE, 'YYYYMMDD') AS VL_STRT_DTM-->
<!--             , '99991231' AS VL_END_DTM-->
<!--             , 'N'-->
<!--              <include refid="COMMON.insertSystemFieldValue"/>-->
<!--         FROM TB_SVPD_RPB_LOCARA_PSIC_IZ I1-->
<!--        WHERE RPB_LOCARA_CD = #{prbLocaraCd}-->
<!--          AND IZ_SN         = (SELECT MAX(IZ_SN)-->
<!--                                 FROM TB_SVPD_RPB_LOCARA_PSIC_IZ I2-->
<!--                                WHERE RPB_LOCARA_CD = I1.RPB_LOCARA_CD-->
<!--                                  AND WK_GRP_CD     = I1.WK_GRP_CD-->
<!--                                  AND TO_CHAR(SYSDATE, 'YYYYMMDD') BETWEEN I2.VL_STRT_DTM AND I2.VL_END_DTM-->
<!--                              )-->
<!--        ORDER BY RPB_LOCARA_CD, WK_GRP_CD-->
    </insert>

</mapper>
