<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.service.stock.mapper.WsnaOutOfStorageItemizationMapper">

    <select id="selectOutOfStorageItemizations" resultType="com.kyowon.sms.wells.web.service.stock.dto.WsnaOutOfStorageItemizationDto$SearchRes">

        SELECT DISTINCT T1.OSTR_WARE_NO
                      , T1.OSTR_DT
                      , T1.OSTR_TP_CD
                      , T1.ITM_OSTR_NO
                      , T1.ITM_STR_NO
                      , T1.STR_WARE_NO   /*입고창고번호*/
                      , T1.OSTR_AK_NO   /*출고요청번호*/
                      , T1.OSTR_AK_SN  /*출고요청일련번호*/
                      , T1.STR_HOP_DT /*입고희망일자*/
                      , T2.WARE_NM   /*창고명*/
                      , T2.WARE_ADR_ID /*창고주소ID*/
          FROM TB_SVST_ITM_OSTR_IZ T1
          LEFT OUTER JOIN TB_SVST_MCBY_WARE_IZ T2
            ON T2.WARE_NO = T1.STR_WARE_NO
           AND T2.APY_YM = SUBSTR(T1.OSTR_DT,1,6)
          WHERE 1 = 1
            AND T1.OSTR_DT BETWEEN #{stOstrDt} AND #{edOstrDt}
            AND T1.OSTR_WARE_NO = #{ostrWareNo}
        <if test="@MybatisUtils@isNotEmpty(ostrTpCd)">
            AND T1.OSTR_TP_CD = #{ostrTpCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(ostrWareDvCd)">
            AND T2.WARE_DV_CD = #{ostrWareDvCd}
        </if>
        <if test="@MybatisUtils@isNotEmpty(ostrWareNoM)">
            AND T2.HGR_WARE_NO = #{ostrWareNoM}
        </if>
        <if test="@MybatisUtils@isNotEmpty(ostrWareNoD)">
            AND T2.WARE_NO = #{ostrWareNoD}
        </if>
            AND T1.DTA_DL_YN = 'N'
          ORDER BY T1.OSTR_DT
                 , T1.ITM_OSTR_NO

    </select>
</mapper>
