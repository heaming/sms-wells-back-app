<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.contract.common.mapper.WctzHistoryMapper">

     <!-- TB_SSCT_CNTR_DCH_HIST 계약상세변경이력 -->
     <select id="selectCntrDetailForHist" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDetailChangeHistDvo">
         SELECT CNTR_NO
              , CNTR_SN
              , BASE_PD_CD
              , HGR_PD_CD
              , PD_QTY
              , STPL_PTRM_UNIT_CD
              , STPL_PTRM
              , ISTM_MCN
              , CNTR_PD_STRTDT
              , CNTR_PD_ENDDT
              , CNTR_DTL_STAT_CD
              , SELL_TP_CD
              , DSC_APY_TP_CD
              , DSC_APY_DTL_CD
              , DSC_APY_DRM_VAL
              , SV_PTRM_UNIT_CD
              , SV_PRD
              , CNTRW_TP_CD
              , BLG_CRP_CD
              , RVE_CRP_CD
              , CO_CD
              , BOO_SELL_TP_CD
              , PD_GD_CD
              , PD_HCLSF_ID
              , PD_MCLSF_ID
              , PD_LCLSF_ID
              , PD_DCLSF_ID
              , STLM_TP_CD
              , CRNCY_DV_CD
              , APY_EXCR
              , PD_BASE_AMT
              , FNL_AMT
              , VAT
              , SELL_AMT
              , CNTR_AMT
              , ISTM_PCAM_AMT
              , ISTM_INT_AMT
              , MM_ISTM_AMT
              , ACKMT_PERF_RT
              , ACKMT_PERF_AMT
              , CVT_PERF_AMT
              , SPP_DUEDT
              , RESUB_YN
              , RSTL_YN
              , FRISU_YN
              , FRISU_DSB_TP_CD
              , FEE_ACKMT_CT
              , FEE_ACKMT_BASE_AMT
              , FEE_FXAM_YN
              , TXINV_PBL_OJ_YN
              , SMTPL_ID
              , SMTPL_SN
              , BF_ORD_NO
              , CNTR_CH_RCP_ID
              , CNTR_CH_SN
              , CNTR_CH_DTL_RSON_CD
              , CNTR_CH_DTL_AK_CN
              , DTA_DL_YN
              , FST_RGST_DTM
              , FST_RGST_USR_ID
              , FST_RGST_PRG_ID
              , FST_RGST_DEPT_ID
              , FNL_MDFC_DTM
              , FNL_MDFC_USR_ID
              , FNL_MDFC_PRG_ID
              , FNL_MDFC_DEPT_ID
           FROM TB_SSCT_CNTR_DTL
          WHERE 1 = 1
            AND CNTR_NO = #{cntrNo}
            AND CNTR_SN = #{cntrSn}
     </select>
     <select id="selectCntrDetailChangeHist" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDetailChangeHistDvo">
         SELECT CNTR_NO
              , HIST_STRT_DTM
              , CNTR_SN
              , HIST_END_DTM
              , BASE_PD_CD
              , HGR_PD_CD
              , PD_QTY
              , STPL_PTRM_UNIT_CD
              , STPL_PTRM
              , ISTM_MCN
              , CNTR_PD_STRTDT
              , CNTR_PD_ENDDT
              , CNTR_DTL_STAT_CD
              , SELL_TP_CD
              , DSC_APY_TP_CD
              , DSC_APY_DTL_CD
              , DSC_APY_DRM_VAL
              , SV_PTRM_UNIT_CD
              , SV_PRD
              , CNTRW_TP_CD
              , BLG_CRP_CD
              , RVE_CRP_CD
              , CO_CD
              , BOO_SELL_TP_CD
              , PD_GD_CD
              , PD_HCLSF_ID
              , PD_MCLSF_ID
              , PD_LCLSF_ID
              , PD_DCLSF_ID
              , STLM_TP_CD
              , CRNCY_DV_CD
              , APY_EXCR
              , PD_BASE_AMT
              , FNL_AMT
              , VAT
              , SELL_AMT
              , CNTR_AMT
              , ISTM_PCAM_AMT
              , ISTM_INT_AMT
              , MM_ISTM_AMT
              , ACKMT_PERF_RT
              , ACKMT_PERF_AMT
              , CVT_PERF_AMT
              , SPP_DUEDT
              , RESUB_YN
              , RSTL_YN
              , FRISU_YN
              , FRISU_DSB_TP_CD
              , FEE_ACKMT_CT
              , FEE_ACKMT_BASE_AMT
              , FEE_FXAM_YN
              , TXINV_PBL_OJ_YN
              , SMTPL_ID
              , SMTPL_SN
              , BF_ORD_NO
              , CNTR_CH_RCP_ID
              , CNTR_CH_SN
              , CNTR_CH_DTL_RSON_CD
              , CNTR_CH_DTL_AK_CN
              , DTA_DL_YN
              , FST_RGST_DTM
              , FST_RGST_USR_ID
              , FST_RGST_PRG_ID
              , FST_RGST_DEPT_ID
              , FNL_MDFC_DTM
              , FNL_MDFC_USR_ID
              , FNL_MDFC_PRG_ID
              , FNL_MDFC_DEPT_ID
           FROM TB_SSCT_CNTR_DCH_HIST
          WHERE 1 = 1
            AND CNTR_NO = #{cntrNo}
            AND CNTR_SN = #{cntrSn}
            AND HIST_END_DTM = '99991231235959'
     </select>
     <insert id="insertCntrDetailChangeHist">
         INSERT INTO TB_SSCT_CNTR_DCH_HIST (
                CNTR_NO
              , HIST_STRT_DTM
              , CNTR_SN
              , HIST_END_DTM
              , BASE_PD_CD
              , HGR_PD_CD
              , PD_QTY
              , STPL_PTRM_UNIT_CD
              , STPL_PTRM
              , ISTM_MCN
              , CNTR_PD_STRTDT
              , CNTR_PD_ENDDT
              , CNTR_DTL_STAT_CD
              , SELL_TP_CD
              , DSC_APY_TP_CD
              , DSC_APY_DTL_CD
              , DSC_APY_DRM_VAL
              , SV_PTRM_UNIT_CD
              , SV_PRD
              , CNTRW_TP_CD
              , BLG_CRP_CD
              , RVE_CRP_CD
              , CO_CD
              , BOO_SELL_TP_CD
              , PD_GD_CD
              , PD_HCLSF_ID
              , PD_MCLSF_ID
              , PD_LCLSF_ID
              , PD_DCLSF_ID
              , STLM_TP_CD
              , CRNCY_DV_CD
              , APY_EXCR
              , PD_BASE_AMT
              , FNL_AMT
              , VAT
              , SELL_AMT
              , CNTR_AMT
              , ISTM_PCAM_AMT
              , ISTM_INT_AMT
              , MM_ISTM_AMT
              , ACKMT_PERF_RT
              , ACKMT_PERF_AMT
              , CVT_PERF_AMT
              , SPP_DUEDT
              , RESUB_YN
              , RSTL_YN
              , FRISU_YN
              , FRISU_DSB_TP_CD
              , FEE_ACKMT_CT
              , FEE_ACKMT_BASE_AMT
              , FEE_FXAM_YN
              , TXINV_PBL_OJ_YN
              , SMTPL_ID
              , SMTPL_SN
              , BF_ORD_NO
              , CNTR_CH_RCP_ID
              , CNTR_CH_SN
              , CNTR_CH_DTL_RSON_CD
              , CNTR_CH_DTL_AK_CN
              <include refid="COMMON.insertSystemField" />)
         VALUES (
                #{cntrNo}
              , #{histStrtDtm}
              , #{cntrSn}
              , #{histEndDtm}
              , #{basePdCd}
              , #{hgrPdCd}
              , #{pdQty}
              , #{stplPtrmUnitCd}
              , #{stplPtrm}
              , #{istmMcn}
              , #{cntrPdStrtdt}
              , #{cntrPdEnddt}
              , #{cntrDtlStatCd}
              , #{sellTpCd}
              , #{dscApyTpCd}
              , #{dscApyDtlCd}
              , #{dscApyDrmVal}
              , #{svPtrmUnitCd}
              , #{svPrd}
              , #{cntrwTpCd}
              , #{blgCrpCd}
              , #{rveCrpCd}
              , #{coCd}
              , #{booSellTpCd}
              , #{pdGdCd}
              , #{pdHclsfId}
              , #{pdMclsfId}
              , #{pdLclsfId}
              , #{pdDclsfId}
              , #{stlmTpCd}
              , #{crncyDvCd}
              , #{apyExcr}
              , #{pdBaseAmt}
              , #{fnlAmt}
              , #{vat}
              , #{sellAmt}
              , #{cntrAmt}
              , #{istmPcamAmt}
              , #{istmIntAmt}
              , #{mmIstmAmt}
              , #{ackmtPerfRt}
              , #{ackmtPerfAmt}
              , #{cvtPerfAmt}
              , #{sppDuedt}
              , #{resubYn}
              , #{rstlYn}
              , #{frisuYn}
              , #{frisuDsbTpCd}
              , #{feeAckmtCt}
              , #{feeAckmtBaseAmt}
              , #{feeFxamYn}
              , #{txinvPblOjYn}
              , #{smtplId}
              , #{smtplSn}
              , #{bfOrdNo}
              , #{cntrChRcpId}
              , #{cntrChSn}
              , #{cntrChDtlRsonCd}
              , #{cntrChDtlAkCn}
              <include refid="COMMON.insertSystemFieldValue" /> )
     </insert>
     <update id="updateCntrDetailChangeHist">
         UPDATE TB_SSCT_CNTR_DCH_HIST
            SET HIST_END_DTM        = #{histEndDtm}
              , BASE_PD_CD          = #{basePdCd}
              , HGR_PD_CD           = #{hgrPdCd}
              , PD_QTY              = #{pdQty}
              , STPL_PTRM_UNIT_CD   = #{stplPtrmUnitCd}
              , STPL_PTRM           = #{stplPtrm}
              , ISTM_MCN            = #{istmMcn}
              , CNTR_PD_STRTDT      = #{cntrPdStrtdt}
              , CNTR_PD_ENDDT       = #{cntrPdEnddt}
              , CNTR_DTL_STAT_CD    = #{cntrDtlStatCd}
              , SELL_TP_CD          = #{sellTpCd}
              , DSC_APY_TP_CD       = #{dscApyTpCd}
              , DSC_APY_DTL_CD      = #{dscApyDtlCd}
              , DSC_APY_DRM_VAL     = #{dscApyDrmVal}
              , SV_PTRM_UNIT_CD     = #{svPtrmUnitCd}
              , SV_PRD              = #{svPrd}
              , CNTRW_TP_CD         = #{cntrwTpCd}
              , BLG_CRP_CD          = #{blgCrpCd}
              , RVE_CRP_CD          = #{rveCrpCd}
              , CO_CD               = #{coCd}
              , BOO_SELL_TP_CD      = #{booSellTpCd}
              , PD_GD_CD            = #{pdGdCd}
              , PD_HCLSF_ID         = #{pdHclsfId}
              , PD_MCLSF_ID         = #{pdMclsfId}
              , PD_LCLSF_ID         = #{pdLclsfId}
              , PD_DCLSF_ID         = #{pdDclsfId}
              , STLM_TP_CD          = #{stlmTpCd}
              , CRNCY_DV_CD         = #{crncyDvCd}
              , APY_EXCR            = #{apyExcr}
              , PD_BASE_AMT         = #{pdBaseAmt}
              , FNL_AMT             = #{fnlAmt}
              , VAT                 = #{vat}
              , SELL_AMT            = #{sellAmt}
              , CNTR_AMT            = #{cntrAmt}
              , ISTM_PCAM_AMT       = #{istmPcamAmt}
              , ISTM_INT_AMT        = #{istmIntAmt}
              , MM_ISTM_AMT         = #{mmIstmAmt}
              , ACKMT_PERF_RT       = #{ackmtPerfRt}
              , ACKMT_PERF_AMT      = #{ackmtPerfAmt}
              , CVT_PERF_AMT        = #{cvtPerfAmt}
              , SPP_DUEDT           = #{sppDuedt}
              , RESUB_YN            = #{resubYn}
              , RSTL_YN             = #{rstlYn}
              , FRISU_YN            = #{frisuYn}
              , FRISU_DSB_TP_CD     = #{frisuDsbTpCd}
              , FEE_ACKMT_CT        = #{feeAckmtCt}
              , FEE_ACKMT_BASE_AMT  = #{feeAckmtBaseAmt}
              , FEE_FXAM_YN         = #{feeFxamYn}
              , TXINV_PBL_OJ_YN     = #{txinvPblOjYn}
              , SMTPL_ID            = #{smtplId}
              , SMTPL_SN            = #{smtplSn}
              , BF_ORD_NO           = #{bfOrdNo}
              , CNTR_CH_RCP_ID      = #{cntrChRcpId}
              , CNTR_CH_SN          = #{cntrChSn}
              , CNTR_CH_DTL_RSON_CD = #{cntrChDtlRsonCd}
              , CNTR_CH_DTL_AK_CN   = #{cntrChDtlAkCn}
             <include refid="COMMON.updateSystemField"/>
          WHERE 1 = 1
            AND CNTR_NO             = #{cntrNo}
            AND HIST_STRT_DTM       = #{histStrtDtm}
            AND CNTR_SN             = #{cntrSn}
     </update>
     <update id="deleteCntrDetailChangeHist">
         UPDATE TB_SSCT_CNTR_DCH_HIST
            SET DTA_DL_YN           = 'Y'
             <include refid="COMMON.updateSystemField"/>
          WHERE 1 = 1
            AND CNTR_NO             = #{cntrNo}
            AND HIST_STRT_DTM       = #{histStrtDtm}
            AND CNTR_SN             = #{cntrSn}
     </update>

     <!-- TB_SSCT_CNTR_DTL_STAT_CH_HIST 계약상세상태변경이력 -->
     <select id="selectCntrDetailStatChangeHist" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDtlStatChangeHistDvo">
         SELECT CNTR_NO
              , CNTR_SN
              , HIST_STRT_DTM
              , HIST_END_DTM
              , CNTR_DTL_STAT_CD
              , CNTR_DTL_STAT_CH_RSON_CD
              , CNTR_DTL_STAT_CH_MO_CN
              , DTA_DL_YN
              , FST_RGST_DTM
              , FST_RGST_USR_ID
              , FST_RGST_PRG_ID
              , FST_RGST_DEPT_ID
              , FNL_MDFC_DTM
              , FNL_MDFC_USR_ID
              , FNL_MDFC_PRG_ID
              , FNL_MDFC_DEPT_ID
           FROM TB_SSCT_CNTR_DTL_STAT_CH_HIST
          WHERE 1 = 1
            AND CNTR_NO = #{cntrNo}
            AND CNTR_SN = #{cntrSn}
            AND HIST_END_DTM = '99991231235959'
     </select>
     <insert id="insertCntrDetailStatChangeHist">
         INSERT INTO TB_SSCT_CNTR_DTL_STAT_CH_HIST (
                CNTR_NO
              , CNTR_SN
              , HIST_STRT_DTM
              , HIST_END_DTM
              , CNTR_DTL_STAT_CD
              , CNTR_DTL_STAT_CH_RSON_CD
              , CNTR_DTL_STAT_CH_MO_CN
              <include refid="COMMON.insertSystemField" />)
         VALUES (
                #{cntrNo}
              , #{cntrSn}
              , #{histStrtDtm}
              , #{histEndDtm}
              , #{cntrDtlStatCd}
              , #{cntrDtlStatChRsonCd}
              , #{cntrDtlStatChMoCn}
              <include refid="COMMON.insertSystemFieldValue" /> )
     </insert>
     <update id="updateCntrDetailStatChangeHist">
         UPDATE TB_SSCT_CNTR_DTL_STAT_CH_HIST
            SET HIST_END_DTM             = #{histEndDtm}
              , CNTR_DTL_STAT_CD         = #{cntrDtlStatCd}
              , CNTR_DTL_STAT_CH_RSON_CD = #{cntrDtlStatChRsonCd}
              , CNTR_DTL_STAT_CH_MO_CN   = #{cntrDtlStatChMoCn}
             <include refid="COMMON.updateSystemField"/>
          WHERE 1 = 1
            AND CNTR_NO                  = #{cntrNo}
            AND CNTR_SN                  = #{cntrSn}
            AND HIST_STRT_DTM            = #{histStrtDtm}
     </update>
     <update id="deleteCntrDetailStatChangeHist">
         UPDATE TB_SSCT_CNTR_DTL_STAT_CH_HIST
            SET DTA_DL_YN                = 'Y'
             <include refid="COMMON.updateSystemField"/>
          WHERE 1 = 1
            AND CNTR_NO                  = #{cntrNo}
            AND CNTR_SN                  = #{cntrSn}
            AND HIST_STRT_DTM            = #{histStrtDtm}
     </update>


    <!-- 계약상세상태변경이력 -->
    <select id="selectCntrDtlStatForHist" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDtlStatChHistDvo">
        SELECT CNTR_NO
             , CNTR_SN
             , CNTR_DTL_STAT_CD
          FROM TB_SSCT_CNTR_DTL
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
    </select>

    <select id="selectCntrDtlStatChangeHistory" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDtlStatChHistDvo">
        SELECT CNTR_NO
             , CNTR_SN
             , HIST_STRT_DTM
             , HIST_END_DTM
             , CNTR_DTL_STAT_CD
             , CNTR_DTL_STAT_CH_RSON_CD
             , CNTR_DTL_STAT_CH_MO_CN
             , DTA_DL_YN
          FROM TB_SSCT_CNTR_DTL_STAT_CH_HIST
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
           AND HIST_END_DTM = '99991231235959'
    </select>

    <update id="updateCntrDtlStatChangeHistory" parameterType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDtlStatChHistDvo">
        UPDATE TB_SSCT_CNTR_DTL_STAT_CH_HIST
           SET HIST_END_DTM = #{histEndDtm}
             , CNTR_DTL_STAT_CD = #{cntrDtlStatCd}
             , CNTR_DTL_STAT_CH_RSON_CD = #{cntrDtlStatChRsonCd}
             , CNTR_DTL_STAT_CH_MO_CN = #{cntrDtlStatChMoCn}
             , DTA_DL_YN = #{dtaDlYn}
               <include refid="COMMON.updateSystemField"/>
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
           AND HIST_STRT_DTM = #{histStrtDtm}
    </update>

    <insert id="insertCntrDtlStatChangeHistory" parameterType="com.kyowon.sms.wells.web.contract.common.dvo.WctzCntrDtlStatChHistDvo">
        INSERT INTO TB_SSCT_CNTR_DTL_STAT_CH_HIST(
              CNTR_NO
            , CNTR_SN
            , HIST_STRT_DTM
            , HIST_END_DTM
            , CNTR_DTL_STAT_CD
            , CNTR_DTL_STAT_CH_RSON_CD
            , CNTR_DTL_STAT_CH_MO_CN
            , DTA_DL_YN
             <include refid="COMMON.insertSystemField" />
        ) VALUES (
              #{cntrNo}
            , #{cntrSn}
            , #{histStrtDtm}
            , #{histEndDtm}
            , #{cntrDtlStatCd}
            , #{cntrDtlStatChRsonCd}
            , #{cntrDtlStatCh}
            , 'N'
            <include refid="COMMON.insertSystemFieldValue" />
        )
    </insert>


    <!-- 계약상세변경이력 -->
    <select id="selectContractDetailForHist" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzContraceDetailHistDvo">
        SELECT CNTR_NO
             , CNTR_SN
             , BASE_PD_CD
             , HGR_PD_CD
             , PD_QTY
             , STPL_PTRM_UNIT_CD
             , STPL_PTRM
             , ISTM_MCN
             , CNTR_PD_STRTDT
             , CNTR_PD_ENDDT
             , CNTR_DTL_STAT_CD
             , SELL_TP_CD
             , DSC_APY_TP_CD
             , DSC_APY_DTL_CD
             , DSC_APY_DRM_VAL
             , SV_PTRM_UNIT_CD
             , SV_PRD
             , CNTRW_TP_CD
             , BLG_CRP_CD
             , RVE_CRP_CD
             , CO_CD
             , BOO_SELL_TP_CD
             , PD_GD_CD
             , PD_HCLSF_ID
             , PD_MCLSF_ID
             , PD_LCLSF_ID
             , PD_DCLSF_ID
             , STLM_TP_CD
             , CRNCY_DV_CD
             , APY_EXCR
             , PD_BASE_AMT
             , FNL_AMT
             , VAT
             , SELL_AMT
             , CNTR_AMT
             , ISTM_PCAM_AMT
             , ISTM_INT_AMT
             , MM_ISTM_AMT
             , ACKMT_PERF_RT
             , ACKMT_PERF_AMT
             , CVT_PERF_AMT
             , SPP_DUEDT
             , RESUB_YN
             , RSTL_YN
             , FRISU_YN
             , FRISU_DSB_TP_CD
             , FEE_ACKMT_CT
             , FEE_ACKMT_BASE_AMT
             , FEE_FXAM_YN
             , TXINV_PBL_OJ_YN
             , SMTPL_ID
             , SMTPL_SN
             , BF_ORD_NO
             , CNTR_CH_RCP_ID
             , CNTR_CH_SN
             , CNTR_CH_DTL_RSON_CD
             , CNTR_CH_DTL_AK_CN
             , DTA_DL_YN
          FROM TB_SSCT_CNTR_DTL
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
    </select>

    <select id="selectContractDetailHistory" resultType="com.kyowon.sms.wells.web.contract.common.dvo.WctzContraceDetailHistDvo">
        SELECT CNTR_NO
             , HIST_STRT_DTM
             , CNTR_SN
             , HIST_END_DTM
             , BASE_PD_CD
             , HGR_PD_CD
             , PD_QTY
             , STPL_PTRM_UNIT_CD
             , STPL_PTRM
             , ISTM_MCN
             , CNTR_PD_STRTDT
             , CNTR_PD_ENDDT
             , CNTR_DTL_STAT_CD
             , SELL_TP_CD
             , DSC_APY_TP_CD
             , DSC_APY_DTL_CD
             , DSC_APY_DRM_VAL
             , SV_PTRM_UNIT_CD
             , SV_PRD
             , CNTRW_TP_CD
             , BLG_CRP_CD
             , RVE_CRP_CD
             , CO_CD
             , BOO_SELL_TP_CD
             , PD_GD_CD
             , PD_HCLSF_ID
             , PD_MCLSF_ID
             , PD_LCLSF_ID
             , PD_DCLSF_ID
             , STLM_TP_CD
             , CRNCY_DV_CD
             , APY_EXCR
             , PD_BASE_AMT
             , FNL_AMT
             , VAT
             , SELL_AMT
             , CNTR_AMT
             , ISTM_PCAM_AMT
             , ISTM_INT_AMT
             , MM_ISTM_AMT
             , ACKMT_PERF_RT
             , ACKMT_PERF_AMT
             , CVT_PERF_AMT
             , SPP_DUEDT
             , RESUB_YN
             , RSTL_YN
             , FRISU_YN
             , FRISU_DSB_TP_CD
             , FEE_ACKMT_CT
             , FEE_ACKMT_BASE_AMT
             , FEE_FXAM_YN
             , TXINV_PBL_OJ_YN
             , SMTPL_ID
             , SMTPL_SN
             , BF_ORD_NO
             , CNTR_CH_RCP_ID
             , CNTR_CH_SN
             , CNTR_CH_DTL_RSON_CD
             , CNTR_CH_DTL_AK_CN
             , DTA_DL_YN
          FROM TB_SSCT_CNTR_DCH_HIST
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
           AND HIST_END_DTM = '99991231235959'
    </select>

    <update id="updateContractDetailHistory" parameterType="com.kyowon.sms.wells.web.contract.common.dvo.WctzContraceDetailHistDvo">
        UPDATE TB_SSCT_CNTR_DCH_HIST
           SET HIST_END_DTM = #{histEndDtm}
             , BASE_PD_CD = #{basePdCd}
             , HGR_PD_CD = #{hgrPdCd}
             , PD_QTY = #{pdQty}
             , STPL_PTRM_UNIT_CD = #{stplPtrmUnitCd}
             , STPL_PTRM = #{stplPtrm}
             , ISTM_MCN = #{istmMcn}
             , CNTR_PD_STRTDT = #{cntrPdStrtdt}
             , CNTR_PD_ENDDT = #{cntrPdEnddt}
             , CNTR_DTL_STAT_CD = #{cntrDtlStatCd}
             , SELL_TP_CD = #{sellTpCd}
             , DSC_APY_TP_CD = #{dscApyTpCd}
             , DSC_APY_DTL_CD = #{dscApyDtlCd}
             , DSC_APY_DRM_VAL = #{dscApyDrmVal}
             , SV_PTRM_UNIT_CD = #{svPtrmUnitCd}
             , SV_PRD = #{svPrd}
             , CNTRW_TP_CD = #{cntrwTpCd}
             , BLG_CRP_CD = #{blgCrpCd}
             , RVE_CRP_CD = #{rveCrpCd}
             , CO_CD = #{coCd}
             , BOO_SELL_TP_CD = #{booSellTpCd}
             , PD_GD_CD = #{pdGdCd}
             , PD_HCLSF_ID = #{pdHclsfId}
             , PD_MCLSF_ID = #{pdMclsfId}
             , PD_LCLSF_ID = #{pdLclsfId}
             , PD_DCLSF_ID = #{pdDclsfId}
             , STLM_TP_CD = #{stlmTpCd}
             , CRNCY_DV_CD = #{crncyDvCd}
             , APY_EXCR = #{apyExcr}
             , PD_BASE_AMT = #{pdBaseAmt}
             , FNL_AMT = #{fnlAmt}
             , VAT = #{vat}
             , SELL_AMT = #{sellAmt}
             , CNTR_AMT = #{cntrAmt}
             , ISTM_PCAM_AMT = #{istmPcamAmt}
             , ISTM_INT_AMT = #{istmIntAmt}
             , MM_ISTM_AMT = #{mmIstmAmt}
             , ACKMT_PERF_RT = #{ackmtPerfRt}
             , ACKMT_PERF_AMT = #{ackmtPerfAmt}
             , CVT_PERF_AMT = #{cvtPerfAmt}
             , SPP_DUEDT = #{sppDuedt}
             , RESUB_YN = #{resubYn}
             , RSTL_YN = #{rstlYn}
             , FRISU_YN = #{frisuYn}
             , FRISU_DSB_TP_CD = #{frisuDsbTpCd}
             , FEE_ACKMT_CT = #{feeAckmtCt}
             , FEE_ACKMT_BASE_AMT = #{feeAckmtBaseAmt}
             , FEE_FXAM_YN = #{feeFxamYn}
             , TXINV_PBL_OJ_YN = #{txinvPblOjYn}
             , SMTPL_ID = #{smtplId}
             , SMTPL_SN = #{smtplSn}
             , BF_ORD_NO = #{bfOrdNo}
             , CNTR_CH_RCP_ID = #{cntrChRcpId}
             , CNTR_CH_SN = #{cntrChSn}
             , CNTR_CH_DTL_RSON_CD = #{cntrChDtlRsonCd}
             , CNTR_CH_DTL_AK_CN = #{cntrChDtlAkCn}
             , DTA_DL_YN = #{dtaDlYn}
               <include refid="COMMON.updateSystemField"/>
         WHERE CNTR_NO = #{cntrNo}
           AND CNTR_SN = #{cntrSn}
           AND HIST_STRT_DTM = #{histStrtDtm}
    </update>

    <insert id="insertContractDetailHistory" parameterType="com.kyowon.sms.wells.web.contract.common.dvo.WctzContraceDetailHistDvo">
        INSERT INTO TB_SSCT_CNTR_DCH_HIST(
              CNTR_NO
            , HIST_STRT_DTM
            , CNTR_SN
            , HIST_END_DTM
            , BASE_PD_CD
            , HGR_PD_CD
            , PD_QTY
            , STPL_PTRM_UNIT_CD
            , STPL_PTRM
            , ISTM_MCN
            , CNTR_PD_STRTDT
            , CNTR_PD_ENDDT
            , CNTR_DTL_STAT_CD
            , SELL_TP_CD
            , DSC_APY_TP_CD
            , DSC_APY_DTL_CD
            , DSC_APY_DRM_VAL
            , SV_PTRM_UNIT_CD
            , SV_PRD
            , CNTRW_TP_CD
            , BLG_CRP_CD
            , RVE_CRP_CD
            , CO_CD
            , BOO_SELL_TP_CD
            , PD_GD_CD
            , PD_HCLSF_ID
            , PD_MCLSF_ID
            , PD_LCLSF_ID
            , PD_DCLSF_ID
            , STLM_TP_CD
            , CRNCY_DV_CD
            , APY_EXCR
            , PD_BASE_AMT
            , FNL_AMT
            , VAT
            , SELL_AMT
            , CNTR_AMT
            , ISTM_PCAM_AMT
            , ISTM_INT_AMT
            , MM_ISTM_AMT
            , ACKMT_PERF_RT
            , ACKMT_PERF_AMT
            , CVT_PERF_AMT
            , SPP_DUEDT
            , RESUB_YN
            , RSTL_YN
            , FRISU_YN
            , FRISU_DSB_TP_CD
            , FEE_ACKMT_CT
            , FEE_ACKMT_BASE_AMT
            , FEE_FXAM_YN
            , TXINV_PBL_OJ_YN
            , SMTPL_ID
            , SMTPL_SN
            , BF_ORD_NO
            , CNTR_CH_RCP_ID
            , CNTR_CH_SN
            , CNTR_CH_DTL_RSON_CD
            , CNTR_CH_DTL_AK_CN
            , DTA_DL_YN
             <include refid="COMMON.insertSystemField" />
        ) VALUES (
              #{cntrNo}
            , #{histStrtDtm}
            , #{cntrSn}
            , #{histEndDtm}
            , #{basePdCd}
            , #{hgrPdCd}
            , #{pdQty}
            , #{stplPtrmUnitCd}
            , #{stplPtrm}
            , #{istmMcn}
            , #{cntrPdStrtdt}
            , #{cntrPdEnddt}
            , #{cntrDtlStatCd}
            , #{sellTpCd}
            , #{dscApyTpCd}
            , #{dscApyDtlCd}
            , #{dscApyDrmVal}
            , #{svPtrmUnitCd}
            , #{svPrd}
            , #{cntrwTpCd}
            , #{blgCrpCd}
            , #{rveCrpCd}
            , #{coCd}
            , #{booSellTpCd}
            , #{pdGdCd}
            , #{pdHclsfId}
            , #{pdMclsfId}
            , #{pdLclsfId}
            , #{pdDclsfId}
            , #{stlmTpCd}
            , #{crncyDvCd}
            , #{apyExcr}
            , #{pdBaseAmt}
            , #{fnlAmt}
            , #{vat}
            , #{sellAmt}
            , #{cntrAmt}
            , #{istmPcamAmt}
            , #{istmIntAmt}
            , #{mmIstmAmt}
            , #{ackmtPerfRt}
            , #{ackmtPerfAmt}
            , #{cvtPerfAmt}
            , #{sppDuedt}
            , #{resubYn}
            , #{rstlYn}
            , #{frisuYn}
            , #{frisuDsbTpCd}
            , #{feeAckmtCt}
            , #{feeAckmtBaseAmt}
            , #{feeFxamYn}
            , #{txinvPblOjYn}
            , #{smtplId}
            , #{smtplSn}
            , #{bfOrdNo}
            , #{cntrChRcpId}
            , #{cntrChSn}
            , #{cntrChDtlRsonCd}
            , #{cntrChDtlAkCn}
            , 'N'
            <include refid="COMMON.insertSystemFieldValue" />
        )
    </insert>
</mapper>
