<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.contract.ordermgmt.mapper.WctaKakaotalksMapper">
    <select id="selectKakaotalkFwIzs" resultType="com.kyowon.sms.wells.web.contract.ordermgmt.dto.WctaKakaotalksDto$SearchRes">
        SELECT T0.RECIPIENT_NUM
             , T0.DATE_CLIENT_REQ
             , T0.DATE_RSLT
             --, '(' || T0.RESULT || ')' || T3.RESL_CD_CNTN AS RESL_CD_CNTN
             , '(' || T0.RESULT || ')' AS  RESL_CD_CNTN
             , CASE WHEN T1.SUCC_COUNT > 0 THEN 'SMS'
                    --WHEN T2.SUCC_COUNT > 0 THEN 'LMS'
                    ELSE '-'
               END AS RPLC_SEND
             , T0.MSG
             , T0.USER_ID
          FROM AFMDBS.ATA_MMT_TRAN T0
          LEFT OUTER JOIN AFMDBS.SDK_SMS_REPORT T1
            ON TO_CHAR(T0.MT_PR) = T1.RESERVED6
          --LEFT OUTER JOIN AFMDBS.SDK_MMS_REPORT T2
          --  ON TO_CHAR(T0.MT_PR) = T2.RESERVED6
          --LEFT OUTER JOIN TB_BIZTALK_RESULT_CD T3
          --  ON T0.RESULT = T3.RESL_CD
         WHERE 1=1
           AND T0.MT_PR = #{mtPr}
           AND T0.TEMPLATE_CODE IN (
        <foreach collection="tempCodeList" item="code" separator=",">
               #{code}
        </foreach>
               )
    </select>
</mapper>
