<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.contract.risk.mapper.WctaContractMapper">
    <select id="selectApprovalAskDivides" resultType="com.kyowon.sms.wells.web.contract.risk.dto.WctaContractDto$SearchRes">
        SELECT CNTR_APR_AK_DV_CD
             , CNTR_APR_AK_DV_CD AS CNTR_APR_AK_DV_PK
             , CNTR_APR_AK_DV_CD_NM
             , (CNTR_APR_AK_DV_CD || '-' || CNTR_APR_AK_DV_CD_NM) AS CNTR_APR_AK_DV_NM
             , CNTR_APR_AK_MSG_CN
             , CNTR_APR_CAN_MSG_CN
             , CNTR_APR_CONF_MSG_CN
             , VL_STRT_DTM
             , VL_STRT_DTM AS VL_STRT_DTM_PK
             , VL_END_DTM
          FROM TB_SSCT_CNTR_APR_AK_DV_CD
         WHERE 1=1
         <if test='@MybatisUtils@isNotEmpty(standardDt)'>
           AND #{standardDt} BETWEEN VL_STRT_DTM AND VL_END_DTM
         </if>
         ORDER BY TO_NUMBER(CNTR_APR_AK_DV_CD)
    </select>
    
    <update id="removeApprovalAskDivides">
        UPDATE TB_SSCT_CNTR_APR_AK_DV_CD
           SET DTA_DL_YN = 'Y' 
               <include refid="COMMON.updateSystemField"/>
         WHERE 1=1
           AND CNTR_APR_AK_DV_CD = #{cntrAprAkDvCd}
           AND VL_STRT_DTM = #{vlStartDtm}
    </update>
</mapper>