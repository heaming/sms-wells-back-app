<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.contract.interfaces.mapper.WctiContractInstallMapper">

    <sql id="updateSystemField">
                   , FNL_MDFC_DTM = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
                   , FNL_MDFC_USR_ID = 'CS_INTERFACE'
                   , FNL_MDFC_PRG_ID = 'CS_INTERFACE'
                   , FNL_MDFC_DEPT_ID = 'CS_INTERFACE'
    </sql>

    <update id="updateContractInstallInf" parameterType="com.kyowon.sms.wells.web.contract.interfaces.dvo.WctiContractInstallDvo">
        UPDATE TB_SSCT_CNTR_ADRPC_BAS
        <set>
            <if test='@MybatisUtils@isNotEmpty(adrId)'>, ADR_ID = #{adrId} </if>
            <if test='@MybatisUtils@isNotEmpty(cralLocaraTno)'>, CRAL_LOCARA_TNO = #{cralLocaraTno} </if>
            <if test='@MybatisUtils@isNotEmpty(mexno)'>, MEXNO_ENCR = #{mexno} </if>
            <if test='@MybatisUtils@isNotEmpty(cralIdvTno)'>, CRAL_IDV_TNO = #{cralIdvTno} </if>
            <if test='@MybatisUtils@isNotEmpty(locaraTno)'>, LOCARA_TNO = #{locaraTno} </if>
            <if test='@MybatisUtils@isNotEmpty(exno)'>, EXNO_ENCR = #{exno} </if>
            <if test='@MybatisUtils@isNotEmpty(idvTno)'>, IDV_TNO = #{idvTno} </if>
        </set>
        <include refid="updateSystemField" />
         WHERE CNTR_ADRPC_ID IN (SELECT CNTR_ADRPC_ID
                                   FROM TB_SSCT_CNTR_ADR_REL
                                  WHERE DTL_CNTR_NO = #{cntrNo}
                                    AND DTL_CNTR_SN = #{cntrSn}
                                    AND ADRPC_TP_CD = '2'
                                    AND DTA_DL_YN = 'N'
                                 )
    </update>
</mapper>
