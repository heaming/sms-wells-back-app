<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.fee.aggregate.mapper.WfeaOrganizationNetOrderMapper">

    <delete id="deleteBsPerformances">
        SELECT *
        FROM DUAL
    </delete>

    <insert id="insertBsPerformances">
        SELECT *
        FROM DUAL
    </insert>

    <select id='selectHomeMasters'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchHmstRes">
        SELECT 'O1총괄' AS COL1
        , 'OO지역' AS COL2
        , #{schBizDv} AS COL3
        , #{schDv} AS COL4
        , #{schPdctTp} AS COL5
        , #{schPdCdStrt} AS COL6
        , #{schPdCdEnd} AS COL7
        , #{schSlDtStrt} AS COL8
        , #{schSlDtEnd} AS COL9
        , #{schRcpDtStrt} AS COL10
        , #{schRcpDtEnd} AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '1-정상가' AS COL24
        , '3-3년' AS COL25
        , '82' AS COL26
        , 'A-전체' AS COL27
        , '123,456' AS COL28
        , '36' AS COL29
        , '12,345' AS COL30
        , '0' AS COL31
        , '-' AS COL32
        , '-' AS COL33
        , '1-정상가' AS COL34
        , '3-3년' AS COL35
        , '82' AS COL36
        , 'A-전체' AS COL37
        , '123,456' AS COL38
        , '36' AS COL39
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '1-정상가' AS COL24
        , '3-3년' AS COL25
        , '82' AS COL26
        , 'A-전체' AS COL27
        , '123,456' AS COL28
        , '36' AS COL29
        , '12,345' AS COL30
        , '0' AS COL31
        , '-' AS COL32
        , '-' AS COL33
        , '1-정상가' AS COL34
        , '3-3년' AS COL35
        , '82' AS COL36
        , 'A-전체' AS COL37
        , '123,456' AS COL38
        , '36' AS COL39
        FROM DUAL
    </select>

    <select id='selectHomeMasterSellFees'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchHmstSellFeeRes">
        SELECT 'O2총괄' AS COL1
        , 'OO지역' AS COL2
        , #{schBizDv} AS COL3
        , #{schDv} AS COL4
        , #{schPerfYm} AS COL5
        , #{schPdctTp} AS COL6
        , #{schPdCdStrt} AS COL7
        , #{schPdCdEnd} AS COL8
        , #{schSlDtStrt} AS COL9
        , #{schSlDtEnd} AS COL10
        , #{schRcpDtStrt} AS COL11
        , #{schRcpDtEnd} AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        FROM DUAL
    </select>

    <select id='selectHomeMasterBeforeServices'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchHmstBsRes">
        SELECT 'O3총괄' AS COL1
        , 'OO지역' AS COL2
        , #{schBizDv} AS COL3
        , #{schDv} AS COL4
        , #{schPerfYm} AS COL5
        , #{schPdCdStrt} AS COL6
        , #{schPdCdEnd} AS COL7
        , #{schVstDtStrt} AS COL8
        , #{schVstDtEnd} AS COL9
        , '1-정상가' AS COL10
        , '2-정상가' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '3-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        FROM DUAL
    </select>

    <select id='selectManagers'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchMngerRes">
        SELECT 'O1총괄' AS COL1
        , 'OO지역' AS COL2
        , #{schBizDv} AS COL3
        , #{schDv} AS COL4
        , #{schPdctTp} AS COL5
        , #{schPdCdStrt} AS COL6
        , #{schPdCdEnd} AS COL7
        , #{schSlDtStrt} AS COL8
        , #{schSlDtEnd} AS COL9
        , #{schRcpDtStrt} AS COL10
        , #{schRcpDtEnd} AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '1-정상가' AS COL24
        , '3-3년' AS COL25
        , '82' AS COL26
        , 'A-전체' AS COL27
        , '123,456' AS COL28
        , '36' AS COL29
        , '12,345' AS COL30
        , '0' AS COL31
        , '-' AS COL32
        , '-' AS COL33
        , '1-정상가' AS COL34
        , '3-3년' AS COL35
        , '82' AS COL36
        , 'A-전체' AS COL37
        , '123,456' AS COL38
        , '36' AS COL39
        , '123,456' AS COL40
        , '36' AS COL41
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '1-정상가' AS COL24
        , '3-3년' AS COL25
        , '82' AS COL26
        , 'A-전체' AS COL27
        , '123,456' AS COL28
        , '36' AS COL29
        , '12,345' AS COL30
        , '0' AS COL31
        , '-' AS COL32
        , '-' AS COL33
        , '1-정상가' AS COL34
        , '3-3년' AS COL35
        , '82' AS COL36
        , 'A-전체' AS COL37
        , '123,456' AS COL38
        , '36' AS COL39
        , '123,456' AS COL40
        , '36' AS COL41
        FROM DUAL
    </select>

    <select id='selectManagerSellFees'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchMngerSellFeeRes">
        SELECT 'O2총괄' AS COL1
        , 'OO지역' AS COL2
        , #{schBizDv} AS COL3
        , #{schDv} AS COL4
        , #{schPerfYm} AS COL5
        , #{schPdctTp} AS COL6
        , #{schPdCdStrt} AS COL7
        , #{schPdCdEnd} AS COL8
        , #{schSlDtStrt} AS COL9
        , #{schSlDtEnd} AS COL10
        , #{schRcpDtStrt} AS COL11
        , #{schRcpDtEnd} AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '1-일시불' AS COL15
        , '1-정상가' AS COL16
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '1-일시불' AS COL15
        , '1-정상가' AS COL16
        FROM DUAL
    </select>

    <select id='selectManagerBeforeServices'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchMngerBsRes">
        SELECT 'O3총괄' AS COL1
        , 'OO지역' AS COL2
        , #{schBizDv} AS COL3
        , #{schDv} AS COL4
        , #{schPerfYm} AS COL5
        , #{schPdCdStrt} AS COL6
        , #{schPdCdEnd} AS COL7
        , #{schVstDtStrt} AS COL8
        , #{schVstDtEnd} AS COL9
        , '2-정상가' AS COL10
        , '3-정상가' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '82' AS COL19
        , 'A-전체' AS COL20
        , '123,456' AS COL21
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '82' AS COL19
        , 'A-전체' AS COL20
        , '123,456' AS COL21
        FROM DUAL
    </select>

    <select id='selectPlanners'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchPlarRes">
        SELECT M.OG1_NM    /* 총괄단 */
             , M.OG2_NM    /* 지역단 */
             , M.OG3_NM    /* 지점 */
             , M.PRTNR_NO  /* 번호 */
             , M.PRTNR_KNM /* 성명 */
             , M.GUBN      /* 판매유형 */
             , M.PRDT_TYPE /* 제품유형 */
             , M.LCFLG1    /* 기변유형 */
             , M.CNTR_NO   /* 계약상세번호 */
             , M.LCCGUB    /* 고객구분 */
             , M.PD_NM     /* 상품명 */
             , M.PD_CD     /* 상품코드 */
             , M.LCIUSE    /* 용도*/
             , M.LCETC3    /* 할인구분*/
             , M.LCETC4    /* 할인유형*/
             , M.LCST11    /* 할인제도 */
             , M.LCST04    /* 결합구분 */
             , M.FNL_VAL   /* 입금실적 */
             , M.LCMONT    /* 할부 */
             , M.LCBAMT	   /* 기준가격 */
             , M.LCTAMT	   /* 홈케어 */
             , M.LCGUB1	   /* 홈케어멤버십3년 */
             , M.LCST13    /* 정액여부 */
             , M.LEASE_YN  /* 금융리스 */
             , M.LCPCNT	   /* 인정건수*/
             , M.RCNT_YN   /* 재약정여부 */
             , M.LCCRTT	   /* 계약일자*/
             , M.LCSLET	   /* 매출일자 */
             , M.LCCANT    /* 취소일자*/
             , M.AKDBON	   /* 지점장번호 */
             , M.AKDBNM	   /* 지점장성명 */
             , M.LCAMT1	   /* 렌탈료*/
             , M.LCGUB3	   /* 약정기간 */
             , M.LCVMON    /* 관리주기*/
             , M.LCPAMT    /* 인정실적금액 */
             , M.LCCK02	   /* 프로모션번호 */
             , M.LCGSEQ	   /* 패키지 일련번호 */
             , CASE WHEN NVL(MM.BASE_YM,0) = 0 THEN '' ELSE MM.BASE_YM END AS LCPAYM  /*순주문월*/
          FROM ( /* 할부 */
                 SELECT C.DGR1_LEVL_OG_NM AS OG1_NM /* 총괄단 */
                      , C.DGR2_LEVL_OG_NM AS OG2_NM  /* 지역단 */
                      , C.DGR3_LEVL_OG_NM AS OG3_NM  /* 지점 */
                      , A.PRTNR_NO  /* 번호 */
                      , B.PRTNR_KNM  /* 성명 */
                      , '할부' AS GUBN /* 판매유형 */
                      , CASE WHEN D.SELL_TP_DTL_CD = '12' THEN '홈케어'
                             WHEN D.SELL_TP_DTL_CD = '13' THEN '환경가전'
                             ELSE '환경가전외'
                        END AS PRDT_TYPE  /* 제품유형 */
                      , '' AS LCFLG1  /* 기변유형 */
                      , A.CNTR_NO    /* 계약상세번호 */
                      , A.CNTR_SN
                      , CASE WHEN A.LCCGUB = '2' THEN  '사업' ELSE '개인' END AS LCCGUB    /* 고객구분 */
                      , D.PD_NM     /* 상품명 */
                      , D.PD_CD     /* 상품코드 */
                      , '' AS LCIUSE  /* 용도 현재없음 임시처리 */
                      , '' AS LCETC3  /* 할인구분 현재없음 임시처리 */
                      , '' AS LCETC4  /* 할인유형 현재없음 임시처리 */
                      , '' AS LCST11 /* 할인제도 */
                      , '' AS LCST04     /* 결합구분 */
                      , E.FNL_VAL  /* 입금실적 */
                      , A.LCMONT   /* 할부 */
                      , A.LCBAMT	  /* 기준가격 */
                      , A.LCTAMT	  /* 홈케어 */
                      , '' AS LCGUB1	/* 홈케어멤버십3년 */
                      , A.LCST13 /* 정액여부 */
                      , '' AS 	LEASE_YN	/* 금융리스 */
                      , A.LCPCNT	AS LCPCNT	/* 인정건수*/
                      , '' AS 	RCNT_YN	/* 재약정여부 */
                      , A.LCCRTT	            /* 계약일자*/
                      , A.LCSLET	/* 매출일자 */
                      , A.LCCANT 	/* 취소일자*/
                      , C.DGR3_LEVL_DG_PRTNR_NO AS AKDBON	/* 지점장번호 */
                      , C.DGR3_LEVL_DG_PRTNR_NM AS AKDBNM	/* 지점장성명 */
                      , '렌탈료' AS LCAMT1	/* 렌탈료 미정 임시처리*/
                      , 0 AS 	LCGUB3	/* 약정기간 */
                      , A.LCVMON /* 관리주기 미정 임시처리*/
                      , A.LCPAMT   /* 인정실적금액 */
                      , '0' AS 	LCCK02	/* 프로모션번호 */
                      , '' AS 	LCGSEQ	/* 패키지 일련번호 */
                   FROM TB_OGBS_MM_PRTNR_IZ B  /* 월파트너 */
                  INNER JOIN TB_OGBS_MM_OG_IZ C  /* 월조직 */
                     ON B.BASE_YM = C.BASE_YM
                    AND B.OG_ID = C.OG_ID
                  INNER JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY CD.CNTR_NO ORDER BY CD.CNTR_SN DESC) AS RANK
                                    , CD.CNTR_NO
                                    , CD.CNTR_SN
                                    , CB.SELL_PRTNR_NO AS PRTNR_NO
                                    , CB.SELL_OG_TP_CD AS OG_TP_CD
                                    , CB.CNTR_CST_NO AS CST_NO
                                    , CB.COPN_DV_CD AS LCCGUB
                                    , CD.BASE_PD_CD AS PD_CD
                                    , CD.ISTM_MCN AS LCMONT
                                    , CD.ACKMT_PERF_AMT AS LCPAMT
                                    , CD.FEE_ACKMT_BASE_AMT AS LCBAMT
                                    , CD.SELL_AMT AS LCTAMT
                                    , CD.FEE_FXAM_YN AS LCST13
                                    , CD.FEE_ACKMT_CT AS LCPCNT
                                    , CD.CNTR_PD_ENDDT AS LCCANT
                                    , CD.SV_PRD AS LCVMON
                                    , CB.CNTR_CNFM_DTM AS LCCRTT
                                    , CD.CNTR_PD_STRTDT AS LCSLET
                                 FROM TB_SSCT_CNTR_BAS CB
                                INNER JOIN TB_SSCT_CNTR_DTL CD
                                   ON CB.CNTR_NO = CD.CNTR_NO
                                  AND CD.CNTR_PD_STRTDT BETWEEN #{schSlDtStrt} AND  #{schSlDtEnd}
                                WHERE CB.SELL_OG_TP_CD	= 'W01'
                                  AND CD.SELL_TP_CD = '1'  /* 일시불/할부 */
                              <if test="schDv == '예약'">
                                  AND CD.BOO_SELL_TP_CD = '1'
                              </if>
                              <if test="schDv == '매출'">
                                  AND CD.BOO_SELL_TP_CD = '2'
                              </if>
                             )A
                     ON B.PRTNR_NO = A.PRTNR_NO
                    AND B.OG_TP_CD = A.OG_TP_CD
                    AND A.RANK = 1
                  INNER JOIN TB_PDBS_PD_BAS D
                     ON A.PD_CD = D.PD_CD
                <if test="schPdCdStrt != null and schPdCdStrt != ''">
                    AND D.PD_CD &gt;= #{schPdCdStrt}
                </if>
                <if test="schPdCdEnd != null and schPdCdEnd != ''">
                    AND D.PD_CD &lt;=  #{schPdCdEnd}
                </if>
                   LEFT OUTER JOIN TB_SSCT_CNTR_PRC_CMPT_IZ E
                     ON A.CNTR_NO = E.CNTR_NO
                    AND A.CNTR_SN = E.CNTR_SN
                  WHERE B.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
                    AND B.OG_TP_CD	= 'W01'
                 UNION ALL
                 /* 렌탈 */
                 SELECT C.DGR1_LEVL_OG_NM AS OG1_NM /* 총괄단 */
                      , C.DGR2_LEVL_OG_NM AS OG2_NM  /* 지역단 */
                      , C.DGR3_LEVL_OG_NM AS OG3_NM  /* 지점 */
                      , A.PRTNR_NO  /* 번호 */
                      , B.PRTNR_KNM  /* 성명 */
                      , '렌탈' AS GUBN /* 판매유형 */
                      , CASE WHEN D.SELL_TP_DTL_CD = '12' THEN '홈케어'
                             WHEN D.SELL_TP_DTL_CD = '13' THEN '환경가전'
                             ELSE '환경가전외'
                        END AS PRDT_TYPE  /* 제품유형 */
                      , G.MCHN_CH_TP_CD AS LCFLG1       /* 기변유형 */
                      , A.CNTR_NO    /* 계약상세번호 */
                      , A.CNTR_SN
                      , CASE WHEN A.LCCGUB = '2' THEN  '사업' ELSE '개인' END AS LCCGUB    /* 고객구분 */
                      , D.PD_NM     /* 상품명 */
                      , D.PD_CD     /* 상품코드 */
                      , '' AS LCIUSE  /* 용도 현재없음 임시처리 */
                      , '' AS LCETC3  /* 할인구분 현재없음 임시처리 */
                      , '' AS LCETC4  /* 할인유형 현재없음 임시처리 */
                      , '' AS LCST11    /* 할인제도 현재없음 임시처리 */
                      , '' AS  LCST04   /*결합구분 현재없음 임시처리 */
                      , E.FNL_VAL  /* 입금실적 */
                      , A.LCMONT   /* 할부 */
                      , A.LCBAMT	  /* 기준가격 */
                      , A.LCTAMT	  /* 홈케어 */
                      , '' AS LCGUB1	/* 홈케어멤버십3년 */
                      , A.LCST13 /* 정액여부 */
                      , '' AS 	LEASE_YN	/*  할인구분 관련 현재없음 임시처리  */
                      , CASE WHEN NVL(G.OJ_CNTR_NO, 0) > 0 AND G.MCHN_CH_TP_CD IN (1,18) THEN 0
                             ELSE A.LCPCNT
                        END AS LCPCNT   /* 수수료인정건수 */
                      , '' AS 	RCNT_YN	/* 재약정여부 */
                      , A.LCCRTT	            /* 계약일자*/
                      , A.LCSLET	/* 매출일자 */
                      , A.LCCANT 	/* 취소일자*/
                      , C.DGR3_LEVL_DG_PRTNR_NO AS AKDBON	/* 지점장번호 */
                      , C.DGR3_LEVL_DG_PRTNR_NM AS AKDBNM	/* 지점장성명 */
                      , '렌탈료' AS LCAMT1	/* 렌탈료 미정 임시처리*/
                      , H.RECAP_DUTY_PTRM_N AS 	LCGUB3	/* 약정기간 */
                      , A.LCVMON /* 관리주기 미정 임시처리*/
                      , A.LCPAMT   /* 인정실적금액 */
                      , I.PMOT_CD AS 	LCCK02	/* 프로모션번호 */
                      , '' AS LCGSEQ       /*패키지 일련번호 미정 임시처리*/
                   FROM TB_OGBS_MM_PRTNR_IZ B  /* 월파트너 */
                  INNER JOIN TB_OGBS_MM_OG_IZ C  /* 월조직 */
                     ON B.BASE_YM = C.BASE_YM
                    AND B.OG_ID = C.OG_ID
                  INNER JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY CD.CNTR_NO ORDER BY CD.CNTR_SN DESC) AS RANK
                                    , CD.CNTR_NO
                                    , CD.CNTR_SN
                                    , CB.SELL_PRTNR_NO AS PRTNR_NO
                                    , CB.SELL_OG_TP_CD AS OG_TP_CD
                                    , CB.CNTR_CST_NO AS CST_NO
                                    , CB.COPN_DV_CD AS LCCGUB
                                    , CD.BASE_PD_CD AS PD_CD
                                    , CD.ISTM_MCN AS LCMONT
                                    , CD.ACKMT_PERF_AMT AS LCPAMT
                                    , CD.FEE_ACKMT_BASE_AMT AS LCBAMT
                                    , CD.SELL_AMT AS LCTAMT
                                    , CD.FEE_FXAM_YN AS LCST13
                                    , CD.FEE_ACKMT_CT	AS LCPCNT
                                    , CD.CNTR_PD_ENDDT AS LCCANT
                                    , CD.SV_PRD AS LCVMON
                                    , CB.CNTR_CNFM_DTM AS LCCRTT
                                    , CD.CNTR_PD_STRTDT AS LCSLET
                                 FROM TB_SSCT_CNTR_BAS CB
                                INNER JOIN TB_SSCT_CNTR_DTL CD
                                   ON CB.CNTR_NO = CD.CNTR_NO
                                  AND CD.CNTR_PD_STRTDT BETWEEN #{schSlDtStrt} AND  #{schSlDtEnd}
                                  AND CD.SELL_TP_CD = '2'  /* 렌탈/리스 */
                                WHERE CB.SELL_OG_TP_CD	= 'W01'
                              <if test="schDv == '예약'">
                                  AND CD.BOO_SELL_TP_CD = '1'
                              </if>
                              <if test="schDv == '매출'">
                                  AND CD.BOO_SELL_TP_CD = '2'
                              </if>
                             )A
                     ON B.PRTNR_NO = A.PRTNR_NO
                    AND B.OG_TP_CD = A.OG_TP_CD
                    AND A.RANK = 1
                  INNER JOIN TB_PDBS_PD_BAS D
                     ON A.PD_CD = D.PD_CD
                <if test="schPdCdStrt != null and schPdCdStrt != ''">
                    AND D.PD_CD &gt;= #{schPdCdStrt}
                </if>
                <if test="schPdCdEnd != null and schPdCdEnd != ''">
                    AND D.PD_CD &lt;=  #{schPdCdEnd}
                </if>
                   LEFT OUTER JOIN TB_SSCT_CNTR_PRC_CMPT_IZ E
                     ON A.CNTR_NO = E.CNTR_NO
                    AND A.CNTR_SN = E.CNTR_SN
                   LEFT OUTER JOIN TB_SSCT_MCHN_CH_IZ G
                     ON A.CNTR_NO = G.BASE_CNTR_NO
                    AND A.CNTR_SN = G.BASE_CNTR_SN
                   LEFT OUTER JOIN TB_SSCT_CNTR_WELLS_DTL H
                     ON A.CNTR_NO = H.CNTR_NO
                    AND A.CNTR_SN = H.CNTR_SN
                   LEFT OUTER JOIN TB_SSCT_CNTR_PMOT_IZ I
                     ON A.CNTR_NO = I.DTL_CNTR_NO
                    AND A.CNTR_SN = I.DTL_CNTR_SN
                  WHERE B.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
                    AND B.OG_TP_CD	= 'W01'
                    AND NOT EXISTS (SELECT 1 FROM TB_SSCT_MCHN_CH_IZ X WHERE X.BASE_CNTR_NO = A.CNTR_NO AND X.BASE_CNTR_SN = A.CNTR_SN AND X.MCHN_CH_TP_CD IN ('15','16','19'))
                <if test="schDv != '예약'">
                 UNION ALL
                 /* 멤버십 */
                 SELECT C.DGR1_LEVL_OG_NM AS OG1_NM /* 총괄단 */
                      , C.DGR2_LEVL_OG_NM AS OG2_NM  /* 지역단 */
                      , C.DGR3_LEVL_OG_NM AS OG3_NM  /* 지점 */
                      , A.PRTNR_NO  /* 번호 */
                      , B.PRTNR_KNM  /* 성명 */
                      , '멤버십' AS GUBN /* 판매유형 */
                      , CASE WHEN D.SELL_TP_DTL_CD = '12' THEN '홈케어'
                             WHEN D.SELL_TP_DTL_CD = '13' THEN '환경가전'
                             ELSE '환경가전외'
                        END AS PRDT_TYPE  /* 제품유형 */
                      , '' AS LCFLG1       /* 기변유형 */
                      , A.CNTR_NO    /* 계약상세번호 */
                      , A.CNTR_SN
                      , CASE WHEN A.LCCGUB = '2' THEN  '사업' ELSE '개인' END AS LCCGUB    /* 고객구분 */
                      , D.PD_NM     /* 상품명 */
                      , D.PD_CD     /* 상품코드 */
                      , '' AS LCIUSE  /* 용도 현재없음 임시처리 */
                      , '' AS LCETC3  /* 할인구분 현재없음 임시처리 */
                      , '' AS LCETC4  /* 할인유형 현재없음 임시처리 */
                      , '' AS LCST11    /* 할인제도 현재없음 임시처리 */
                      , '' AS LCST04   /*결합구분 현재없음 임시처리 */
                      , 0 AS FNL_VAL  /* 입금실적 */
                      , A.LCMONT   /* 할부 */
                      , A.LCBAMT	  /* 기준가격 */
                      , CASE WHEN D.SELL_TP_DTL_CD = '12' THEN  A.MM_ISTM_AMT ELSE 0 END AS LCTAMT    /* 홈케어 */
                      , CASE WHEN A.LCMONT = 36 THEN 'Y' ELSE ' ' END AS LCGUB1   /* 홈케어멤버십3년 */
                      , '' AS LCST13 /* 정액여부 */
                      , '' AS LEASE_YN	/*  금융리스여부  */
                      , CASE WHEN G.MCHN_CH_TP_CD IN (8,16) THEN A.LCPCNT
                             ELSE 0
                        END AS LCPCNT   /* 수수료인정건수 할인율 관련 미정으로 임시처리 */
                      , '' AS 	RCNT_YN	/* 재약정여부 */
                      , A.LCCRTT	            /* 계약일자*/
                      , A.LCSLET	/* 매출일자 */
                      , A.LCCANT 	/* 취소일자*/
                      , C.DGR3_LEVL_DG_PRTNR_NO AS AKDBON	/* 지점장번호 */
                      , C.DGR3_LEVL_DG_PRTNR_NM AS AKDBNM	/* 지점장성명 */
                      , '0' AS LCAMT1	/* 렌탈료*/
                      , 0 AS 	LCGUB3	/* 약정기간 */
                      , 0 AS 	LCVMON /* 관리주기*/
                      , A.LCPAMT   /* 인정실적금액 */
                      , '0' AS 	LCCK02	/* 프로모션번호 */
                      , '' AS LCGSEQ       /*패키지 일련번호 미정 임시처리*/
                   FROM TB_OGBS_MM_PRTNR_IZ B  /* 월파트너 */
                  INNER JOIN TB_OGBS_MM_OG_IZ C  /* 월조직 */
                     ON B.BASE_YM = C.BASE_YM
                    AND B.OG_ID = C.OG_ID
                  INNER JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY CD.CNTR_NO ORDER BY CD.CNTR_SN DESC) AS RANK
                                    , CD.CNTR_NO
                                    , CD.CNTR_SN
                                    , CB.SELL_PRTNR_NO AS PRTNR_NO
                                    , CB.SELL_OG_TP_CD AS OG_TP_CD
                                    , CB.CNTR_CST_NO AS CST_NO
                                    , CB.COPN_DV_CD AS LCCGUB
                                    , CD.BASE_PD_CD AS PD_CD
                                    , CD.ISTM_MCN AS LCMONT
                                    , CD.ACKMT_PERF_AMT AS LCPAMT
                                    , CD.FEE_ACKMT_BASE_AMT AS LCBAMT
                                    , CD.SELL_AMT AS LCTAMT
                                    , CD.FEE_FXAM_YN AS LCST13
                                    , CD.FEE_ACKMT_CT	AS LCPCNT
                                    , CD.CNTR_PD_ENDDT AS LCCANT
                                    , CD.SV_PRD AS LCVMON
                                    , CB.CNTR_CNFM_DTM AS LCCRTT
                                    , CD.MM_ISTM_AMT
                                    , CD.CNTR_PD_STRTDT AS LCSLET
                                 FROM TB_SSCT_CNTR_BAS CB
                                INNER JOIN TB_SSCT_CNTR_DTL CD
                                   ON CB.CNTR_NO = CD.CNTR_NO
                                  AND CD.CNTR_PD_STRTDT BETWEEN #{schSlDtStrt} AND  #{schSlDtEnd}
                                  AND CD.SELL_TP_CD = '3'  /* 멤버십 */
                                WHERE CB.SELL_OG_TP_CD	= 'W01'
                              <if test="schDv == '매출'">
                                  AND CD.BOO_SELL_TP_CD = '2'
                              </if>
                             )A
                     ON B.PRTNR_NO = A.PRTNR_NO
                    AND B.OG_TP_CD = A.OG_TP_CD
                    AND A.RANK = 1
                  INNER JOIN TB_PDBS_PD_BAS D
                     ON A.PD_CD = D.PD_CD
                <if test="schPdCdStrt != null and schPdCdStrt != ''">
                    AND D.PD_CD &gt;= #{schPdCdStrt}
                </if>
                <if test="schPdCdEnd != null and schPdCdEnd != ''">
                    AND D.PD_CD &lt;=  #{schPdCdEnd}
                </if>
                   LEFT OUTER JOIN TB_SSCT_MCHN_CH_IZ G
                     ON A.CNTR_NO = G.BASE_CNTR_NO
                    AND A.CNTR_SN = G.BASE_CNTR_SN
                  WHERE B.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
                    AND B.OG_TP_CD	= 'W01'
                </if>
                 UNION ALL
                 /* 정기구매 */
                 SELECT C.DGR1_LEVL_OG_NM AS OG1_NM /* 총괄단 */
                      , C.DGR2_LEVL_OG_NM AS OG2_NM  /* 지역단 */
                      , C.DGR3_LEVL_OG_NM AS OG3_NM  /* 지점 */
                      , A.PRTNR_NO  /* 번호 */
                      , B.PRTNR_KNM  /* 성명 */
                      , '정기구매' AS GUBN /* 판매유형 */
                      , CASE WHEN D.SELL_TP_DTL_CD = '62' THEN '웰스팜'
                             WHEN D.SELL_TP_DTL_CD = '63' THEN '캡슐'
                             ELSE '기타'
                        END AS PRDT_TYPE  /* 제품유형 */
                      , '' AS LCFLG1       /* 기변유형 */
                      , A.CNTR_NO    /* 계약상세번호 */
                      , A.CNTR_SN
                      , CASE WHEN A.LCCGUB = '2' THEN  '사업' ELSE '개인' END AS LCCGUB    /* 고객구분 */
                      , D.PD_NM     /* 상품명 */
                      , D.PD_CD     /* 상품코드 */
                      , '' AS LCIUSE  /* 용도 현재없음 임시처리 */
                      , '' AS LCETC3  /* 할인구분 현재없음 임시처리 */
                      , '' AS LCETC4  /* 할인유형 현재없음 임시처리 */
                      , '' AS LCST11    /* 할인제도 */
                      , '' AS LCST04   /*결합구분 */
                      , E.FNL_VAL  /* 입금실적 미정 임시처리*/
                      , A.LCMONT   /* 할부 */
                      , A.LCBAMT	  /* 기준가격 */
                      , CASE WHEN D.SELL_TP_DTL_CD = '12' THEN  A.LCTAMT - A.LCRAMT  ELSE 0 END AS LCTAMT    /* 홈케어 */
                      , '' AS LCGUB1   /* 홈케어멤버십3년 */
                      , A.LCST13 /* 정액여부 */
                      , '' AS LEASE_YN	/*  금융리스여부  */
                      , A.LCPCNT         /* 수수료인정건수 할인율 관련 미정으로 임시처리 */
                      , ' ' AS 	RCNT_YN	/* 재약정여부 */
                      , A.LCCRTT	            /* 계약일자*/
                      , A.LCSLET	/* 매출일자 */
                      , A.LCCANT 	/* 취소일자*/
                      , C.DGR3_LEVL_DG_PRTNR_NO AS AKDBON	/* 지점장번호 */
                      , C.DGR3_LEVL_DG_PRTNR_NM AS AKDBNM	/* 지점장성명 */
                      , TO_CHAR((A.LCTAMT - A.LCRAMT) / A.LCVMON) AS LCAMT1          /* 렌탈료 */
                      , H.RECAP_DUTY_PTRM_N AS 	LCGUB3	/* 약정기간 */
                      , 0 AS 	LCVMON /* 관리주기*/
                      , A.LCPAMT   /* 인정실적금액 */
                      , '0' AS 	LCCK02	/* 프로모션번호 */
                      , '' AS LCGSEQ       /*패키지 일련번호 미정 임시처리*/
                   FROM TB_OGBS_MM_PRTNR_IZ B  /* 월파트너 */
                  INNER JOIN TB_OGBS_MM_OG_IZ C  /* 월조직 */
                     ON B.BASE_YM = C.BASE_YM
                    AND B.OG_ID = C.OG_ID
                  INNER JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY CD.CNTR_NO ORDER BY CD.CNTR_SN DESC) AS RANK
                                    , CD.CNTR_NO
                                    , CD.CNTR_SN
                                    , CB.SELL_PRTNR_NO AS PRTNR_NO
                                    , CB.SELL_OG_TP_CD AS OG_TP_CD
                                    , CB.CNTR_CST_NO AS CST_NO
                                    , CB.COPN_DV_CD AS LCCGUB
                                    , CD.BASE_PD_CD AS PD_CD
                                    , CD.STPL_PTRM AS LCMONT
                                    , CD.ACKMT_PERF_AMT AS LCPAMT
                                    , CD.FEE_ACKMT_BASE_AMT AS LCBAMT
                                    , CD.SELL_AMT AS LCTAMT
                                    , CD.FEE_FXAM_YN AS LCST13
                                    , CD.FEE_ACKMT_CT	AS LCPCNT
                                    , CD.CNTR_PD_ENDDT AS LCCANT
                                    , CD.SV_PRD AS LCVMON
                                    , CB.CNTR_CNFM_DTM AS LCCRTT
                                    , CD.DSC_AMT AS LCRAMT
                                    , CD.CNTR_PD_STRTDT AS LCSLET
                                 FROM TB_SSCT_CNTR_BAS CB
                                INNER JOIN TB_SSCT_CNTR_DTL CD
                                   ON CB.CNTR_NO = CD.CNTR_NO
                                  AND CD.CNTR_PD_STRTDT BETWEEN #{schSlDtStrt} AND  #{schSlDtEnd}
                                  AND CD.SELL_TP_CD = '6'  /* 정기배송 */
                                WHERE CB.SELL_OG_TP_CD	= 'W01'
                              <if test="schDv == '예약'">
                                  AND CD.BOO_SELL_TP_CD = '1'
                              </if>
                              <if test="schDv == '매출'">
                                  AND CD.BOO_SELL_TP_CD = '2'
                              </if>
                             )A
                     ON B.PRTNR_NO = A.PRTNR_NO
                    AND B.OG_TP_CD = A.OG_TP_CD
                    AND A.RANK = 1
                  INNER JOIN TB_PDBS_PD_BAS D
                     ON A.PD_CD = D.PD_CD
                <if test="schPdCdStrt != null and schPdCdStrt != ''">
                    AND D.PD_CD &gt;= #{schPdCdStrt}
                </if>
                <if test="schPdCdEnd != null and schPdCdEnd != ''">
                    AND D.PD_CD &lt;=  #{schPdCdEnd}
                </if>
                   LEFT OUTER JOIN TB_SSCT_CNTR_PRC_CMPT_IZ E
                     ON A.CNTR_NO = E.CNTR_NO
                    AND A.CNTR_SN = E.CNTR_SN
                   LEFT OUTER JOIN TB_SSCT_CNTR_WELLS_DTL H
                     ON A.CNTR_NO = H.CNTR_NO
                    AND A.CNTR_SN = H.CNTR_SN
                  WHERE B.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
                    AND B.OG_TP_CD	= 'W01'
                <if test="schDv != '예약'">
                 UNION ALL
                 /* 재렌탈 */
                 SELECT C.DGR1_LEVL_OG_NM AS OG1_NM /* 총괄단 */
                      , C.DGR2_LEVL_OG_NM AS OG2_NM  /* 지역단 */
                      , C.DGR3_LEVL_OG_NM AS OG3_NM  /* 지점 */
                      , A.PRTNR_NO  /* 번호 */
                      , B.PRTNR_KNM  /* 성명 */
                      , '재렌탈' AS GUBN /* 판매유형 */
                      , '환경가전' AS PRDT_TYPE  /* 제품유형 */
                      , '' AS LCFLG1       /* 기변유형 */
                      , A.CNTR_NO    /* 계약상세번호 */
                      , A.CNTR_SN
                      , CASE WHEN A.LCCGUB = '2' THEN  '사업' ELSE '개인' END AS LCCGUB  /* 고객구분 */
                      , D.PD_NM     /* 상품명 */
                      , D.PD_CD     /* 상품코드 */
                      , '' AS LCIUSE  /* 용도 */
                      , '' AS LCETC3  /* 할인구분 현재없음 임시처리 */
                      , '' AS LCETC4  /* 할인유형 현재없음 임시처리 */
                      , '' AS LCST11    /* 할인제도 */
                      , '' AS LCST04   /*결합구분 */
                      , E.FNL_VAL  /* 입금실적 */
                      , A.LCMONT   /* 할부 */
                      , 0 AS LCBAMT	  /* 기준가격 */
                      , 0 AS LCTAMT    /* 홈케어 */
                      , '' AS LCGUB1   /* 홈케어멤버십3년 */
                      , '' AS LCST13 /* 정액여부 */
                      , '' AS LEASE_YN	/*  금융리스여부  */
                      , CASE WHEN NVL(LENGTH(G.OJ_CNTR_NO), 0) > 0 AND G.MCHN_CH_TP_CD IN ('1','18') THEN 0
                             ELSE A.LCPCNT
                        END AS LCPCNT   /* 수수료인정건수 */
                      , 'Y' AS 	RCNT_YN	/* 재약정여부 */
                      , A.LCCRTT	            /* 계약일자*/
                      , A.LCSLET	/* 매출일자 */
                      , A.LCCANT 	/* 취소일자*/
                      , C.DGR3_LEVL_DG_PRTNR_NO AS AKDBON	/* 지점장번호 */
                      , C.DGR3_LEVL_DG_PRTNR_NM AS AKDBNM	/* 지점장성명 */
                      , '0' AS LCAMT1          /* 렌탈료 */
                      , H.RECAP_DUTY_PTRM_N AS 	LCGUB3	/* 약정기간 */
                      , 0 AS 	LCVMON /* 관리주기*/
                      , A.LCPAMT   /* 인정실적금액 */
                      , '0' AS 	LCCK02	/* 프로모션번호 */
                      , '' AS LCGSEQ       /*패키지 일련번호 미정 임시처리*/
                   FROM TB_OGBS_MM_PRTNR_IZ B  /* 월파트너 */
                  INNER JOIN TB_OGBS_MM_OG_IZ C  /* 월조직 */
                     ON B.BASE_YM = C.BASE_YM
                    AND B.OG_ID = C.OG_ID
                  INNER JOIN ( SELECT ROW_NUMBER() OVER (PARTITION BY CD.CNTR_NO ORDER BY CD.CNTR_SN DESC) AS RANK
                                    , CD.CNTR_NO
                                    , CD.CNTR_SN
                                    , CB.SELL_PRTNR_NO AS PRTNR_NO
                                    , CB.SELL_OG_TP_CD AS OG_TP_CD
                                    , CB.CNTR_CST_NO AS CST_NO
                                    , CB.COPN_DV_CD AS LCCGUB
                                    , CD.BASE_PD_CD AS PD_CD
                                    , CD.ISTM_MCN AS LCMONT
                                    , CD.ACKMT_PERF_AMT AS LCPAMT
                                    , CD.FEE_ACKMT_BASE_AMT AS LCBAMT
                                    , CD.SELL_AMT AS LCTAMT
                                    , CD.FEE_FXAM_YN AS LCST13
                                    , CD.FEE_ACKMT_CT	AS LCPCNT
                                    , CD.CNTR_PD_ENDDT AS LCCANT
                                    , CD.SV_PRD AS LCVMON
                                    , CB.CNTR_CNFM_DTM AS LCCRTT
                                    , CD.CNTR_PD_STRTDT AS LCSLET
                                 FROM TB_SSCT_CNTR_BAS CB
                                INNER JOIN TB_SSCT_CNTR_DTL CD
                                   ON CB.CNTR_NO = CD.CNTR_NO
                                  AND CD.CNTR_PD_STRTDT BETWEEN #{schSlDtStrt} AND  #{schSlDtEnd}
                                  AND CD.SELL_TP_CD = '2'  /* 렌탈/리스 */
                                WHERE CB.SELL_OG_TP_CD	= 'W01'
                              <if test="schDv == '매출'">
                                  AND CD.BOO_SELL_TP_CD = '2'
                              </if>
                             )A
                     ON B.PRTNR_NO = A.PRTNR_NO
                    AND B.OG_TP_CD = A.OG_TP_CD
                    AND A.RANK = 1
                  INNER JOIN TB_PDBS_PD_BAS D
                     ON A.PD_CD = D.PD_CD
                <if test="schPdCdStrt != null and schPdCdStrt != ''">
                    AND D.PD_CD &gt;= #{schPdCdStrt}
                </if>
                <if test="schPdCdEnd != null and schPdCdEnd != ''">
                    AND D.PD_CD &lt;=  #{schPdCdEnd}
                </if>
                   LEFT OUTER JOIN TB_SSCT_CNTR_PRC_CMPT_IZ E
                     ON A.CNTR_NO = E.CNTR_NO
                    AND A.CNTR_SN = E.CNTR_SN
                   LEFT OUTER JOIN TB_SSCT_MCHN_CH_IZ G
                     ON A.CNTR_NO = G.BASE_CNTR_NO
                    AND A.CNTR_SN = G.BASE_CNTR_SN
                   LEFT OUTER JOIN TB_SSCT_CNTR_WELLS_DTL H
                     ON A.CNTR_NO = H.CNTR_NO
                    AND A.CNTR_SN = H.CNTR_SN
                  WHERE B.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
                    AND B.OG_TP_CD	= 'W01'
                    AND EXISTS (SELECT 1 FROM TB_SSCT_MCHN_CH_IZ X WHERE X.BASE_CNTR_NO = A.CNTR_NO AND X.BASE_CNTR_SN = A.CNTR_SN AND X.MCHN_CH_TP_CD IN ('15','16','19'))
                </if>
               )M
          LEFT JOIN TB_FEAM_WELS_NRCTR_MM_CL MM
            ON M.CNTR_NO = MM.CNTR_NO
           AND M.CNTR_SN = MM.CNTR_SN
           AND MM.OG_TP_CD = 'W01'
           AND MM.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
           AND MM.FEE_TCNT_DV_CD = '02'  /*2차*/
           AND MM.CNTR_PERF_CRT_DV_CD = '01'  /*순주문 집계*/
       <if test="schPdctTp != '전체'">
         WHERE M.PRDT_TYPE = #{schPdctTp}
       </if>
    </select>

    <select id='selectPlannerSellFees'
            resultType="com.kyowon.sms.wells.web.fee.aggregate.dto.WfeaOrganizationNetOrderDto$SearchPlarSellFeeRes">
        SELECT C.DGR1_LEVL_OG_NM AS OG1_NM /* 총괄단 */
             , C.DGR2_LEVL_OG_NM AS OG2_NM  /* 지역단 */
             , C.DGR3_LEVL_OG_NM AS OG3_NM  /* 지점 */
             , A.PRTNR_NO  /* 번호 */
             , B.PRTNR_KNM  /* 성명 */
             , A.CNTR_NO    /* 계약상세번호 */
             , A.RCPDT /*접수일자*/
             , A.SL_DT /*매출일자*/
             , A.CAN_DT /*취소일자*/
             , '환경가전외' AS PRDTYP/*제품유형*/
             , A.PD_CD /*상품코드*/
             , '' AS PRDGRP/*상품그룹*/
             , D.PD_NM /*상품명*/
             , A.ACKMT_PERF_CT   /*인정건수*/
             , A.BFSVC_PRD_CD    /*BS주기*/
             , E.CD_CNTN AS MCHN_CH_TP_CD   /*기변유형*/
          FROM TB_FEAM_WELS_NRCTR_MM_CL A
         INNER JOIN TB_OGBS_MM_PRTNR_IZ B  /* 월파트너 */
            ON A.BASE_YM = B.BASE_YM
           AND A.OG_TP_CD = B.OG_TP_CD
         INNER JOIN TB_OGBS_MM_OG_IZ C  /* 월조직 */
            ON B.BASE_YM = C.BASE_YM
           AND B.OG_ID = C.OG_ID
         INNER JOIN TB_PDBS_PD_BAS D
            ON A.PD_CD = D.PD_CD
          LEFT OUTER JOIN T_CMZ_CD_D E
            ON A.MCHN_CH_TP_CD = E.CD_VLD_VAL
           AND E.TENANT_ID = 'TNT_WELLS'
           AND E.CD_ID = 'MCHN_CH_TP_CD'
         WHERE A.BASE_YM = SUBSTR(#{schSlDtStrt},0,6)
           AND A.FEE_TCNT_DV_CD = '02'  /*2차*/
           AND A.CNTR_PERF_CRT_DV_CD = '01'  /*순주문 집계*/
        <if test="schPdCdStrt != null and schPdCdStrt != ''">
            AND A.PD_CD &gt;= #{schPdCdStrt}
        </if>
        <if test="schPdCdEnd != null and schPdCdEnd != ''">
            AND A.PD_CD &lt;=  #{schPdCdEnd}
        </if>
        <if test="schPdctTp != '전체' or schPdctTp != '환경가전외'">
           AND 1 = 2
       </if>
    </select>

</mapper>
