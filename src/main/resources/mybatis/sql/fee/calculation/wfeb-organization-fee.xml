<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyowon.sms.wells.web.fee.calculation.mapper.WfebOrganizationFeeMapper">

    <select id='selectHomeMasterFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchHmstRes">
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , #{perfYm} AS COL4
        , #{rsbDv} AS COL5
        , #{ogLevl1} AS COL6
        , #{ogLevl2} AS COL7
        , #{ogLevl3} AS COL8
        , #{no} AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        FROM DUAL
    </select>


    <select id='selectHomeMasterBranchManagerFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchHmstBrmgrRes">
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , #{perfYm} AS COL4
        , #{rsbDv} AS COL5
        , #{ogLevl1} AS COL6
        , #{ogLevl2} AS COL7
        , #{ogLevl3} AS COL8
        , #{no} AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        FROM DUAL
        UNION ALL
        SELECT 'OO총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        FROM DUAL
    </select>


    <select id='selectManagerFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchMngerRes">
        SELECT 'O1총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , #{perfYm} AS COL4
        , #{rsbTp} AS COL5
        , #{no} AS COL6
        , #{blgCd} AS COL7
        , '9123' AS COL8
        , '9423' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        , '2022-11' AS COL53
        , '2022-11' AS COL54
        , '2022-11' AS COL55
        , '2022-11' AS COL56
        , '2022-11' AS COL57
        , '2022-11' AS COL58
        , '2022-11' AS COL59
        , '2022-11' AS COL60
        , '2022-11' AS COL61
        , '2022-11' AS COL62
        , '2022-11' AS COL63
        , '2022-11' AS COL64
        , '2022-11' AS COL65
        , '2022-11' AS COL66
        , '2022-11' AS COL67
        , '2022-11' AS COL68
        , '2022-11' AS COL69
        , '2022-11' AS COL70
        , '2022-11' AS COL71
        , '2022-11' AS COL72
        , '2022-11' AS COL73
        , '2022-11' AS COL74
        , '2022-11' AS COL75
        , '2022-11' AS COL76
        , '2022-11' AS COL77
        , '2022-11' AS COL78
        , '2022-11' AS COL79
        , '2022-11' AS COL80
        FROM DUAL
        UNION ALL
        SELECT 'O1총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        , '2022-11' AS COL53
        , '2022-11' AS COL54
        , '2022-11' AS COL55
        , '2022-11' AS COL56
        , '2022-11' AS COL57
        , '2022-11' AS COL58
        , '2022-11' AS COL59
        , '2022-11' AS COL60
        , '2022-11' AS COL61
        , '2022-11' AS COL62
        , '2022-11' AS COL63
        , '2022-11' AS COL64
        , '2022-11' AS COL65
        , '2022-11' AS COL66
        , '2022-11' AS COL67
        , '2022-11' AS COL68
        , '2022-11' AS COL69
        , '2022-11' AS COL70
        , '2022-11' AS COL71
        , '2022-11' AS COL72
        , '2022-11' AS COL73
        , '2022-11' AS COL74
        , '2022-11' AS COL75
        , '2022-11' AS COL76
        , '2022-11' AS COL77
        , '2022-11' AS COL78
        , '2022-11' AS COL79
        , '2022-11' AS COL80
        FROM DUAL
    </select>

    <select id='selectManagerBranchManagerFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchMngerBrmgrRes">
        SELECT 'O2총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , #{perfYm} AS COL4
        , #{rsbTp} AS COL5
        , #{no} AS COL6
        , #{blgCd} AS COL7
        , '9123' AS COL8
        , '9423' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        , '2022-11' AS COL53
        , '2022-11' AS COL54
        , '2022-11' AS COL55
        , '2022-11' AS COL56
        , '2022-11' AS COL57
        , '2022-11' AS COL58
        , '2022-11' AS COL59
        , '2022-11' AS COL60
        , '2022-11' AS COL61
        , '2022-11' AS COL62
        , '2022-11' AS COL63
        , '2022-11' AS COL64
        , '2022-11' AS COL65
        , '2022-11' AS COL66
        , '2022-11' AS COL67
        , '2022-11' AS COL68
        , '2022-11' AS COL69
        , '2022-11' AS COL70
        , '2022-11' AS COL71
        , '2022-11' AS COL72
        , '2022-11' AS COL73
        , '2022-11' AS COL74
        , '2022-11' AS COL75
        , '2022-11' AS COL76
        , '2022-11' AS COL77
        , '2022-11' AS COL78
        , '2022-11' AS COL79
        FROM DUAL
        UNION ALL
        SELECT 'O2총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        , '2022-11' AS COL53
        , '2022-11' AS COL54
        , '2022-11' AS COL55
        , '2022-11' AS COL56
        , '2022-11' AS COL57
        , '2022-11' AS COL58
        , '2022-11' AS COL59
        , '2022-11' AS COL60
        , '2022-11' AS COL61
        , '2022-11' AS COL62
        , '2022-11' AS COL63
        , '2022-11' AS COL64
        , '2022-11' AS COL65
        , '2022-11' AS COL66
        , '2022-11' AS COL67
        , '2022-11' AS COL68
        , '2022-11' AS COL69
        , '2022-11' AS COL70
        , '2022-11' AS COL71
        , '2022-11' AS COL72
        , '2022-11' AS COL73
        , '2022-11' AS COL74
        , '2022-11' AS COL75
        , '2022-11' AS COL76
        , '2022-11' AS COL77
        , '2022-11' AS COL78
        , '2022-11' AS COL79
        FROM DUAL
    </select>

    <select id='selectManagerTotalFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchMngerTotalRes">
        SELECT 'O3총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , #{perfYm} AS COL4
        , #{rsbTp} AS COL5
        , #{no} AS COL6
        , #{blgCd} AS COL7
        , '9123' AS COL8
        , '9423' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        , '2022-11' AS COL53
        , '2022-11' AS COL54
        , '2022-11' AS COL55
        , '2022-11' AS COL56
        , '2022-11' AS COL57
        , '2022-11' AS COL58
        , '2022-11' AS COL59
        , '2022-11' AS COL60
        , '2022-11' AS COL61
        , '2022-11' AS COL62
        , '2022-11' AS COL63
        , '2022-11' AS COL64
        , '2022-11' AS COL65
        , '2022-11' AS COL66
        , '2022-11' AS COL67
        , '2022-11' AS COL68
        , '2022-11' AS COL69
        , '2022-11' AS COL70
        , '2022-11' AS COL71
        , '2022-11' AS COL72
        , '2022-11' AS COL73
        , '2022-11' AS COL74
        , '2022-11' AS COL75
        , '2022-11' AS COL76
        , '2022-11' AS COL77
        , '2022-11' AS COL78
        , '2022-11' AS COL79
        , '2022-11' AS COL80
        , '2022-11' AS COL81
        , '2022-11' AS COL82
        , '2022-11' AS COL83
        , '2022-11' AS COL84
        , '2022-11' AS COL85
        , '2022-11' AS COL86
        , '2022-11' AS COL87
        , '2022-11' AS COL88
        FROM DUAL
        UNION ALL
        SELECT 'O3총괄' AS COL1
        , 'OO지역' AS COL2
        , '김웰스 지점' AS COL3
        , '123456' AS COL4
        , '김교원' AS COL5
        , '렌탈' AS COL6
        , '환경가전' AS COL7
        , '-' AS COL8
        , '2022-1234567-12' AS COL9
        , '개인' AS COL10
        , '2구 포터블 인덕션' AS COL11
        , '1234' AS COL12
        , '1-일시불' AS COL13
        , '1-정상가' AS COL14
        , '3-3년' AS COL15
        , '82' AS COL16
        , 'A-전체' AS COL17
        , '123,456' AS COL18
        , '36' AS COL19
        , '12,345' AS COL20
        , '0' AS COL21
        , '-' AS COL22
        , '-' AS COL23
        , '-' AS COL24
        , '1' AS COL25
        , '-' AS COL26
        , '2022-10-14' AS COL27
        , '2022-10-20' AS COL28
        , '2022-10-20' AS COL29
        , '1234567' AS COL30
        , '김지점' AS COL31
        , '12,345' AS COL32
        , '12' AS COL33
        , '0' AS COL34
        , '123,456' AS COL35
        , '1,234' AS COL36
        , '-' AS COL37
        , '2022-10' AS COL38
        , '2022-11' AS COL39
        , '2022-11' AS COL40
        , '2022-11' AS COL41
        , '2022-11' AS COL42
        , '2022-11' AS COL43
        , '2022-11' AS COL44
        , '2022-11' AS COL45
        , '2022-11' AS COL46
        , '2022-11' AS COL47
        , '2022-11' AS COL48
        , '2022-11' AS COL49
        , '2022-11' AS COL50
        , '2022-11' AS COL51
        , '2022-11' AS COL52
        , '2022-11' AS COL53
        , '2022-11' AS COL54
        , '2022-11' AS COL55
        , '2022-11' AS COL56
        , '2022-11' AS COL57
        , '2022-11' AS COL58
        , '2022-11' AS COL59
        , '2022-11' AS COL60
        , '2022-11' AS COL61
        , '2022-11' AS COL62
        , '2022-11' AS COL63
        , '2022-11' AS COL64
        , '2022-11' AS COL65
        , '2022-11' AS COL66
        , '2022-11' AS COL67
        , '2022-11' AS COL68
        , '2022-11' AS COL69
        , '2022-11' AS COL70
        , '2022-11' AS COL71
        , '2022-11' AS COL72
        , '2022-11' AS COL73
        , '2022-11' AS COL74
        , '2022-11' AS COL75
        , '2022-11' AS COL76
        , '2022-11' AS COL77
        , '2022-11' AS COL78
        , '2022-11' AS COL79
        , '2022-11' AS COL80
        , '2022-11' AS COL81
        , '2022-11' AS COL82
        , '2022-11' AS COL83
        , '2022-11' AS COL84
        , '2022-11' AS COL85
        , '2022-11' AS COL86
        , '2022-11' AS COL87
        , '2022-11' AS COL88
        FROM DUAL
    </select>

    <select id='selectPlannerFees' resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchPlarRes">
        SELECT A.OG_NM  /*소속*/
             , A.PRTNR_NO /*번호*/
             , A.PRTNR_KNM /*성명*/
             , A.RSB_DV_CD /*직책*/
             , NVL(PM.PERF_VAL,0) AS AKCUIL     /*미팅일수*/
             , CASE WHEN A.PSTN_DV_CD = 15 AND NVL(A.QLF_DV_CD , '2') = '2' THEN '플래너'
                    WHEN A.PSTN_DV_CD = 15 AND NVL(A.QLF_DV_CD , '2') = '1' THEN '수석플래너'
                    WHEN A.PSTN_DV_CD = 7 THEN '지점장'
                    ELSE ''
                END AS JAGYUK       /*수수료월 자격*/
             , CASE WHEN F.PRTNR_NO IS NOT NULL THEN
                         CASE WHEN F.PSTN_DV_CD = 15 AND NVL(F.QLF_DV_CD , '2') = '2' THEN '플래너'
                              WHEN F.PSTN_DV_CD = 15 AND NVL(F.QLF_DV_CD , '2') = '1' THEN '수석플래너'
                              WHEN F.PSTN_DV_CD = 7 THEN '지점장'
                         END
                    ELSE '해약'
               END AS N_JAGYUK1               /* 자격(M+1)   */
             , 0 AS IS11EDU               /* AL9300P TO_BE 테이블 없음 임시! 플래너스타트업 */
             , 0 AS IS17EDU               /* AL9300P TO_BE 테이블 없음 임시! 수석(플래너)실전 */
             , A.CNTR_DT /*등록기준월*/
             , A.FST_CNTR_DT /*최초업무등록월*/
             , A.RCNTR_DT /*재등록월*/
             , A.FNL_CLTN_DT /*최종해약월*/
             , A.CLTN_DT /*업무해약월*/
             , TO_CHAR(A.PRFMT_DT,'YYYYMM' ) AS AKSTYM  /*승진월*/
             , A.FST_CNTR_DT AS LCECAYMD /*웰스매니저 개시일 LC1700P 정리되지 않아 임시처리 */
             , MM.B_AKSD05 /*정착수수료 = 이전 정착수수료*/
             , NVL(B.AKCDA0,0) AS AKCDA0  /* 가전    */
             , NVL(B.AKCDA1,0) AS AKCDA1  /* 가전외    */
             , NVL(B.AKCDA2,0) AS AKCDA2  /* 기변    */
             , NVL(EE.P_CNT, 0)  AS AKSQ01              /* 당월 상조  */
             , NVL(EE.G_CNT, 0)  AS N_AKSQ01             /* 상조 유지  */
             , NVL(B.AKCDA3,0) AS AKCDA3  /* 환경(정액)  */
             , NVL(B.AKCDA4,0) AS AKCDA4  /* 환경외(정액)  */
             , NVL(B.AKDEQ5,0) AS AKDEQ5  /* 라이브팩 건수 */
             , NVL(B.EC5AMT,0) AS EC5AMT  /* 홈케어 판매가 */
             , NVL(B.MPRODUCT,0) AS MPRODUCT /* 관리상품 판매건수 */
             , D.AKSD23  /* 정액 수당  */
             , D.AKSD24  /* 라이브팩 수당 */
             , D.AKSD25  /* 홈케어 수장  */
             , D.AKSD01  /* 개인비례 가전 */
             , D.AKSD02  /* 개인비례 가전외 */
             , D.AKSD03  /* 개인 판매장려 */
             , D.AKSD21  /* 개인상조   */
             , D.AKSD04  /* 미팅    */
             , D.AKSD05  /* 정착    */
             , D.AKSD20  /* 재지급    */
             , D.AKSD30  /* 기타지원  */
             , NVL(C.DSB_OJ_AMT,0) AS AKSD99 /* 과표합계 */
          FROM TB_OGBS_MM_PRTNR_IZ A
         INNER JOIN TB_OGBS_MM_OG_IZ O
            ON A.BASE_YM = O.BASE_YM
           AND A.OG_ID = O.OG_ID
        <if test="ogLevl1 != null and ogLevl1 != ''">
           AND B.DGR1_LEVL_OG_ID = #{ogLevl1}
        </if>
        <if test="ogLevl2 != null and ogLevl2 != ''">
           AND B.DGR2_LEVL_OG_ID = #{ogLevl2}
        </if>
        <if test="ogLevl3 != null and ogLevl3 != ''">
           AND B.DGR3_LEVL_OG_ID = #{ogLevl3}
        </if>
          LEFT OUTER JOIN ( SELECT M.PRTNR_NO
                                 , M.OG_TP_CD
                                 , SUM(AKCDA0) AS AKCDA0
                                 , SUM(AKCDA1) AS AKCDA1
                                 , SUM(AKCDA2) AS AKCDA2
                                 , SUM(AKCDA3) AS AKCDA3
                                 , SUM(AKCDA4) AS AKCDA4
                                 , SUM(AKDEQ5) AS AKDEQ5
                                 , SUM(EC5AMT) AS EC5AMT
                                 , SUM(MPRODUCT) AS MPRODUCT
                              FROM ( SELECT AK17.PRTNR_NO
                                          , AK17.OG_TP_CD
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00001' THEN PERF_VAL END AS AKCDA0   /* 가전    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00004' THEN PERF_VAL END AS AKCDA1   /* 가전외    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00028' THEN PERF_VAL END AS AKCDA2   /* 기변    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00029' THEN PERF_VAL END AS AKCDA3   /* 환경(정액)  */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00030' THEN PERF_VAL END AS AKCDA4   /* 환경외(정액)  */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00009' THEN PERF_VAL END AS AKDEQ5   /* 라이브팩 건수 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00016' THEN PERF_VAL END AS EC5AMT   /* 홈케어 판매가 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00018' THEN PERF_VAL END AS MPRODUCT   /* 관리상품 판매건수 */
                                       FROM TB_FEAM_NTORP_PERF_MM_CL AK17   /*순주문 파트너 실적 월마감*/
                                      WHERE AK17.FEE_TCNT_DV_CD = '01'
                                        AND AK17.BASE_YM = #{perfYm}
                                        AND AK17.PERF_DV_CD = 0   /*개인판매*/
                                    <if test="no != null and no != ''">
                                        AND AK17.PRTNR_NO = #{no}
                                    </if>
                                         AND AK17.OG_TP_CD = 'W01'  /*웰스 P조직*/
                                    )M
                             GROUP BY M.PRTNR_NO, M.OG_TP_CD
                           )B
            ON A.PRTNR_NO = B.PRTNR_NO
           AND A.OG_TP_CD = B.OG_TP_CD
          LEFT OUTER JOIN TB_FEAM_PRTNR_PERF_MM_CL PM
            ON A.PRTNR_NO = PM.PRTNR_NO
           AND A.OG_TP_CD = PM.OG_TP_CD
           AND A.BASE_YM = PM.BASE_YM
           AND PM.FEE_TCNT_DV_CD = '01'
           AND PM.PERF_ATC_CD = 'W01R00012'    /*현재미팅건수 코드미정 임시코드*/
           AND PM.PERF_AGRG_CRT_DV_CD = '101'  /*P추진단순주문실적생성*/
          LEFT OUTER JOIN TB_FEAM_FEE_DSB_IZ C
            ON A.PRTNR_NO = C.PRTNR_NO
           AND A.BASE_YM = C.DSB_YM
           AND A.OG_TP_CD = C.OG_TP_CD
           AND C.FEE_TCNT_DV_CD = '01'
          LEFT OUTER JOIN ( SELECT PRTNR_NO
                                 , DSB_YM
                                 , CO_CD
                                 , OG_TP_CD
                                 , FEE_TCNT_DV_CD
                                 , SPMT_DSB_DV_CD
                                 , NVL(SUM(AKSD01),0) AS AKSD01  /* 개인비례 가전 */
                                 , NVL(SUM(AKSD02),0) AS AKSD02 /* 개인비례 가전외 */
                                 , NVL(SUM(AKSD03),0) AS AKSD03  /* 개인 판매장려 */
                                 , NVL(SUM(AKSD21),0) AS AKSD21  /* 개인상조   */
                                 , NVL(SUM(AKSD04),0) AS AKSD04  /* 미팅    */
                                 , NVL(SUM(AKSD05),0) AS AKSD05  /* 정착    */
                                 , NVL(SUM(AKSD20),0) AS AKSD20  /* 재지급    */
                                 , NVL(SUM(AKSD30),0) AS AKSD30  /* 기타수수료  */
                                 , NVL(SUM(AKSD23),0) AS AKSD23  /* 정액 수당  */
                                 , NVL(SUM(AKSD24),0) AS AKSD24  /* 라이브팩 수당 */
                                 , NVL(SUM(AKSD25),0) AS AKSD25  /* 홈케어 수장  */
                              FROM ( SELECT PRTNR_NO
                                          , DSB_YM
                                          , CO_CD
                                          , OG_TP_CD
                                          , FEE_TCNT_DV_CD
                                          , SPMT_DSB_DV_CD
                                          , CASE WHEN (FEE_CD = 'W010001' OR FEE_CD = 'W010101') THEN FEE_ATC_VAL ELSE 0 END AS AKSD01  /* 개인비례 가전 */
                                          , CASE WHEN (FEE_CD = 'W010002' OR FEE_CD = 'W010102') THEN FEE_ATC_VAL ELSE 0 END AS AKSD02  /* 개인비례 가전외 */
                                          , CASE WHEN (FEE_CD = 'W010003' OR FEE_CD = 'W010103') THEN FEE_ATC_VAL ELSE 0 END AS AKSD03  /* 개인 판매장려 */
                                          , CASE WHEN (FEE_CD = 'W010021' OR FEE_CD = 'W010021') THEN FEE_ATC_VAL ELSE 0 END AS AKSD21  /* 개인상조   */
                                          , CASE WHEN FEE_CD = 'W010004' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD04                         /* 미팅    */
                                          , CASE WHEN (FEE_CD = 'W010005' OR FEE_CD = 'W010105') THEN FEE_ATC_VAL ELSE 0 END AS AKSD05  /* 정착    */
                                          , CASE WHEN (FEE_CD = 'W010020' OR FEE_CD = 'W010120') THEN FEE_ATC_VAL ELSE 0 END AS AKSD20  /* 재지급    */
                                          , CASE WHEN (FEE_CD = 'W010030' OR FEE_CD = 'W010130') THEN FEE_ATC_VAL ELSE 0 END AS AKSD30  /* 기타수수료  */
                                          , CASE WHEN (FEE_CD = 'W010023' OR FEE_CD = 'W010123') THEN FEE_ATC_VAL ELSE 0 END AS AKSD23  /* 정액 수당  */
                                          , CASE WHEN (FEE_CD = 'W010024' OR FEE_CD = 'W010124') THEN FEE_ATC_VAL ELSE 0 END AS AKSD24  /* 라이브팩 수당 */
                                          , CASE WHEN (FEE_CD = 'W010025' OR FEE_CD = 'W010125') THEN FEE_ATC_VAL ELSE 0 END AS AKSD25  /* 홈케어 수장  */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM = #{perfYm}
                                        AND OG_TP_CD = 'W01'
                                        AND FEE_TCNT_DV_CD = '01'  --차수구분
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W010001', 'W010101', 'W010002', 'W010102', 'W010003', 'W010103', 'W010021', 'W010121'
                                                     , 'W010004', 'W010005', 'W010105', 'W010020', 'W010120', 'W010030', 'W010130', 'W010023'
                                                     , 'W010123', 'W010024', 'W010124', 'W010025', 'W010125')
                                    )
                             GROUP BY PRTNR_NO, DSB_YM, CO_CD, OG_TP_CD, FEE_TCNT_DV_CD, SPMT_DSB_DV_CD
                           )D
            ON C.PRTNR_NO = D.PRTNR_NO
           AND C.DSB_YM = D.DSB_YM
           AND C.OG_TP_CD = D.OG_TP_CD
           AND C.FEE_TCNT_DV_CD = D.FEE_TCNT_DV_CD
           AND C.CO_CD = D.CO_CD
           AND C.SPMT_DSB_DV_CD = D.SPMT_DSB_DV_CD
          LEFT OUTER JOIN ( SELECT Z.PRTNR_NO
                                 , SUM(Z.P_CNT) AS P_CNT
                                 , SUM(Z.G_CNT) AS G_CNT
                              FROM ( SELECT PRTNR_NO
                                          , COUNT(1) AS P_CNT
                                          , 0 AS G_CNT
                                       FROM TB_FEAM_LIF_ALNC_FEE_CNTR_IZ A /* 상조 건수*/
                                      WHERE BASE_YM = #{perfYm}
                                        AND CAN_DT = 0
                                        AND LIF_CNTR_OC_TN = 1
                                        AND LIF_CNTR_STAT_CD = 0
                                      GROUP BY PRTNR_NO
                                  UNION ALL
                                 SELECT PRTNR_NO
                                      , 0 AS P_CNT
                                      , COUNT(1) AS G_CNT
                                   FROM TB_FEAM_LIF_ALNC_FEE_CNTR_IZ A
                                  WHERE BASE_YM = #{perfYm}
                                    AND CAN_DT = 0
                                    AND LIF_CNTR_OC_TN > 1
                                    AND LIF_CNTR_STAT_CD = 0
                                  GROUP BY PRTNR_NO
                                    ) Z GROUP BY Z.PRTNR_NO
                           ) EE
            ON ( A.PRTNR_NO = EE.PRTNR_NO )
          LEFT OUTER JOIN TB_OGBS_MM_PRTNR_IZ F
            ON A.PRTNR_NO = F.PRTNR_NO
           AND A.OG_TP_CD = F.OG_TP_CD
           AND F.BASE_YM = TO_CHAR(ADD_MONTHS(#{perfYm}||'01', '1' ),'YYYYMM' )
          LEFT OUTER JOIN ( SELECT PRTNR_NO
                                 , NVL(SUM(B_AKSD05),0) AS B_AKSD05
                             FROM ( SELECT PRTNR_NO
                                         , FEE_ATC_VAL AS B_AKSD05  /* P조직 기준일 이전수수료 */
                                      FROM TB_FEAM_FEE_DSB_DTL_IZ
                                     WHERE DSB_YM &lt; #{perfYm}
                                       AND OG_TP_CD = 'W01' /*P조직*/
                                       AND FEE_TCNT_DV_CD = '01'  /*차수구분*/
                                   <if test="no != null and no != ''">
                                       AND PRTNR_NO = #{no}
                                   </if>
                                   AND FEE_CD IN ('W010005', 'W010105')
                                 UNION
                                SELECT PRTNR_NO
                                     , FEE_ATC_VAL AS B_AKSD05  /* M조직 기준일 이전수수료 */
                                  FROM TB_FEAM_FEE_DSB_DTL_IZ
                                 WHERE DSB_YM &lt; #{perfYm}
                                   AND DSB_YM &gt;= '201904'
                                   AND OG_TP_CD = 'W02' /*M조직*/
                                   AND FEE_TCNT_DV_CD = '01'  /*차수구분*/
                               <if test="no != null and no != ''">
                                   AND PRTNR_NO = #{no}
                               </if>
                                   AND FEE_CD IN ('W020080', 'W020081', 'W020082')
                                   )
                             GROUP BY PRTNR_NO
                           )MM
            ON A.PRTNR_NO = MM.PRTNR_NO
         WHERE A.BASE_YM = #{perfYm}
           AND A.OG_TP_CD = 'W01' /*P조직*/
       <if test="no != null and no != ''">
           AND A.PRTNR_NO = #{no}
       </if>
           AND A.PSTN_DV_CD = '15'
    </select>
    <select id='selectPlannerBranchManagerFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchPlarBrmgrRes">
        SELECT A.OG_NM  /*소속*/
             , A.PRTNR_NO /*번호*/
             , A.PRTNR_KNM /*성명*/
             , A.RSB_DV_CD /*직책*/
             , '플래너지점장' AS JAGYUK       /*수수료월 자격*/
             , CASE WHEN F.PRTNR_NO IS NOT NULL THEN
                    CASE WHEN F.PSTN_DV_CD = 15 AND NVL(F.QLF_DV_CD , '2') = '2' THEN '플래너'
                         WHEN F.PSTN_DV_CD = 15 AND NVL(F.QLF_DV_CD , '2') = '1' THEN '수석플래너'
                         WHEN F.PSTN_DV_CD = 7 THEN '플래너지점장'
                         WHEN F.PSTN_DV_CD = 4 THEN '단장'
                         WHEN F.PSTN_DV_CD = 2 THEN '총괄단장장'
                         END
                    ELSE '해약'
               END AS N_JAGYUK1               /* 자격(M+1)   */
             , A.CNTR_DT /*등록기준월*/
             , A.FST_CNTR_DT /*최초업무등록월*/
             , A.FNL_CLTN_DT /*최종 해약월*/
             , A.CLTN_DT /*업무해약월*/
             , B.GADCNT                     /* 실활동인원     */
             , 0 AS IS17EDU               /* AL9300P TO_BE 테이블 없음 임시! 수석(플래너)실전 */
             , CASE WHEN A.DMTN_DT > 0 THEN A.DMTN_DT
                    ELSE CASE WHEN AA.DMTN_DT > 0 THEN AA.DMTN_DT ELSE '' END
               END AS AKDRIY                    /* 승진월     */
             , A.PRFMT_DT AS AKSTYM  /*수석승급일*/
             , A.FST_CNTR_DT AS LCECAYMD /*웰스매니저 개시일 LC1700P 정리되지 않아 임시처리 */
             , NVL(B.AKCDA0,0) AS AKCDA0  /* 가전    */
             , NVL(B.AKCDA1,0) AS AKCDA1  /* 가전외    */
             , NVL(B.AKCDA2,0) AS AKCDA2  /* 기변    */
             , NVL(EE.P_CNT, 0)  AS AKSQ01              /* 당월 상조  */
             , NVL(EE.G_CNT, 0)  AS N_AKSQ01             /* 상조 유지  */
             , NVL(B1.AKCDA0,0) AS AKCDAG0  /* 지점 가전    */
             , NVL(B1.AKCDA1,0) AS AKCDAG1  /* 지점 가전외    */
             , NVL(B1.AKSQ02,0) AS AKSQG02  /* 지점 상조    */
             , NVL(B.AKCDA3,0) AS AKCDA3  /* 환경(정액)  */
             , NVL(B.AKCDA4,0) AS AKCDA4  /* 환경외(정액)  */
             , NVL(B.AKDEQ5,0) AS AKDEQ5  /* 라이브팩 건수 */
             , NVL(B.EC5AMT,0) AS EC5AMT  /* 홈케어 판매가 */
             , NVL(B.MPRODUCT,0) AS MPRODUCT /* 관리상품 판매건수 */
             , D.AKSD23  /* 정액 수당  */
             , D.AKSD24  /* 라이브팩 수당 */
             , D.AKSD25  /* 홈케어 수장  */
             , D.AKSD01  /* 개인비례 가전 */
             , D.AKSD02  /* 개인비례 가전외 */
             , D.AKSD03  /* 개인 판매장려 */
             , D.AKSD11  /* 가전조직비례 */
             , D.AKSD12  /* 가전조직외 비례 */
             , D.AKSD13  /* 조직판매장려 */
             , MM.B_AKSD05 /*정착수수료 = 이전 정착수수료*/
             , D.AKSD16  /* 조직배출1 */
             , D.AKSD17  /* 조직배출2 */
             , D.AKSD15  /* 신설 */
             , D.AKSD20  /* 재지급    */
             , D.AKSD21  /* 개인상조   */
             , D.AKSD22  /* 지점장상조   */
             , D.AKSD30  /* 기타지원  */
             , NVL(C.DSB_OJ_AMT,0) AS AKSD99 /* 과표합계 */
          FROM TB_OGBS_MM_PRTNR_IZ A
          LEFT OUTER JOIN TB_OGBS_MM_PRTNR_IZ AA
            ON AA.OG_TP_CD = 'W02'
           AND AA.PRTNR_NO = A.PRTNR_NO
           AND AA.BASE_YM = ( SELECT MAX(X.BASE_YM)
                                FROM TB_OGBS_MM_PRTNR_IZ X
                               WHERE X.OG_TP_CD = 'W02'
                                 AND X.PRTNR_NO = AA.PRTNR_NO
                             )
         INNER JOIN TB_OGBS_MM_OG_IZ O
            ON A.BASE_YM = O.BASE_YM
           AND A.OG_ID = O.OG_ID
        <if test="ogLevl1 != null and ogLevl1 != ''">
           AND B.DGR1_LEVL_OG_ID = #{ogLevl1}
        </if>
        <if test="ogLevl2 != null and ogLevl2 != ''">
           AND B.DGR2_LEVL_OG_ID = #{ogLevl2}
        </if>
        <if test="ogLevl3 != null and ogLevl3 != ''">
           AND B.DGR3_LEVL_OG_ID = #{ogLevl3}
        </if>
          LEFT OUTER JOIN ( SELECT M.PRTNR_NO
                                 , M.OG_TP_CD
                                 , SUM(AKCDA0) AS AKCDA0
                                 , SUM(AKCDA1) AS AKCDA1
                                 , SUM(AKCDA2) AS AKCDA2
                                 , SUM(AKCDA3) AS AKCDA3
                                 , SUM(AKCDA4) AS AKCDA4
                                 , SUM(AKDEQ5) AS AKDEQ5
                                 , SUM(EC5AMT) AS EC5AMT
                                 , SUM(MPRODUCT) AS MPRODUCT
                                 , SUM(GADCNT) AS GADCNT
                              FROM ( SELECT AK17.PRTNR_NO
                                          , AK17.OG_TP_CD
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00001' THEN PERF_VAL END AS AKCDA0   /* 가전    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00004' THEN PERF_VAL END AS AKCDA1   /* 가전외    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00028' THEN PERF_VAL END AS AKCDA2   /* 기변    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00029' THEN PERF_VAL END AS AKCDA3   /* 환경(정액)  */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00030' THEN PERF_VAL END AS AKCDA4   /* 환경외(정액)  */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00009' THEN PERF_VAL END AS AKDEQ5   /* 라이브팩 건수 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00016' THEN PERF_VAL END AS EC5AMT   /* 홈케어 판매가 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00018' THEN PERF_VAL END AS MPRODUCT   /* 관리상품 판매건수 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00020' THEN PERF_VAL END AS GADCNT   /*실활동인원*/
                                       FROM TB_FEAM_NTORP_PERF_MM_CL AK17   /*순주문 파트너 실적 월마감*/
                                      WHERE AK17.FEE_TCNT_DV_CD = '01'
                                        AND AK17.BASE_YM = #{perfYm}
                                        AND AK17.PERF_DV_CD = 0   /*개인판매*/
                                          <if test="no != null and no != ''">
                                        AND AK17.PRTNR_NO = #{no}
                                          </if>
                                        AND AK17.OG_TP_CD = 'W01'  /*웰스 P조직*/
                                    )M
                             GROUP BY M.PRTNR_NO, M.OG_TP_CD
                           )B
            ON A.PRTNR_NO = B.PRTNR_NO
           AND A.OG_TP_CD = B.OG_TP_CD
          LEFT OUTER JOIN ( SELECT M.PRTNR_NO
                                 , M.OG_TP_CD
                                 , SUM(AKCDA0) AS AKCDA0
                                 , SUM(AKCDA1) AS AKCDA1
                                 , SUM(AKSQ02) AS AKSQ02
                              FROM ( SELECT AK17.PRTNR_NO
                                          , AK17.OG_TP_CD
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00001' THEN PERF_VAL END AS AKCDA0   /* 가전    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00004' THEN PERF_VAL END AS AKCDA1   /* 가전외    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00010' THEN PERF_VAL END AS AKSQ02   /* 상조실적    */
                                       FROM TB_FEAM_NTORP_PERF_MM_CL AK17   /*순주문 파트너 실적 월마감*/
                                      WHERE AK17.FEE_TCNT_DV_CD = '01'
                                        AND AK17.BASE_YM = #{perfYm}
                                        AND AK17.PERF_DV_CD = 2
                                    <if test="no != null and no != ''">
                                        AND AK17.PRTNR_NO = #{no}
                                    </if>
                                        AND AK17.OG_TP_CD = 'W01'  /*웰스 P조직*/
                                     )M
                                GROUP BY M.PRTNR_NO, M.OG_TP_CD
                           )B1
            ON A.PRTNR_NO = B1.PRTNR_NO
           AND A.OG_TP_CD = B1.OG_TP_CD
          LEFT OUTER JOIN TB_FEAM_PRTNR_PERF_MM_CL PM
            ON A.PRTNR_NO = PM.PRTNR_NO
           AND A.OG_TP_CD = PM.OG_TP_CD
           AND A.BASE_YM = PM.BASE_YM
           AND PM.FEE_TCNT_DV_CD = '01'
           AND PM.PERF_ATC_CD = 'W01R00012'    /*현재미팅건수 코드미정 임시코드*/
           AND PM.PERF_AGRG_CRT_DV_CD = '101'  /*P추진단순주문실적생성*/
          LEFT OUTER JOIN TB_FEAM_FEE_DSB_IZ C
            ON A.PRTNR_NO = C.PRTNR_NO
           AND A.BASE_YM = C.DSB_YM
          AND A.OG_TP_CD = C.OG_TP_CD
          AND C.FEE_TCNT_DV_CD = '01'
          LEFT OUTER JOIN ( SELECT PRTNR_NO
                                 , DSB_YM
                                 , CO_CD
                                 , OG_TP_CD
                                 , FEE_TCNT_DV_CD
                                 , SPMT_DSB_DV_CD
                                 , NVL(SUM(AKSD23),0) AS AKSD23  /* 정액 수당  */
                                 , NVL(SUM(AKSD24),0) AS AKSD24  /* 라이브팩 수당 */
                                 , NVL(SUM(AKSD25),0) AS AKSD25  /* 홈케어 수장  */
                                 , NVL(SUM(AKSD01),0) AS AKSD01  /* 개인비례 가전 */
                                 , NVL(SUM(AKSD02),0) AS AKSD02 /* 개인비례 가전외 */
                                 , NVL(SUM(AKSD03),0) AS AKSD03  /* 개인 판매장려 */
                                 , NVL(SUM(AKSD11),0) AS AKSD11  /* 조직비례 가전 */
                                 , NVL(SUM(AKSD12),0) AS AKSD12  /* 조직비례 가전 외   */
                                 , NVL(SUM(AKSD13),0) AS AKSD13  /* 조직 판매장려 */
                                 , NVL(SUM(AKSD16),0) AS AKSD16  /* 조직배출1 */
                                 , NVL(SUM(AKSD17),0) AS AKSD17  /* 조직배출2 */
                                 , NVL(SUM(AKSD15),0) AS AKSD15  /* 신설 */
                                 , NVL(SUM(AKSD20),0) AS AKSD20  /* 재지급    */
                                 , NVL(SUM(AKSD21),0) AS AKSD21  /* 개인상조   */
                                 , NVL(SUM(AKSD22),0) AS AKSD22  /* 지점장상조   */
                                 , NVL(SUM(AKSD30),0) AS AKSD30  /* 기타수수료  */
                              FROM ( SELECT PRTNR_NO
                                          , DSB_YM
                                          , CO_CD
                                          , OG_TP_CD
                                          , FEE_TCNT_DV_CD
                                          , SPMT_DSB_DV_CD
                                          , CASE WHEN (FEE_CD = 'W010023' OR FEE_CD = 'W010123') THEN FEE_ATC_VAL ELSE 0 END AS AKSD23  /* 정액 수당  */
                                          , CASE WHEN (FEE_CD = 'W010024' OR FEE_CD = 'W010124') THEN FEE_ATC_VAL ELSE 0 END AS AKSD24  /* 라이브팩 수당 */
                                          , CASE WHEN (FEE_CD = 'W010025' OR FEE_CD = 'W010125') THEN FEE_ATC_VAL ELSE 0 END AS AKSD25  /* 홈케어 수장  */
                                          , CASE WHEN (FEE_CD = 'W010001' OR FEE_CD = 'W010101') THEN FEE_ATC_VAL ELSE 0 END AS AKSD01  /* 개인비례 가전 */
                                          , CASE WHEN (FEE_CD = 'W010002' OR FEE_CD = 'W010102') THEN FEE_ATC_VAL ELSE 0 END AS AKSD02  /* 개인비례 가전외 */
                                          , CASE WHEN (FEE_CD = 'W010003' OR FEE_CD = 'W010103') THEN FEE_ATC_VAL ELSE 0 END AS AKSD03  /* 개인 판매장려 */
                                          , CASE WHEN FEE_CD = 'W010011' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD11                         /* 조직비례 가전    */
                                          , CASE WHEN FEE_CD = 'W010012' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD12                         /* 조직비례 가전 외    */
                                          , CASE WHEN FEE_CD = 'W010013' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD13                         /* 조직 판매장려    */
                                          , CASE WHEN FEE_CD = 'W010016' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD16                         /* 조직배출1    */
                                          , CASE WHEN FEE_CD = 'W010017' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD17                         /* 조직배출2    */
                                          , CASE WHEN FEE_CD = 'W010015' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD15                         /* 신설    */
                                          , CASE WHEN (FEE_CD = 'W010020' OR FEE_CD = 'W010120') THEN FEE_ATC_VAL ELSE 0 END AS AKSD20  /* 재지급    */
                                          , CASE WHEN (FEE_CD = 'W010021' OR FEE_CD = 'W010021') THEN FEE_ATC_VAL ELSE 0 END AS AKSD21  /* 개인상조   */
                                          , CASE WHEN FEE_CD = 'W010022' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD22                         /* 지점장상조  */
                                          , CASE WHEN (FEE_CD = 'W010030' OR FEE_CD = 'W010130') THEN FEE_ATC_VAL ELSE 0 END AS AKSD30  /* 기타수수료  */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM = #{perfYm}
                                        AND OG_TP_CD = 'W01'
                                        AND FEE_TCNT_DV_CD = '01'  --차수구분
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W010023', 'W010123', 'W010024', 'W010124', 'W010025', 'W010125', 'W010001', 'W010101'
                                                     , 'W010002', 'W010102', 'W010003', 'W010103', 'W010011', 'W010012', 'W010013', 'W010016'
                                                     , 'W010017', 'W010015',  'W010020', 'W010120', 'W010021', 'W010021', 'W010022', 'W010030', 'W010130')
                                   )
                             GROUP BY PRTNR_NO, DSB_YM, CO_CD, OG_TP_CD, FEE_TCNT_DV_CD, SPMT_DSB_DV_CD
                           )D
            ON C.PRTNR_NO = D.PRTNR_NO
           AND C.DSB_YM = D.DSB_YM
           AND C.OG_TP_CD = D.OG_TP_CD
           AND C.FEE_TCNT_DV_CD = D.FEE_TCNT_DV_CD
           AND C.CO_CD = D.CO_CD
           AND C.SPMT_DSB_DV_CD = D.SPMT_DSB_DV_CD
          LEFT OUTER JOIN ( SELECT Z.PRTNR_NO
                                 , SUM(Z.P_CNT) AS P_CNT
                                 , SUM(Z.G_CNT) AS G_CNT
                              FROM ( SELECT PRTNR_NO
                                          , COUNT(1) AS P_CNT
                                          , 0 AS G_CNT
                                       FROM TB_FEAM_LIF_ALNC_FEE_CNTR_IZ A /* 상조 건수*/
                                      WHERE BASE_YM = #{perfYm}
                                        AND CAN_DT = 0
                                        AND LIF_CNTR_OC_TN = 1
                                        AND LIF_CNTR_STAT_CD = 0
                                      GROUP BY PRTNR_NO
                                      UNION ALL
                                     SELECT PRTNR_NO
                                          , 0 AS P_CNT
                                          , COUNT(1) AS G_CNT
                                       FROM TB_FEAM_LIF_ALNC_FEE_CNTR_IZ A
                                      WHERE BASE_YM = #{perfYm}
                                        AND CAN_DT = 0
                                        AND LIF_CNTR_OC_TN > 1
                                        AND LIF_CNTR_STAT_CD = 0
                                      GROUP BY PRTNR_NO
                                    ) Z GROUP BY Z.PRTNR_NO
                           ) EE
            ON A.PRTNR_NO = EE.PRTNR_NO
          LEFT OUTER JOIN TB_OGBS_MM_PRTNR_IZ F
            ON A.PRTNR_NO = F.PRTNR_NO
           AND A.OG_TP_CD = F.OG_TP_CD
           AND F.BASE_YM = TO_CHAR(ADD_MONTHS(#{perfYm}||'01', '1' ),'YYYYMM' )
          LEFT OUTER JOIN ( SELECT PRTNR_NO
                                 , NVL(SUM(B_AKSD05),0) AS B_AKSD05
                              FROM ( SELECT PRTNR_NO
                                          , FEE_ATC_VAL AS B_AKSD05  /* P조직 기준일 이전수수료 */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM &lt; #{perfYm}
                                        AND OG_TP_CD = 'W01' /*P조직*/
                                        AND FEE_TCNT_DV_CD = '01'  /*차수구분*/
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W010005', 'W010105')
                                      UNION
                                     SELECT PRTNR_NO
                                          , FEE_ATC_VAL AS B_AKSD05  /* M조직 기준일 이전수수료 */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM &lt; #{perfYm}
                                        AND DSB_YM &gt;= '201904'
                                        AND OG_TP_CD = 'W02' /*M조직*/
                                        AND FEE_TCNT_DV_CD = '01'  /*차수구분*/
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W020080', 'W020081', 'W020082')
                                    )
                             GROUP BY PRTNR_NO
                           )MM
            ON A.PRTNR_NO = MM.PRTNR_NO
         WHERE A.BASE_YM = #{perfYm}
           AND A.OG_TP_CD = 'W01' /*P조직*/
       <if test="no != null and no != ''">
           AND A.PRTNR_NO = #{no}
       </if>
           AND A.PSTN_DV_CD = 7
    </select>
    <select id='selectPlannerTotalFees'
            resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchPlarTotalRes">
        SELECT A.OG_NM  /*소속*/
             , A.PRTNR_NO /*번호*/
             , A.PRTNR_KNM /*성명*/
             , A.RSB_DV_CD /*직책*/
             , CASE WHEN A.PSTN_DV_CD = 15 THEN NVL(PM.PERF_VAL,0)
                    ELSE 0
               END AS AKCUIL     /*미팅일수*/
             , CASE WHEN A.PSTN_DV_CD = 15 AND NVL(A.QLF_DV_CD , '2') = '2' THEN '플래너'
                    WHEN A.PSTN_DV_CD = 15 AND NVL(A.QLF_DV_CD , '2') = '1' THEN '수석플래너'
                    WHEN A.PSTN_DV_CD = 7 THEN '지점장'
                    ELSE ''
               END AS JAGYUK       /*수수료월 자격*/
             , CASE WHEN F.PRTNR_NO IS NOT NULL THEN
                    CASE WHEN F.PSTN_DV_CD = 15 AND NVL(F.QLF_DV_CD , '2') = '2' THEN '플래너'
                         WHEN F.PSTN_DV_CD = 15 AND NVL(F.QLF_DV_CD , '2') = '1' THEN '수석플래너'
                         WHEN F.PSTN_DV_CD = 7 THEN '지점장'
                         WHEN F.PSTN_DV_CD = 4 THEN '단장'
                         WHEN F.PSTN_DV_CD = 2 THEN '총괄단장장'
                    END
                    ELSE '해약'
               END AS N_JAGYUK1               /* 자격(M+1)   */
             , 0 AS IS11EDU               /* AL9300P TO_BE 테이블 없음 임시! 플래너스타트업 */
             , 0 AS IS17EDU               /* AL9300P TO_BE 테이블 없음 임시! 수석(플래너)실전 */
             , A.CNTR_DT /*등록기준월*/
             , A.FST_CNTR_DT /*최초업무등록월*/
             , A.RCNTR_DT /*재등록월*/
             , A.FNL_CLTN_DT /*최종해약월*/
             , A.CLTN_DT /*업무해약월*/
             , CASE WHEN F.PSTN_DV_CD = 7 THEN B.GADCNT ELSE 0 END AS  GADCNT  /* 실활동인원     */
             , CASE WHEN A.PSTN_DV_CD = 7 AND A.DMTN_DT > 0 THEN A.DMTN_DT
                    ELSE CASE WHEN A.PSTN_DV_CD = 7 AND AA.DMTN_DT > 0 THEN AA.DMTN_DT
                              ELSE ''
                         END
               END AS AKDRIY                    /* 승진월     */
             , A.PRFMT_DT AS AKSTYM  /*수석승급일*/
             , A.FST_CNTR_DT AS LCECAYMD /*웰스매니저 개시일 LC1700P 정리되지 않아 임시처리 */
             , MM.B_AKSD05 /*정착수수료 = 이전 정착수수료*/
             , NVL(B.AKCDA0,0) AS AKCDA0  /* 가전    */
             , NVL(B.AKCDA1,0) AS AKCDA1  /* 가전외    */
             , NVL(B.AKCDA2,0) AS AKCDA2  /* 기변    */
             , NVL(EE.P_CNT, 0)  AS AKSQ01              /* 당월 상조  */
             , NVL(EE.G_CNT, 0)  AS N_AKSQ01             /* 상조 유지  */
             , NVL(B1.AKCDA0,0) AS AKCDAG0  /* 지점 가전    */
             , NVL(B1.AKCDA1,0) AS AKCDAG1  /* 지점 가전외    */
             , NVL(B1.AKSQ02,0) AS AKSQG02  /* 지점 상조    */
             , NVL(B.AKCDA3,0) AS AKCDA3  /* 환경(정액)  */
             , NVL(B.AKCDA4,0) AS AKCDA4  /* 환경외(정액)  */
             , NVL(B.AKDEQ5,0) AS AKDEQ5  /* 라이브팩 건수 */
             , NVL(B.EC5AMT,0) AS EC5AMT  /* 홈케어 판매가 */
             , NVL(B.MPRODUCT,0) AS MPRODUCT /* 관리상품 판매건수 */
             , D.AKSD24  /* 라이브팩 수당 */
             , D.AKSD25  /* 홈케어 수장  */
             , D.AKSD01  /* 개인비례 가전 */
             , D.AKSD02  /* 개인비례 가전외 */
             , D.AKSD03  /* 개인 판매장려 */
             , D.AKSD21  /* 개인상조   */
             , D.AKSD04  /* 미팅    */
             , D.AKSD05  /* 정착    */
             , D.AKSD20  /* 재지급    */
             , D.AKSD30  /* 기타지원  */
             , D.AKSD11  /* 가전조직비례 */
             , D.AKSD12  /* 가전조직외 비례 */
             , D.AKSD13  /* 조직판매장려 */
             , D.AKSD16  /* 조직배출1 */
             , D.AKSD17  /* 조직배출2 */
             , D.AKSD15  /* 신설 */
             , D.AKSD22  /* 지점장상조   */
             , NVL(C.DSB_OJ_AMT,0) AS AKSD99 /* 과표 */
             , NVL(C.DDCTAM,0) AS DDCTAM     /* 공제 */
             , NVL(C.DSB_OJ_AMT,0) AS DSB_OJ_AMT /* 실지급 */
          FROM TB_OGBS_MM_PRTNR_IZ A
          LEFT OUTER JOIN TB_OGBS_MM_PRTNR_IZ AA
            ON AA.OG_TP_CD = 'W02'
           AND AA.PRTNR_NO = A.PRTNR_NO
           AND AA.BASE_YM = ( SELECT MAX(X.BASE_YM)
                                FROM TB_OGBS_MM_PRTNR_IZ X
                               WHERE X.OG_TP_CD = 'W02'
                                 AND X.PRTNR_NO = AA.PRTNR_NO
                             )
         INNER JOIN TB_OGBS_MM_OG_IZ O
            ON A.BASE_YM = O.BASE_YM
           AND A.OG_ID = O.OG_ID
       <if test="ogLevl1 != null and ogLevl1 != ''">
           AND B.DGR1_LEVL_OG_ID = #{ogLevl1}
       </if>
       <if test="ogLevl2 != null and ogLevl2 != ''">
           AND B.DGR2_LEVL_OG_ID = #{ogLevl2}
       </if>
       <if test="ogLevl3 != null and ogLevl3 != ''">
           AND B.DGR3_LEVL_OG_ID = #{ogLevl3}
       </if>
          LEFT OUTER JOIN ( SELECT M.PRTNR_NO
                                 , M.OG_TP_CD
                                 , SUM(AKCDA0) AS AKCDA0
                                 , SUM(AKCDA1) AS AKCDA1
                                 , SUM(AKCDA2) AS AKCDA2
                                 , SUM(AKCDA3) AS AKCDA3
                                 , SUM(AKCDA4) AS AKCDA4
                                 , SUM(AKDEQ5) AS AKDEQ5
                                 , SUM(EC5AMT) AS EC5AMT
                                 , SUM(MPRODUCT) AS MPRODUCT
                                 , SUM(GADCNT) AS GADCNT
                              FROM ( SELECT AK17.PRTNR_NO
                                          , AK17.OG_TP_CD
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00001' THEN PERF_VAL END AS AKCDA0   /* 가전    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00004' THEN PERF_VAL END AS AKCDA1   /* 가전외    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00028' THEN PERF_VAL END AS AKCDA2   /* 기변    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00029' THEN PERF_VAL END AS AKCDA3   /* 환경(정액)  */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00030' THEN PERF_VAL END AS AKCDA4   /* 환경외(정액)  */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W00P00009' THEN PERF_VAL END AS AKDEQ5   /* 라이브팩 건수 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00016' THEN PERF_VAL END AS EC5AMT   /* 홈케어 판매가 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00018' THEN PERF_VAL END AS MPRODUCT   /* 관리상품 판매건수 */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00020' THEN PERF_VAL END AS GADCNT   /*실활동인원*/
                                       FROM TB_FEAM_NTORP_PERF_MM_CL AK17   /*순주문 파트너 실적 월마감*/
                                      WHERE AK17.FEE_TCNT_DV_CD = '01'
                                        AND AK17.BASE_YM = #{perfYm}
                                        AND AK17.PERF_DV_CD = 0   /*개인판매*/
                                    <if test="no != null and no != ''">
                                        AND AK17.PRTNR_NO = #{no}
                                    </if>
                                        AND AK17.OG_TP_CD = 'W01'  /*웰스 P조직*/
                                   )M
                             GROUP BY M.PRTNR_NO, M.OG_TP_CD
                           )B
            ON A.PRTNR_NO = B.PRTNR_NO
           AND A.OG_TP_CD = B.OG_TP_CD
          LEFT OUTER JOIN ( SELECT M.PRTNR_NO
                                 , M.OG_TP_CD
                                 , SUM(AKCDA0) AS AKCDA0
                                 , SUM(AKCDA1) AS AKCDA1
                                 , SUM(AKSQ02) AS AKSQ02
                              FROM ( SELECT AK17.PRTNR_NO
                                          , AK17.OG_TP_CD
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00001' THEN PERF_VAL END AS AKCDA0   /* 가전    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00004' THEN PERF_VAL END AS AKCDA1   /* 가전외    */
                                          , CASE WHEN AK17.PERF_ATC_CD = 'W01P00010' THEN PERF_VAL END AS AKSQ02   /* 상조실적    */
                                       FROM TB_FEAM_NTORP_PERF_MM_CL AK17   /*순주문 파트너 실적 월마감*/
                                      WHERE AK17.FEE_TCNT_DV_CD = '01'
                                        AND AK17.BASE_YM = #{perfYm}
                                        AND AK17.PERF_DV_CD = 2
                                    <if test="no != null and no != ''">
                                        AND AK17.PRTNR_NO = #{no}
                                    </if>
                                        AND AK17.OG_TP_CD = 'W01'  /*웰스 P조직*/
                                   )M
                             GROUP BY M.PRTNR_NO, M.OG_TP_CD
                           )B1
            ON A.PRTNR_NO = B1.PRTNR_NO
           AND A.OG_TP_CD = B1.OG_TP_CD
          LEFT OUTER JOIN TB_FEAM_PRTNR_PERF_MM_CL PM
            ON A.PRTNR_NO = PM.PRTNR_NO
           AND A.OG_TP_CD = PM.OG_TP_CD
           AND A.BASE_YM = PM.BASE_YM
           AND PM.FEE_TCNT_DV_CD = '01'
           AND PM.PERF_ATC_CD = 'W01R00012'    /*현재미팅건수 코드미정 임시코드*/
           AND PM.PERF_AGRG_CRT_DV_CD = '101'  /*P추진단순주문실적생성*/
          LEFT OUTER JOIN TB_FEAM_FEE_DSB_IZ C
            ON A.PRTNR_NO = C.PRTNR_NO
           AND A.BASE_YM = C.DSB_YM
           AND A.OG_TP_CD = C.OG_TP_CD
           AND C.FEE_TCNT_DV_CD = '01'
          LEFT OUTER JOIN ( SELECT PRTNR_NO
                                 , DSB_YM
                                 , CO_CD
                                 , OG_TP_CD
                                 , FEE_TCNT_DV_CD
                                 , SPMT_DSB_DV_CD
                                 , NVL(SUM(AKSD01),0) AS AKSD01  /* 개인비례 가전 */
                                 , NVL(SUM(AKSD02),0) AS AKSD02 /* 개인비례 가전외 */
                                 , NVL(SUM(AKSD03),0) AS AKSD03  /* 개인 판매장려 */
                                 , NVL(SUM(AKSD21),0) AS AKSD21  /* 개인상조   */
                                 , NVL(SUM(AKSD04),0) AS AKSD04  /* 미팅    */
                                 , NVL(SUM(AKSD05),0) AS AKSD05  /* 정착    */
                                 , NVL(SUM(AKSD20),0) AS AKSD20  /* 재지급    */
                                 , NVL(SUM(AKSD30),0) AS AKSD30  /* 기타수수료  */
                                 , NVL(SUM(AKSD24),0) AS AKSD24  /* 라이브팩 수당 */
                                 , NVL(SUM(AKSD25),0) AS AKSD25  /* 홈케어 수장  */
                                 , NVL(SUM(AKSD11),0) AS AKSD11  /* 조직비례 가전 */
                                 , NVL(SUM(AKSD12),0) AS AKSD12  /* 조직비례 가전 외   */
                                 , NVL(SUM(AKSD13),0) AS AKSD13  /* 조직 판매장려 */
                                 , NVL(SUM(AKSD16),0) AS AKSD16  /* 조직배출1 */
                                 , NVL(SUM(AKSD17),0) AS AKSD17  /* 조직배출2 */
                                 , NVL(SUM(AKSD15),0) AS AKSD15  /* 신설 */
                                 , NVL(SUM(AKSD22),0) AS AKSD22  /* 지점장상조   */
                              FROM ( SELECT PRTNR_NO
                                          , DSB_YM
                                          , CO_CD
                                          , OG_TP_CD
                                          , FEE_TCNT_DV_CD
                                          , SPMT_DSB_DV_CD
                                          , CASE WHEN (FEE_CD = 'W010001' OR FEE_CD = 'W010101') THEN FEE_ATC_VAL ELSE 0 END AS AKSD01  /* 개인비례 가전 */
                                          , CASE WHEN (FEE_CD = 'W010002' OR FEE_CD = 'W010102') THEN FEE_ATC_VAL ELSE 0 END AS AKSD02  /* 개인비례 가전외 */
                                          , CASE WHEN (FEE_CD = 'W010003' OR FEE_CD = 'W010103') THEN FEE_ATC_VAL ELSE 0 END AS AKSD03  /* 개인 판매장려 */
                                          , CASE WHEN (FEE_CD = 'W010021' OR FEE_CD = 'W010021') THEN FEE_ATC_VAL ELSE 0 END AS AKSD21  /* 개인상조   */
                                          , CASE WHEN FEE_CD = 'W010004' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD04                         /* 미팅    */
                                          , CASE WHEN (FEE_CD = 'W010005' OR FEE_CD = 'W010105') THEN FEE_ATC_VAL ELSE 0 END AS AKSD05  /* 정착    */
                                          , CASE WHEN (FEE_CD = 'W010020' OR FEE_CD = 'W010120') THEN FEE_ATC_VAL ELSE 0 END AS AKSD20  /* 재지급    */
                                          , CASE WHEN (FEE_CD = 'W010030' OR FEE_CD = 'W010130') THEN FEE_ATC_VAL ELSE 0 END AS AKSD30  /* 기타수수료  */
                                          , CASE WHEN (FEE_CD = 'W010024' OR FEE_CD = 'W010124') THEN FEE_ATC_VAL ELSE 0 END AS AKSD24  /* 라이브팩 수당 */
                                          , CASE WHEN (FEE_CD = 'W010025' OR FEE_CD = 'W010125') THEN FEE_ATC_VAL ELSE 0 END AS AKSD25  /* 홈케어 수장  */
                                          , CASE WHEN FEE_CD = 'W010011' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD11                         /* 조직비례 가전    */
                                          , CASE WHEN FEE_CD = 'W010012' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD12                         /* 조직비례 가전 외    */
                                          , CASE WHEN FEE_CD = 'W010013' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD13                         /* 조직 판매장려    */
                                          , CASE WHEN FEE_CD = 'W010016' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD16                         /* 조직배출1    */
                                          , CASE WHEN FEE_CD = 'W010017' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD17                         /* 조직배출2    */
                                          , CASE WHEN FEE_CD = 'W010015' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD15                         /* 신설    */
                                          , CASE WHEN FEE_CD = 'W010022' THEN FEE_ATC_VAL ELSE 0 END  AS AKSD22                         /* 지점장상조  */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM = #{perfYm}
                                        AND OG_TP_CD = 'W01'
                                        AND FEE_TCNT_DV_CD = '01'  --차수구분
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W010001', 'W010101', 'W010002', 'W010102', 'W010003', 'W010103', 'W010021', 'W010121'
                                                     , 'W010004', 'W010005', 'W010105', 'W010020', 'W010120', 'W010030', 'W010130', 'W010024'
                                                     , 'W010124', 'W010025', 'W010125', 'W010011', 'W010012', 'W010013', 'W010016', 'W010017'
                                                     , 'W010015',  'W010022')
                                    )
                             GROUP BY PRTNR_NO, DSB_YM, CO_CD, OG_TP_CD, FEE_TCNT_DV_CD, SPMT_DSB_DV_CD
                           )D
            ON C.PRTNR_NO = D.PRTNR_NO
           AND C.DSB_YM = D.DSB_YM
           AND C.OG_TP_CD = D.OG_TP_CD
           AND C.FEE_TCNT_DV_CD = D.FEE_TCNT_DV_CD
           AND C.CO_CD = D.CO_CD
           AND C.SPMT_DSB_DV_CD = D.SPMT_DSB_DV_CD
          LEFT OUTER JOIN ( SELECT Z.PRTNR_NO
                                 , SUM(Z.P_CNT) AS P_CNT
                                 , SUM(Z.G_CNT) AS G_CNT
                              FROM ( SELECT PRTNR_NO
                                          , COUNT(1) AS P_CNT
                                          , 0 AS G_CNT
                                       FROM TB_FEAM_LIF_ALNC_FEE_CNTR_IZ A /* 상조 건수*/
                                      WHERE BASE_YM = #{perfYm}
                                        AND CAN_DT = 0
                                        AND LIF_CNTR_OC_TN = 1
                                        AND LIF_CNTR_STAT_CD = 0
                                   GROUP BY PRTNR_NO
                                   UNION ALL
                                  SELECT PRTNR_NO
                                       , 0 AS P_CNT
                                       , COUNT(1) AS G_CNT
                                    FROM TB_FEAM_LIF_ALNC_FEE_CNTR_IZ A
                                   WHERE BASE_YM = #{perfYm}
                                     AND CAN_DT = 0
                                     AND LIF_CNTR_OC_TN > 1
                                     AND LIF_CNTR_STAT_CD = 0
                                   GROUP BY PRTNR_NO
                                    ) Z GROUP BY Z.PRTNR_NO
                           ) EE
            ON ( A.PRTNR_NO = EE.PRTNR_NO )
          LEFT OUTER JOIN TB_OGBS_MM_PRTNR_IZ F
            ON A.PRTNR_NO = F.PRTNR_NO
           AND A.OG_TP_CD = F.OG_TP_CD
           AND F.BASE_YM = TO_CHAR(ADD_MONTHS(#{perfYm}||'01', '1' ),'YYYYMM' )
          LEFT OUTER JOIN ( SELECT PRTNR_NO
                                 , NVL(SUM(B_AKSD05),0) AS B_AKSD05
                              FROM ( SELECT PRTNR_NO
                                          , FEE_ATC_VAL AS B_AKSD05  /* P조직 기준일 이전수수료 */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM &lt; #{perfYm}
                                        AND OG_TP_CD = 'W01' /*P조직*/
                                        AND FEE_TCNT_DV_CD = '01'  /*차수구분*/
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W010005', 'W010105')
                                      UNION
                                     SELECT PRTNR_NO
                                          , FEE_ATC_VAL AS B_AKSD05  /* M조직 기준일 이전수수료 */
                                       FROM TB_FEAM_FEE_DSB_DTL_IZ
                                      WHERE DSB_YM &lt; #{perfYm}
                                        AND DSB_YM &gt;= '201904'
                                        AND OG_TP_CD = 'W02' /*M조직*/
                                        AND FEE_TCNT_DV_CD = '01'  /*차수구분*/
                                    <if test="no != null and no != ''">
                                        AND PRTNR_NO = #{no}
                                    </if>
                                        AND FEE_CD IN ('W020080', 'W020081', 'W020082')
                                   )
                             GROUP BY PRTNR_NO
                           )MM
            ON A.PRTNR_NO = MM.PRTNR_NO
         WHERE A.BASE_YM = #{perfYm}
           AND A.OG_TP_CD = 'W01' /*P조직*/
       <if test="no != null and no != ''">
           AND A.PRTNR_NO = #{no}
       </if>
           AND ( A.PSTN_DV_CD = 7 OR A.PSTN_DV_CD = 15 )
    </select>

    <select id='selectWmFees' resultType="com.kyowon.sms.wells.web.fee.calculation.dto.WfebOrganizationFeeDto$SearchWmRes">
    SELECT '서울총괄단' AS COL1
        , '서울지역단' AS COL2
        , '김웰스지점' AS COL3
        , '1673419' AS COL4
        , '김교원' AS COL5
        , '플래너' AS COL6
        , 34 AS COL7
        , '2019-03' AS COL8
        , '-' AS COL9
        , '2014-10' AS COL10
        , 56 AS COL11
        , '미지급' AS COL12
        , 123456000 AS COL13
        , 2 AS COL14
        , 3 AS COL15
        , 0 AS COL16
        , 12 AS COL17
        , 81 AS COL18
        , 0 AS COL19
        , 129 AS COL20
        , 1234500 AS COL21
        , 100 AS COL22
        , 1234500 AS COL23
        , 0 AS COL24
        , 0 AS COL25
        , 0 AS COL26
        , 0 AS COL27
        , 0 AS COL28
        , 0 AS COL29
        , 34000 AS COL30
        , 0 AS COL31
        , 0 AS COL32
        , 0 AS COL33
        , 123450 AS COL34
        , 0 AS COL35
        , 123 AS COL36
        , 'N' AS COL37
        , 'N' AS COL38
        , 15 AS COL39
        , 'N' AS COL40
      FROM DUAL
    UNION ALL
    SELECT '경기총괄단' AS COL1
        , '경기지역단' AS COL2
        , '박웰스지점' AS COL3
        , '1673419' AS COL4
        , '박교원' AS COL5
        , '플래너' AS COL6
        , 34 AS COL7
        , '2019-03' AS COL8
        , '-' AS COL9
        , '2014-10' AS COL10
        , 56 AS COL11
        , '미지급' AS COL12
        , 123456000 AS COL13
        , 2 AS COL14
        , 3 AS COL15
        , 0 AS COL16
        , 12 AS COL17
        , 81 AS COL18
        , 0 AS COL19
        , 129 AS COL20
        , 1234500 AS COL21
        , 100 AS COL22
        , 1234500 AS COL23
        , 0 AS COL24
        , 0 AS COL25
        , 0 AS COL26
        , 0 AS COL27
        , 0 AS COL28
        , 0 AS COL29
        , 34000 AS COL30
        , 0 AS COL31
        , 0 AS COL32
        , 0 AS COL33
        , 123450 AS COL34
        , 0 AS COL35
        , 123 AS COL36
        , 'N' AS COL37
        , 'N' AS COL38
        , 15 AS COL39
        , 'N' AS COL40
      FROM DUAL
    </select>

</mapper>
